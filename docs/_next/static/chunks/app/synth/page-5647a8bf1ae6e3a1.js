(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[275],{6898:function(e,t,o){Promise.resolve().then(o.bind(o,5982))},9691:function(e,t,o){"use strict";o.d(t,{d:function(){return getKeysByValue}});var n=o(599);function getKeysByValue(e,t){return Object.keys(e).filter(function(o){return e[o]===t}).map(function(e){return Number(e)})}Array.prototype.move=function(e,t){this.splice(t,0,this.splice(e,1)[0])},Array.prototype.toMoved=function(e,t){var o=(0,n.Z)(this);return o.splice(t,0,o.splice(e,1)[0]),o},Array.prototype.insert=function(e,t){this.splice(t,0,e)},Array.prototype.equals&&console.warn("Overriding existing Array.prototype.equals. Possible causes: New API defines the method, there's a framework conflict or you've got double inclusions in your code."),Array.prototype.equals=function(e){if(!e)return!1;if(e===this)return!0;if(this.length!=e.length)return!1;for(var t=0,o=this.length;t<o;t++)if(this[t]instanceof Array&&e[t]instanceof Array){if(!this[t].equals(e[t]))return!1}else if(this[t]!=e[t])return!1;return!0},Object.defineProperty(Array.prototype,"equals",{enumerable:!1}),Number.prototype.fromExponent=function(){var e=String(this).split(/[eE]/);if(1==e.length)return e[0];var t="",o=e[0].replace(".",""),n=Number(e[1])+1;if(n<0){for(t=(this<0?"-":"")+"0.";n++;)t+="0";return t+o.replace(/^\-/,"")}for(n-=o.length;n--;)t+="0";return o+t},Number.prototype.clamp=function(e,t){return Math.min(Math.max(this,e),t)}},5982:function(e,t,o){"use strict";o.r(t),o.d(t,{default:function(){return Synth}});var n=o(7022),r=o(599),s=o(8518),i=o.n(s),l=o(7707),c=o(2265);o(4033);var a=o(9691);o(9618),o(9629);var d=o(7437);function ownKeys(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),o.push.apply(o,n)}return o}function _objectSpread(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?ownKeys(Object(o),!0).forEach(function(t){(0,n.Z)(e,t,o[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):ownKeys(Object(o)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))})}return e}function Synth(){var e,t,o,s,u=(0,c.useState)(),g=u[0],p=u[1];console.log("initial octave: ",g);var h=(0,c.useState)(),m=h[0],f=h[1],v=(0,c.useState)(function(){return function(){}}),y=v[0],b=v[1],w=(0,c.useState)(function(){return function(){console.log("old")}}),k=w[0],x=w[1],S=(0,c.useState)(0),A=S[0],O=S[1],N=(0,c.useState)(0),j=N[0],C=N[1],_=0;l.Do.lookAhead=0;var P=[0,2,1,4,3,5,7,6,9,8,11,10];function increaseOctave(){var e=Number(localStorage.getItem("octave"))||3;e+_>=7||(console.log(e),console.log("oo: ",_),p(e+1))}function decreaseOctave(){var e=Number(localStorage.getItem("octave"))||3;e<1||p(e-1)}function renderSampler(){var e=document.getElementById("samples");e.innerHTML="";var t=JSON.parse(localStorage.getItem("samples"))||(localStorage.setItem("samples",JSON.stringify({})),{});for(var o in t){var n=document.createElement("div"),r=document.createElement("h3");r.style.cssText="text-align: center",r.textContent=o;var s=document.createElement("div");s.style.cssText="width: 80%; height: 8rlh; border: 2px dashed var(--nav-background); display: block; margin: 0.6rlh auto;",n.appendChild(r),n.appendChild(s),e.appendChild(n)}}return(0,c.useEffect)(function(){var n=new l.Z4({urls:{C4:"C4.mp3","D#4":"Ds4.mp3","F#4":"Fs4.mp3",A4:"A4.mp3"},release:1,baseUrl:"./samples/piano/"}).toDestination().toDestination();return document.getElementById("keysValue"),document.getElementById("octaveValue"),t=(e=JSON.parse(localStorage.getItem("notes"))||(localStorage.setItem("notes",JSON.stringify(["C","D","C#","E","D#","F","G","F#","A","G#","B","A#"])),["C","D","C#","E","D#","F","G","F#","A","G#","B","A#"])).filter(function(e){return!e.includes("#")}),e.filter(function(e){return e.includes("#")}),o=document.querySelector("div#synth"),x(function(){return function(e){console.log(e)}}),b(function(){return function(i,c,d){switch(void 0!=d&&(o.innerHTML="",s=null),d){case"piano":console.log("piano!!!"),n=new l.Z4({urls:{C4:"C4.mp3","D#4":"Ds4.mp3","F#4":"Fs4.mp3",A4:"A4.mp3"},release:1,baseUrl:"./samples/piano/"}).toDestination().toDestination(),_=0,console.log("starting render..."),console.log(c),console.log(i),(s=document.createElementNS("http://www.w3.org/2000/svg","svg")).id="synthsvg";for(var u=0;u<c;u++)!function(o){var c=void 0;e[o%12].includes("#")?((c=document.createElementNS("http://www.w3.org/2000/svg","rect")).setAttribute("width",35),c.setAttribute("height",180),c.setAttribute("stroke","black"),c.setAttribute("stroke-width",2.5),c.setAttribute("fill","black"),c.classList.add("semi-tone"),c.setAttribute("x",385*_+55*e.slice(0,e.indexOf(e[P[o%12]])).filter(function(e){return!e.includes("#")}).length-17.5+1.25)):((c=document.createElementNS("http://www.w3.org/2000/svg","rect")).setAttribute("width",55),c.setAttribute("height",280),c.setAttribute("stroke","black"),c.setAttribute("stroke-width",2.5),c.setAttribute("fill","white"),c.classList.add("tone"),c.setAttribute("rx",10),c.setAttribute("x",385*_+55*t.indexOf(e[o%12])+1.25)),c.setAttribute("y",1.25),s.appendChild(c);var a=_;i=Number(i),console.log(s.children),console.log(a),console.log(c),console.log((0,r.Z)(s.children).indexOf(c)-12*a),console.log("".concat(e[(0,r.Z)(s.children).indexOf(c)-12*a])+"".concat(i+a)),console.log(o),c.onmousedown=function(t){t.stopPropagation(),void 0==c.getAttribute("isPressed")&&(c.setAttribute("isPressed",""),n.triggerAttack("".concat(e[(0,r.Z)(s.children).indexOf(c)-12*a])+"".concat(i+a),l.Do.currentTime),s.children[(0,r.Z)(s.children).indexOf(c)].style.transform="rotateX(15deg)"),console.log("".concat(e[(0,r.Z)(s.children).indexOf(c)-12*a])+"".concat(i+a))},c.onmouseup=function(t){t.stopPropagation(),void 0!=c.getAttribute("isPressed")&&(c.removeAttribute("isPressed"),n.triggerRelease("".concat(e[(0,r.Z)(s.children).indexOf(c)-12*a])+"".concat(i+a),l.Do.currentTime),s.children[(0,r.Z)(s.children).indexOf(c)].style.transform=""),console.log("".concat(e[(0,r.Z)(s.children).indexOf(c)-12*a])+"".concat(i+a)),console.log(i),console.log(a)},c.onmouseleave=function(t){t.stopPropagation(),n.triggerRelease("".concat(e[(0,r.Z)(s.children).indexOf(c)-12*a])+"".concat(i+a),l.Do.currentTime),s.children[(0,r.Z)(s.children).indexOf(c)].style.transform=""},c.ontouchstart=function(e){e.stopPropagation(),e.preventDefault(),c.onmousedown(e)},c.ontouchend=c.ontouchcancel=function(e){e.stopPropagation(),e.preventDefault(),c.onmouseup(e)},(o+1)%12==0&&0!=o&&_++}(u);s.setAttribute("viewBox","0 0 ".concat(55*(0,r.Z)(s.children).filter(function(e){return e.classList.contains("tone")}).length+5," ").concat(285)),o.appendChild(s),window.onkeydown=function(e){var t=JSON.parse(localStorage.getItem("octavechangekeys"))||[];if(console.log("ock: ",t),console.log((0,a.d)(t,e.key.toLowerCase())),console.log((0,a.d)(t,e.key.toLowerCase()).length>0),(0,a.d)(t,e.key.toLowerCase()).length>0)console.log("octave key pressed"),e.key.toLowerCase()==t[0]?increaseOctave():decreaseOctave();else{e.stopPropagation();var o=JSON.parse(localStorage.getItem("keys"))||(localStorage.setItem("keys",JSON.stringify(["q","w","e","r","t","y","u","i","o","p","[","]"])),["q","w","e","r","t","y","u","i","o","p","[","]"]);console.log(o);var n=(0,a.d)(o,e.key.toLowerCase());if(console.log(e.key.toLowerCase()),void 0!=n)for(var r=0;r<n.length;r++){var i=Number(n[r])-Number(n[r])%12+P[n[r]%12];console.log("key",n),console.log("mapped",i),console.log(s.children),console.log(s.children[i]),s.children[i].dispatchEvent(new Event("mousedown")),console.log(s.children[i].getAttribute("isPressed"))}}},window.onkeyup=function(e){e.stopPropagation();var t=JSON.parse(localStorage.getItem("keys"))||(localStorage.setItem("keys",JSON.stringify(["q","w","e","r","t","y","u","i","o","p","[","]"])),JSON.stringify(["q","w","e","r","t","y","u","i","o","p","[","]"])),o=(0,a.d)(t,e.key.toLowerCase());if(console.log(e.key.toLowerCase()),void 0!=o)for(var n=0;n<o.length;n++){var r=Number(o[n])-Number(o[n])%12+P[o[n]%12];console.log("key",o),console.log("mapped",r),s.children[r].dispatchEvent(new Event("mouseup")),console.log(s.children[r].getAttribute("isPressed")),s.children[r].style.transform=""}};break;case"drums":n=new l.Z4({urls:{F3:"F3.wav",G3:"G3.wav",A3:"A3.wav",B3:"B3.wav",C4:"C4.wav",D4:"D4.wav",F4:"F4.wav","F#4":"Fs4.wav",G4:"G4.wav",C5:"C5.wav",A5:"A5.wav"},release:1,baseUrl:"./samples/drums/"}).toDestination().toDestination(),_=0,console.log("starting render..."),console.log(c),console.log(i),(s=document.createElementNS("http://www.w3.org/2000/svg","svg")).id="synthsvg";for(var g=0;g<c;g++)!function(o){var c=void 0;e[o%12].includes("#")?((c=document.createElementNS("http://www.w3.org/2000/svg","rect")).setAttribute("width",35),c.setAttribute("height",180),c.setAttribute("stroke","black"),c.setAttribute("stroke-width",2.5),c.setAttribute("fill","black"),c.classList.add("semi-tone"),c.setAttribute("x",385*_+55*e.slice(0,e.indexOf(e[P[o%12]])).filter(function(e){return!e.includes("#")}).length-17.5+1.25)):((c=document.createElementNS("http://www.w3.org/2000/svg","rect")).setAttribute("width",55),c.setAttribute("height",280),c.setAttribute("stroke","black"),c.setAttribute("stroke-width",2.5),c.setAttribute("fill","white"),c.classList.add("tone"),c.setAttribute("rx",10),c.setAttribute("x",385*_+55*t.indexOf(e[o%12])+1.25)),c.setAttribute("y",1.25),s.appendChild(c);var a=_;i=Number(i),console.log(s.children),console.log(a),console.log(c),console.log((0,r.Z)(s.children).indexOf(c)-12*a),console.log("".concat(e[(0,r.Z)(s.children).indexOf(c)-12*a])+"".concat(i+a)),console.log(o),c.onmousedown=function(t){t.stopPropagation(),void 0==c.getAttribute("isPressed")&&(c.setAttribute("isPressed",""),n.triggerAttack("".concat(e[(0,r.Z)(s.children).indexOf(c)-12*a])+"".concat(i+a),l.Do.currentTime),s.children[(0,r.Z)(s.children).indexOf(c)].style.transform="rotateX(15deg)"),console.log("".concat(e[(0,r.Z)(s.children).indexOf(c)-12*a])+"".concat(i+a))},c.onmouseup=function(t){t.stopPropagation(),void 0!=c.getAttribute("isPressed")&&(c.removeAttribute("isPressed"),n.triggerRelease("".concat(e[(0,r.Z)(s.children).indexOf(c)-12*a])+"".concat(i+a),l.Do.currentTime),s.children[(0,r.Z)(s.children).indexOf(c)].style.transform=""),console.log("".concat(e[(0,r.Z)(s.children).indexOf(c)-12*a])+"".concat(i+a)),console.log(i),console.log(a)},c.onmouseleave=function(t){t.stopPropagation(),n.triggerRelease("".concat(e[(0,r.Z)(s.children).indexOf(c)-12*a])+"".concat(i+a),l.Do.currentTime),s.children[(0,r.Z)(s.children).indexOf(c)].style.transform=""},c.ontouchstart=function(e){e.stopPropagation(),e.preventDefault(),c.onmousedown(e)},c.ontouchend=c.ontouchcancel=function(e){e.stopPropagation(),e.preventDefault(),c.onmouseup(e)},(o+1)%12==0&&0!=o&&_++}(g);s.setAttribute("viewBox","0 0 ".concat(55*(0,r.Z)(s.children).filter(function(e){return e.classList.contains("tone")}).length+5," ").concat(285)),o.appendChild(s),window.onkeydown=function(e){var t=JSON.parse(localStorage.getItem("octavechangekeys"))||[];if(console.log("ock: ",t),console.log((0,a.d)(t,e.key.toLowerCase())),console.log((0,a.d)(t,e.key.toLowerCase()).length>0),(0,a.d)(t,e.key.toLowerCase()).length>0)console.log("octave key pressed"),e.key.toLowerCase()==t[0]?increaseOctave():decreaseOctave();else{e.stopPropagation();var o=JSON.parse(localStorage.getItem("keys"))||(localStorage.setItem("keys",JSON.stringify(["q","w","e","r","t","y","u","i","o","p","[","]"])),["q","w","e","r","t","y","u","i","o","p","[","]"]);console.log(o);var n=(0,a.d)(o,e.key.toLowerCase());if(console.log(e.key.toLowerCase()),void 0!=n)for(var r=0;r<n.length;r++){var i=Number(n[r])-Number(n[r])%12+P[n[r]%12];console.log("key",n),console.log("mapped",i),console.log(s.children),console.log(s.children[i]),s.children[i].dispatchEvent(new Event("mousedown")),console.log(s.children[i].getAttribute("isPressed"))}}},window.onkeyup=function(e){e.stopPropagation();var t=JSON.parse(localStorage.getItem("keys"))||(localStorage.setItem("keys",JSON.stringify(["q","w","e","r","t","y","u","i","o","p","[","]"])),JSON.stringify(["q","w","e","r","t","y","u","i","o","p","[","]"])),o=(0,a.d)(t,e.key.toLowerCase());if(console.log(e.key.toLowerCase()),void 0!=o)for(var n=0;n<o.length;n++){var r=Number(o[n])-Number(o[n])%12+P[o[n]%12];console.log("key",o),console.log("mapped",r),s.children[r].dispatchEvent(new Event("mouseup")),console.log(s.children[r].getAttribute("isPressed")),s.children[r].style.transform=""}}}}}),localStorage&&(console.log("rendered"),p(Number(localStorage.getItem("octave"))||3),console.log(localStorage),f(Number(localStorage.getItem("keysLength"))||12)),function(){window.onkeydown=null,window.onkeyup=null,n.releaseAll(0)}},[]),(0,c.useEffect)(function(){console.log(void 0==g),void 0!=g&&void 0!=y&&(localStorage.setItem("octave",g),console.log("local o",localStorage.getItem("octave")),console.log("o",g),y(g,m,"piano"))},[g]),(0,c.useEffect)(function(){void 0!=m&&void 0!=y&&(localStorage.setItem("keysLength",m),console.log("local ks",localStorage.getItem("keysLength")),console.log("ks",m),k(g),y(g,m,"piano"),console.log(y))},[m]),(0,c.useEffect)(function(){y(g,m)},[y]),(0,c.useEffect)(function(){renderSampler()},[]),(0,d.jsxs)("main",{className:i().main,children:[(0,d.jsx)("div",{className:[i().description,"center-block text-center m-2"],style:{lineHeight:"3rem"},children:(0,d.jsxs)("span",{children:["Simple digital synth based on ",(0,d.jsx)("h5",{children:(0,d.jsx)("a",{href:"https://tonejs.github.io/",target:"blank",children:"tone js"})})]})}),(0,d.jsxs)("div",{children:[(0,d.jsx)("span",{children:"Switch preset:"}),(0,d.jsxs)("select",{name:"presets",id:"presets",onChangeCapture:function(e){console.log(e.target.value),y(localStorage.getItem("octave")||3,localStorage.getItem("keysLength")||12,e.target.value)},children:[(0,d.jsx)("option",{value:"piano",children:"Piano"}),(0,d.jsx)("option",{value:"drums",children:"Drums"})]}),(0,d.jsx)("br",{}),(0,d.jsx)("span",{className:i().description,children:"*drums octaves are 3 and 4 (with no percussion)"})]}),(0,d.jsxs)("div",{className:"center-block container",children:[(0,d.jsxs)("h2",{id:"octaveValue",className:"text-center",children:["Least octave: ",g]}),(0,d.jsxs)("div",{className:"row",children:[(0,d.jsx)("div",{className:"col",children:(0,d.jsx)("button",{id:"octave+",className:"center-block",onClick:increaseOctave,children:"octave+"})}),(0,d.jsx)("div",{className:"col",children:(0,d.jsx)("button",{id:"octave-",className:"center-block",onClick:decreaseOctave,children:"octave-"})})]})]}),(0,d.jsxs)("div",{className:"center-block container",children:[(0,d.jsxs)("h2",{id:"keysValue",className:"text-center",children:["Keys: ",m]}),(0,d.jsxs)("div",{className:"row",children:[(0,d.jsx)("div",{className:"col",children:(0,d.jsx)("button",{id:"key+",className:"center-block",onClick:function(){m>=48||f(m+1)},children:"add key"})}),(0,d.jsx)("div",{className:"col",children:(0,d.jsx)("button",{id:"key-",className:"center-block",onClick:function(){m<1||f(m-1)},children:"remove key"})})]})]}),(0,d.jsxs)("div",{id:"sampler",style:{border:"3px solid black",borderRadius:"15px",background:"color-mix(in srgb, var(--background) 90%, white)",zIndex:"2147483647 !important",margin:"1.5rlh 0",padding:"0.5rlh",width:"80vw"},children:[(0,d.jsx)("span",{style:{textAlign:"center",display:"block",margin:"0.4rlh auto"},children:"Drum machine"}),(0,d.jsxs)("div",{id:"samplerouter",style:{display:"flex",justifyContent:"center",flexDirection:"column",alignItems:"center"},children:[(0,d.jsxs)("div",{id:"BPMTapper",children:[(0,d.jsx)("input",{onChangeCapture:function(e){O(e.target.value)},value:A}),(0,d.jsx)("div",{style:{display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"center",border:"3px solid var(--nav-background)",borderRadius:"10%",height:"6rlh",width:"6rlh",textAlign:"center",verticalAlign:"middle"},onClick:function(e){console.log(e),console.log(j),j&&O(Math.round(6e4/(e.timeStamp-j))),C(e.timeStamp)},children:"Tap"})]}),(0,d.jsxs)("form",{onSubmitCapture:function(e){var t,o;return e.preventDefault(),console.log(e.target),t=e.target.querySelector("input#sampleName").value,o=e.target.querySelector("input#noteName").value,console.log(t),console.log(o),localStorage.setItem("samples",JSON.stringify(_objectSpread(_objectSpread({},JSON.parse(localStorage.getItem("samples"))),{},(0,n.Z)({},t||o,o)))),renderSampler(),!1},children:[(0,d.jsx)("input",{type:"text",placeholder:"Enter sample name...",style:{margin:"0.25rlh auto"},id:"sampleName"}),(0,d.jsx)("br",{}),(0,d.jsx)("input",{type:"text",placeholder:"Enter note on synth...",pattern:"[ACDFG]{1}#?[01234567]{1}|[BE]{1}[01234567]{1}",onInvalidCapture:function(e){console.log(e.target.validity.valid),e.target.setCustomValidity(/[ACDFG]{1}#?[01234567]{1}|[BE]{1}[01234567]{1}/.test(e.target.value)?"":"Note you've provided doesn't exist")},style:{margin:"0.25rlh auto"},id:"noteName",required:!0}),(0,d.jsx)("br",{}),(0,d.jsx)("input",{value:"submit",type:"submit",style:{display:"block",margin:"0.25rlh auto"}})]})]}),(0,d.jsx)("div",{id:"samples"})]}),(0,d.jsx)("div",{id:"synth"})]})}},9618:function(){},8518:function(e){e.exports={main:"page_main__nw1Wk",description:"page_description__lvaOp",code:"page_code__9AfUJ",grid:"page_grid__JZ9Cz",card:"page_card__Cf__u",center:"page_center__NcdcW",logo:"page_logo__ikIZE",content:"page_content___38fW",vercelLogo:"page_vercelLogo__YYFl1",rotate:"page_rotate__xIioM"}}},function(e){e.O(0,[738,97,971,650,744],function(){return e(e.s=6898)}),_N_E=e.O()}]);