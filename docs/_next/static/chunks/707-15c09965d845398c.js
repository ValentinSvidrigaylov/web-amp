(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[707],{7634:function(e,t,n){var i,s,r,o,a,l,u,c,h,d,p,f,m,g,v,y,A,S,x,T,C,N,w,b;i=n(2184),s=n(6358),r=n(1127),o=function(e,t,n){return{endTime:t,insertTime:n,type:"exponentialRampToValue",value:e}},a=function(e,t,n){return{endTime:t,insertTime:n,type:"linearRampToValue",value:e}},l=function(e,t){return{startTime:t,type:"setValue",value:e}},u=function(e,t,n){return{duration:n,startTime:t,type:"setValueCurve",values:e}},c=function(e,t,n){var i=n.startTime,s=n.target;return s+(t-s)*Math.exp((i-e)/n.timeConstant)},h=function(e){return"exponentialRampToValue"===e.type},d=function(e){return"linearRampToValue"===e.type},p=function(e){return h(e)||d(e)},f=function(e){return"setValue"===e.type},m=function(e){return"setValueCurve"===e.type},g=function getValueOfAutomationEventAtIndexAtTime(e,t,n,i){var s=e[t];return void 0===s?i:p(s)||f(s)?s.value:m(s)?s.values[s.values.length-1]:c(n,getValueOfAutomationEventAtIndexAtTime(e,t-1,s.startTime,i),s)},v=function(e,t,n,i,s){return void 0===n?[i.insertTime,s]:p(n)?[n.endTime,n.value]:f(n)?[n.startTime,n.value]:m(n)?[n.startTime+n.duration,n.values[n.values.length-1]]:[n.startTime,g(e,t-1,n.startTime,s)]},y=function(e){return"cancelAndHold"===e.type},A=function(e){return"cancelScheduledValues"===e.type},S=function(e){return y(e)||A(e)?e.cancelTime:h(e)||d(e)?e.endTime:e.startTime},x=function(e,t,n,i){var s=i.endTime,r=i.value;return n===r?r:0<n&&0<r||n<0&&r<0?n*Math.pow(r/n,(e-t)/(s-t)):0},T=function(e,t,n,i){return n+(e-t)/(i.endTime-t)*(i.value-n)},C=function(e,t){var n=Math.floor(t),i=Math.ceil(t);return n===i?e[n]:(1-(t-n))*e[n]+(1-(i-t))*e[i]},N=function(e,t){var n=t.duration,i=t.startTime,s=t.values,r=(e-i)/n*(s.length-1);return C(s,r)},w=function(e){return"setTarget"===e.type},b=function(e){function AutomationEventList(e){s(this,AutomationEventList),this._automationEvents=[],this._currenTime=0,this._defaultValue=e}return r(AutomationEventList,[{key:e,value:function(){return this._automationEvents[Symbol.iterator]()}},{key:"add",value:function(e){var t=S(e);if(y(e)||A(e)){var n=this._automationEvents.findIndex(function(n){return A(e)&&m(n)?n.startTime+n.duration>=t:S(n)>=t}),i=this._automationEvents[n];if(-1!==n&&(this._automationEvents=this._automationEvents.slice(0,n)),y(e)){var s=this._automationEvents[this._automationEvents.length-1];if(void 0!==i&&p(i)){if(void 0!==s&&w(s))throw Error("The internal list is malformed.");var r=void 0===s?i.insertTime:m(s)?s.startTime+s.duration:S(s),c=void 0===s?this._defaultValue:m(s)?s.values[s.values.length-1]:s.value,f=h(i)?x(t,r,c,i):T(t,r,c,i),g=h(i)?o(f,t,this._currenTime):a(f,t,this._currenTime);this._automationEvents.push(g)}if(void 0!==s&&w(s)&&this._automationEvents.push(l(this.getValue(t),t)),void 0!==s&&m(s)&&s.startTime+s.duration>t){var v=t-s.startTime,C=(s.values.length-1)/s.duration,N=Math.max(2,1+Math.ceil(v*C)),b=v/(N-1)*C,O=s.values.slice(0,N);if(b<1)for(var k=1;k<N;k+=1){var M=b*k%1;O[k]=s.values[k-1]*(1-M)+s.values[k]*M}this._automationEvents[this._automationEvents.length-1]=u(O,s.startTime,v)}}}else{var E=this._automationEvents.findIndex(function(e){return S(e)>t}),D=-1===E?this._automationEvents[this._automationEvents.length-1]:this._automationEvents[E-1];if(void 0!==D&&m(D)&&S(D)+D.duration>t)return!1;var I=h(e)?o(e.value,e.endTime,this._currenTime):d(e)?a(e.value,t,this._currenTime):e;if(-1===E)this._automationEvents.push(I);else{if(m(e)&&t+e.duration>S(this._automationEvents[E]))return!1;this._automationEvents.splice(E,0,I)}}return!0}},{key:"flush",value:function(e){var t=this._automationEvents.findIndex(function(t){return S(t)>e});if(t>1){var n=this._automationEvents.slice(t-1),i=n[0];w(i)&&n.unshift(l(g(this._automationEvents,t-2,i.startTime,this._defaultValue),i.startTime)),this._automationEvents=n}}},{key:"getValue",value:function(e){if(0===this._automationEvents.length)return this._defaultValue;var t=this._automationEvents.findIndex(function(t){return S(t)>e}),n=this._automationEvents[t],s=(-1===t?this._automationEvents.length:t)-1,r=this._automationEvents[s];if(void 0!==r&&w(r)&&(void 0===n||!p(n)||n.insertTime>e))return c(e,g(this._automationEvents,s-1,r.startTime,this._defaultValue),r);if(void 0!==r&&f(r)&&(void 0===n||!p(n)))return r.value;if(void 0!==r&&m(r)&&(void 0===n||!p(n)||r.startTime+r.duration>e))return e<r.startTime+r.duration?N(e,r):r.values[r.values.length-1];if(void 0!==r&&p(r)&&(void 0===n||!p(n)))return r.value;if(void 0!==n&&h(n)){var o=i(v(this._automationEvents,s,r,n,this._defaultValue),2);return x(e,o[0],o[1],n)}if(void 0!==n&&d(n)){var a=i(v(this._automationEvents,s,r,n,this._defaultValue),2);return T(e,a[0],a[1],n)}return this._defaultValue}}]),AutomationEventList}(Symbol.iterator),t.AutomationEventList=b,t.createCancelAndHoldAutomationEvent=function(e){return{cancelTime:e,type:"cancelAndHold"}},t.createCancelScheduledValuesAutomationEvent=function(e){return{cancelTime:e,type:"cancelScheduledValues"}},t.createExponentialRampToValueAutomationEvent=function(e,t){return{endTime:t,type:"exponentialRampToValue",value:e}},t.createLinearRampToValueAutomationEvent=function(e,t){return{endTime:t,type:"linearRampToValue",value:e}},t.createSetTargetAutomationEvent=function(e,t,n){return{startTime:t,target:e,timeConstant:n,type:"setTarget"}},t.createSetValueAutomationEvent=l,t.createSetValueCurveAutomationEvent=u},5348:function(e,t,n){"use strict";let i,s;n.d(t,{Hm:function(){return nu},c9:function(){return np},uM:function(){return nf},E_:function(){return isAnyAudioContext},D2:function(){return isAnyAudioNode},Qz:function(){return isAnyAudioParam},km:function(){return isAnyOfflineAudioContext}});var r,o,a,l,u,c,h,d,p,f,m,g,v,y,A,S,x,T,C,N,w,b,O,k,M,E,D,I,P,R,F,V,q,B,W,L,G,j,Y,z,U,H,$,K,Z,X,Q,J,ee,et,en,ei,es,er,eo,ea,el,eu,ec,eh,ed,ep,ef,em,e_,eg,ev,ey,eA,eS,ex,eT,eC,eN,ew,eb,eO,ek,eM,eE,eD,eI,eP,eR,eF,eV,eq,eB,eW,eL,eG,ej,eY,ez,eU,eH,e$,eK,eZ,eX,eQ,eJ=n(7634);let e0=new WeakSet,e1=new WeakMap,e2=new WeakMap,e8=new WeakMap,e3=new WeakMap,e6=new WeakMap,e4=new WeakMap,e9=new WeakMap,e5=new WeakMap,e7=new WeakMap,te={construct:()=>te},isConstructible=e=>{try{let t=new Proxy(e,te);new t}catch{return!1}return!0},tt=/^import(?:(?:[\s]+[\w]+|(?:[\s]+[\w]+[\s]*,)?[\s]*\{[\s]*[\w]+(?:[\s]+as[\s]+[\w]+)?(?:[\s]*,[\s]*[\w]+(?:[\s]+as[\s]+[\w]+)?)*[\s]*}|(?:[\s]+[\w]+[\s]*,)?[\s]*\*[\s]+as[\s]+[\w]+)[\s]+from)?(?:[\s]*)("([^"\\]|\\.)+"|'([^'\\]|\\.)+')(?:[\s]*);?/,splitImportStatements=(e,t)=>{let n=[],i=e.replace(/^[\s]+/,""),s=i.match(tt);for(;null!==s;){let e=s[1].slice(1,-1),r=s[0].replace(/([\s]+)?;?$/,"").replace(e,new URL(e,t).toString());n.push(r),s=(i=i.slice(s[0].length).replace(/^[\s]+/,"")).match(tt)}return[n.join(";"),i]},verifyParameterDescriptors=e=>{if(void 0!==e&&!Array.isArray(e))throw TypeError("The parameterDescriptors property of given value for processorCtor is not an array.")},verifyProcessorCtor=e=>{if(!isConstructible(e))throw TypeError("The given value for processorCtor should be a constructor.");if(null===e.prototype||"object"!=typeof e.prototype)throw TypeError("The given value for processorCtor should have a prototype.")},getValueForKey=(e,t)=>{let n=e.get(t);if(void 0===n)throw Error("A value with the given key could not be found.");return n},pickElementFromSet=(e,t)=>{let n=Array.from(e).filter(t);if(n.length>1)throw Error("More than one element was found.");if(0===n.length)throw Error("No element was found.");let[i]=n;return e.delete(i),i},deletePassiveInputConnectionToAudioNode=(e,t,n,i)=>{let s=getValueForKey(e,t),r=pickElementFromSet(s,e=>e[0]===n&&e[1]===i);return 0===s.size&&e.delete(t),r},getEventListenersOfAudioNode=e=>getValueForKey(e4,e),setInternalStateToActive=e=>{if(e0.has(e))throw Error("The AudioNode is already stored.");e0.add(e),getEventListenersOfAudioNode(e).forEach(e=>e(!0))},isAudioWorkletNode=e=>"port"in e,setInternalStateToPassive=e=>{if(!e0.has(e))throw Error("The AudioNode is not stored.");e0.delete(e),getEventListenersOfAudioNode(e).forEach(e=>e(!1))},setInternalStateToPassiveWhenNecessary=(e,t)=>{!isAudioWorkletNode(e)&&t.every(e=>0===e.size)&&setInternalStateToPassive(e)},tn={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",fftSize:2048,maxDecibels:-30,minDecibels:-100,smoothingTimeConstant:.8},isOwnedByContext=(e,t)=>e.context===t,testAudioBufferCopyChannelMethodsOutOfBoundsSupport=e=>{try{e.copyToChannel(new Float32Array(1),0,-1)}catch{return!1}return!0},createIndexSizeError=()=>new DOMException("","IndexSizeError"),wrapAudioBufferGetChannelDataMethod=e=>{var t;e.getChannelData=(t=e.getChannelData,n=>{try{return t.call(e,n)}catch(e){if(12===e.code)throw createIndexSizeError();throw e}})},ti={numberOfChannels:1},isActiveAudioNode=e=>e0.has(e),ts={buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1},isAudioBufferSourceNode=e=>"playbackRate"in e,isBiquadFilterNode=e=>"frequency"in e&&"gain"in e,isConstantSourceNode=e=>"offset"in e,isGainNode=e=>!("frequency"in e)&&"gain"in e,isOscillatorNode=e=>"detune"in e&&"frequency"in e,isStereoPannerNode=e=>"pan"in e,getAudioNodeConnections=e=>getValueForKey(e1,e),getAudioParamConnections=e=>getValueForKey(e8,e),deactivateActiveAudioNodeInputConnections=(e,t)=>{let{activeInputs:n}=getAudioNodeConnections(e);n.forEach(n=>n.forEach(([n])=>{t.includes(e)||deactivateActiveAudioNodeInputConnections(n,[...t,e])}));let i=isAudioBufferSourceNode(e)?[e.playbackRate]:isAudioWorkletNode(e)?Array.from(e.parameters.values()):isBiquadFilterNode(e)?[e.Q,e.detune,e.frequency,e.gain]:isConstantSourceNode(e)?[e.offset]:isGainNode(e)?[e.gain]:isOscillatorNode(e)?[e.detune,e.frequency]:isStereoPannerNode(e)?[e.pan]:[];for(let e of i){let n=getAudioParamConnections(e);void 0!==n&&n.activeInputs.forEach(([e])=>deactivateActiveAudioNodeInputConnections(e,t))}isActiveAudioNode(e)&&setInternalStateToPassive(e)},deactivateAudioGraph=e=>{deactivateActiveAudioNodeInputConnections(e.destination,[])},isValidLatencyHint=e=>void 0===e||"number"==typeof e||"string"==typeof e&&("balanced"===e||"interactive"===e||"playback"===e),isAudioNode=e=>"context"in e,isAudioNodeOutputConnection=e=>isAudioNode(e[0]),insertElementInSet=(e,t,n,i)=>{for(let t of e)if(n(t)){if(i)return!1;throw Error("The set contains at least one similar element.")}return e.add(t),!0},addActiveInputConnectionToAudioParam=(e,t,[n,i],s)=>{insertElementInSet(e,[t,n,i],e=>e[0]===t&&e[1]===n,s)},addPassiveInputConnectionToAudioParam=(e,[t,n,i],s)=>{let r=e.get(t);void 0===r?e.set(t,new Set([[n,i]])):insertElementInSet(r,[n,i],e=>e[0]===n,s)},isNativeAudioNodeFaker=e=>"inputs"in e,connectNativeAudioNodeToNativeAudioNode=(e,t,n,i)=>{if(isNativeAudioNodeFaker(t)){let s=t.inputs[i];return e.connect(s,n,0),[s,n,0]}return e.connect(t,n,i),[t,n,i]},deleteActiveInputConnection=(e,t,n)=>{for(let i of e)if(i[0]===t&&i[1]===n)return e.delete(i),i;return null},deleteActiveInputConnectionToAudioParam=(e,t,n)=>pickElementFromSet(e,e=>e[0]===t&&e[1]===n),deleteEventListenerOfAudioNode=(e,t)=>{let n=getEventListenersOfAudioNode(e);if(!n.delete(t))throw Error("Missing the expected event listener.")},deletePassiveInputConnectionToAudioParam=(e,t,n)=>{let i=getValueForKey(e,t),s=pickElementFromSet(i,e=>e[0]===n);return 0===i.size&&e.delete(t),s},disconnectNativeAudioNodeFromNativeAudioNode=(e,t,n,i)=>{isNativeAudioNodeFaker(t)?e.disconnect(t.inputs[i],n,0):e.disconnect(t,n,i)},getNativeAudioNode=e=>getValueForKey(e2,e),getNativeAudioParam=e=>getValueForKey(e3,e),isPartOfACycle=e=>e9.has(e),isPassiveAudioNode=e=>!e0.has(e),testAudioNodeDisconnectMethodSupport=(e,t)=>new Promise(n=>{if(null!==t)n(!0);else{let t=e.createScriptProcessor(256,1,1),i=e.createGain(),s=e.createBuffer(1,2,44100),r=s.getChannelData(0);r[0]=1,r[1]=1;let o=e.createBufferSource();o.buffer=s,o.loop=!0,o.connect(t).connect(e.destination),o.connect(i),o.disconnect(i),t.onaudioprocess=i=>{let s=i.inputBuffer.getChannelData(0);Array.prototype.some.call(s,e=>1===e)?n(!0):n(!1),o.stop(),t.onaudioprocess=null,o.disconnect(t),t.disconnect(e.destination)},o.start()}}),visitEachAudioNodeOnce=(e,t)=>{let n=new Map;for(let t of e)for(let e of t){let t=n.get(e);n.set(e,void 0===t?1:t+1)}n.forEach((e,n)=>t(n,e))},isNativeAudioNode=e=>"context"in e,wrapAudioNodeDisconnectMethod=e=>{var t,n;let i=new Map;e.connect=(t=e.connect.bind(e),(e,n=0,s=0)=>{let r=isNativeAudioNode(e)?t(e,n,s):t(e,n),o=i.get(e);return void 0===o?i.set(e,[{input:s,output:n}]):o.every(e=>e.input!==s||e.output!==n)&&o.push({input:s,output:n}),r}),e.disconnect=(n=e.disconnect,(t,s,r)=>{if(n.apply(e),void 0===t)i.clear();else if("number"==typeof t)for(let[e,n]of i){let s=n.filter(e=>e.output!==t);0===s.length?i.delete(e):i.set(e,s)}else if(i.has(t)){if(void 0===s)i.delete(t);else{let e=i.get(t);if(void 0!==e){let n=e.filter(e=>e.output!==s&&(e.input!==r||void 0===r));0===n.length?i.delete(t):i.set(t,n)}}}for(let[t,n]of i)n.forEach(n=>{isNativeAudioNode(t)?e.connect(t,n.output,n.input):e.connect(t,n.output)})})},addConnectionToAudioParamOfAudioContext=(e,t,n,i)=>{let{activeInputs:s,passiveInputs:r}=getAudioParamConnections(t),{outputs:o}=getAudioNodeConnections(e),a=getEventListenersOfAudioNode(e),eventListener=o=>{let a=getNativeAudioNode(e),l=getNativeAudioParam(t);if(o){let t=deletePassiveInputConnectionToAudioParam(r,e,n);addActiveInputConnectionToAudioParam(s,e,t,!1),i||isPartOfACycle(e)||a.connect(l,n)}else{let t=deleteActiveInputConnectionToAudioParam(s,e,n);addPassiveInputConnectionToAudioParam(r,t,!1),i||isPartOfACycle(e)||a.disconnect(l,n)}};return!!insertElementInSet(o,[t,n],e=>e[0]===t&&e[1]===n,!0)&&(a.add(eventListener),isActiveAudioNode(e)?addActiveInputConnectionToAudioParam(s,e,[n,eventListener],!0):addPassiveInputConnectionToAudioParam(r,[e,n,eventListener],!0),!0)},deleteInputConnectionOfAudioNode=(e,t,n,i)=>{let{activeInputs:s,passiveInputs:r}=getAudioNodeConnections(t),o=deleteActiveInputConnection(s[i],e,n);if(null===o){let t=deletePassiveInputConnectionToAudioNode(r,e,n,i);return[t[2],!1]}return[o[2],!0]},deleteInputConnectionOfAudioParam=(e,t,n)=>{let{activeInputs:i,passiveInputs:s}=getAudioParamConnections(t),r=deleteActiveInputConnection(i,e,n);if(null===r){let t=deletePassiveInputConnectionToAudioParam(s,e,n);return[t[1],!1]}return[r[2],!0]},deleteInputsOfAudioNode=(e,t,n,i,s)=>{let[r,o]=deleteInputConnectionOfAudioNode(e,n,i,s);if(null===r||(deleteEventListenerOfAudioNode(e,r),!o||t||isPartOfACycle(e)||disconnectNativeAudioNodeFromNativeAudioNode(getNativeAudioNode(e),getNativeAudioNode(n),i,s)),isActiveAudioNode(n)){let{activeInputs:e}=getAudioNodeConnections(n);setInternalStateToPassiveWhenNecessary(n,e)}},deleteInputsOfAudioParam=(e,t,n,i)=>{let[s,r]=deleteInputConnectionOfAudioParam(e,n,i);null===s||(deleteEventListenerOfAudioNode(e,s),!r||t||isPartOfACycle(e)||getNativeAudioNode(e).disconnect(getNativeAudioParam(n),i))},deleteAnyConnection=(e,t)=>{let n=getAudioNodeConnections(e),i=[];for(let s of n.outputs)isAudioNodeOutputConnection(s)?deleteInputsOfAudioNode(e,t,...s):deleteInputsOfAudioParam(e,t,...s),i.push(s[0]);return n.outputs.clear(),i},deleteConnectionAtOutput=(e,t,n)=>{let i=getAudioNodeConnections(e),s=[];for(let r of i.outputs)r[1]===n&&(isAudioNodeOutputConnection(r)?deleteInputsOfAudioNode(e,t,...r):deleteInputsOfAudioParam(e,t,...r),s.push(r[0]),i.outputs.delete(r));return s},deleteConnectionToDestination=(e,t,n,i,s)=>{let r=getAudioNodeConnections(e);return Array.from(r.outputs).filter(e=>e[0]===n&&(void 0===i||e[1]===i)&&(void 0===s||e[2]===s)).map(n=>(isAudioNodeOutputConnection(n)?deleteInputsOfAudioNode(e,t,...n):deleteInputsOfAudioParam(e,t,...n),r.outputs.delete(n),n[0]))};let ReadOnlyMap=class ReadOnlyMap{constructor(e){this._map=new Map(e)}get size(){return this._map.size}entries(){return this._map.entries()}forEach(e,t=null){return this._map.forEach((n,i)=>e.call(t,n,i,this))}get(e){return this._map.get(e)}has(e){return this._map.has(e)}keys(){return this._map.keys()}values(){return this._map.values()}};let tr={channelCount:2,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:1,numberOfOutputs:1,parameterData:{},processorOptions:{}};function copyFromChannel(e,t,n,i,s){if("function"==typeof e.copyFromChannel)0===t[n].byteLength&&(t[n]=new Float32Array(128)),e.copyFromChannel(t[n],i,s);else{let r=e.getChannelData(i);if(0===t[n].byteLength)t[n]=r.slice(s,s+128);else{let e=new Float32Array(r.buffer,s*Float32Array.BYTES_PER_ELEMENT,128);t[n].set(e)}}}let copyToChannel=(e,t,n,i,s)=>{"function"==typeof e.copyToChannel?0!==t[n].byteLength&&e.copyToChannel(t[n],i,s):0!==t[n].byteLength&&e.getChannelData(i).set(t[n],s)},createNestedArrays=(e,t)=>{let n=[];for(let i=0;i<e;i+=1){let e=[],s="number"==typeof t?t:t[i];for(let t=0;t<s;t+=1)e.push(new Float32Array(128));n.push(e)}return n},getAudioWorkletProcessor=(e,t)=>{let n=getValueForKey(e7,e),i=getNativeAudioNode(t);return getValueForKey(n,i)},processBuffer=async(e,t,n,i,s,r,o)=>{let a=null===t?128*Math.ceil(e.context.length/128):t.length,l=i.channelCount*i.numberOfInputs,u=s.reduce((e,t)=>e+t,0),c=0===u?null:n.createBuffer(u,a,n.sampleRate);if(void 0===r)throw Error("Missing the processor constructor.");let h=getAudioNodeConnections(e),d=await getAudioWorkletProcessor(n,e),p=createNestedArrays(i.numberOfInputs,i.channelCount),f=createNestedArrays(i.numberOfOutputs,s),m=Array.from(e.parameters.keys()).reduce((e,t)=>({...e,[t]:new Float32Array(128)}),{});for(let u=0;u<a;u+=128){if(i.numberOfInputs>0&&null!==t)for(let e=0;e<i.numberOfInputs;e+=1)for(let n=0;n<i.channelCount;n+=1)copyFromChannel(t,p[e],n,n,u);void 0!==r.parameterDescriptors&&null!==t&&r.parameterDescriptors.forEach(({name:e},n)=>{copyFromChannel(t,m,e,l+n,u)});for(let e=0;e<i.numberOfInputs;e+=1)for(let t=0;t<s[e];t+=1)0===f[e][t].byteLength&&(f[e][t]=new Float32Array(128));try{let e=p.map((e,t)=>0===h.activeInputs[t].size?[]:e),t=o(u/n.sampleRate,n.sampleRate,()=>d.process(e,f,m));if(null!==c)for(let e=0,t=0;e<i.numberOfOutputs;e+=1){for(let n=0;n<s[e];n+=1)copyToChannel(c,f[e],n,t+n,u);t+=s[e]}if(!t)break}catch(t){e.dispatchEvent(new ErrorEvent("processorerror",{colno:t.colno,filename:t.filename,lineno:t.lineno,message:t.message}));break}}return c},to={Q:1,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",detune:0,frequency:350,gain:0,type:"lowpass"},ta={channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:6},tl={channelCount:6,channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:6},tu={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",offset:1},tc={buffer:null,channelCount:2,channelCountMode:"clamped-max",channelInterpretation:"speakers",disableNormalization:!1},detachArrayBuffer=e=>{let{port1:t,port2:n}=new MessageChannel;return new Promise(i=>{let closeAndResolve=()=>{n.onmessage=null,t.close(),n.close(),i()};n.onmessage=()=>closeAndResolve();try{t.postMessage(e,[e])}catch{}finally{closeAndResolve()}})},th={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",delayTime:0,maxDelayTime:1},isDelayNode=e=>"delayTime"in e,getOutputAudioNodeAtIndex=(e,t,n)=>{let i=t[n];if(void 0===i)throw e();return i},td={attack:.003,channelCount:2,channelCountMode:"clamped-max",channelInterpretation:"speakers",knee:30,ratio:12,release:.25,threshold:-24},tp={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",gain:1},createInvalidStateError=()=>new DOMException("","InvalidStateError"),createInvalidAccessError=()=>new DOMException("","InvalidAccessError"),wrapIIRFilterNodeGetFrequencyResponseMethod=e=>{var t;e.getFrequencyResponse=(t=e.getFrequencyResponse,(n,i,s)=>{if(n.length!==i.length||i.length!==s.length)throw createInvalidAccessError();return t.call(e,n,i,s)})},tf={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers"},filterBuffer=(e,t,n,i,s,r,o,a,l,u,c)=>{let h=u.length,d=a;for(let a=0;a<h;a+=1){let h=n[0]*u[a];for(let t=1;t<s;t+=1){let i=d-t&l-1;h+=n[t]*r[i],h-=e[t]*o[i]}for(let e=s;e<i;e+=1)h+=n[e]*r[d-e&l-1];for(let n=s;n<t;n+=1)h-=e[n]*o[d-n&l-1];r[d]=u[a],o[d]=h,d=d+1&l-1,c[a]=h}return d},filterFullBuffer=(e,t,n,i)=>{let s=n instanceof Float64Array?n:new Float64Array(n),r=i instanceof Float64Array?i:new Float64Array(i),o=s.length,a=r.length,l=Math.min(o,a);if(1!==s[0]){for(let e=0;e<o;e+=1)r[e]/=s[0];for(let e=1;e<a;e+=1)s[e]/=s[0]}let u=new Float32Array(32),c=new Float32Array(32),h=t.createBuffer(e.numberOfChannels,e.length,e.sampleRate),d=e.numberOfChannels;for(let t=0;t<d;t+=1){let n=e.getChannelData(t),i=h.getChannelData(t);u.fill(0),c.fill(0),filterBuffer(s,o,r,a,l,u,c,0,32,n,i)}return h},tm={channelCount:2,channelCountMode:"explicit",channelInterpretation:"speakers"},testPromiseSupport=e=>{let t=new Uint32Array([1179011410,40,1163280727,544501094,16,131073,44100,176400,1048580,1635017060,4,0]);try{let n=e.decodeAudioData(t.buffer,()=>{});if(void 0===n)return!1;return n.catch(()=>{}),!0}catch{}return!1},assignNativeAudioNodeOption=(e,t,n)=>{let i=t[n];void 0!==i&&i!==e[n]&&(e[n]=i)},assignNativeAudioNodeOptions=(e,t)=>{assignNativeAudioNodeOption(e,t,"channelCount"),assignNativeAudioNodeOption(e,t,"channelCountMode"),assignNativeAudioNodeOption(e,t,"channelInterpretation")},testAnalyserNodeGetFloatTimeDomainDataMethodSupport=e=>"function"==typeof e.getFloatTimeDomainData,wrapAnalyserNodeGetFloatTimeDomainDataMethod=e=>{e.getFloatTimeDomainData=t=>{let n=new Uint8Array(t.length);e.getByteTimeDomainData(n);let i=Math.max(n.length,e.fftSize);for(let e=0;e<i;e+=1)t[e]=(n[e]-128)*.0078125;return t}},assignNativeAudioNodeAudioParamValue=(e,t,n)=>{let i=t[n];void 0!==i&&i!==e[n].value&&(e[n].value=i)},wrapAudioBufferSourceNodeStartMethodConsecutiveCalls=e=>{var t;let n;e.start=(t=e.start,n=!1,(i=0,s=0,r)=>{if(n)throw createInvalidStateError();t.call(e,i,s,r),n=!0})},wrapAudioScheduledSourceNodeStartMethodNegativeParameters=e=>{var t;e.start=(t=e.start,(n=0,i=0,s)=>{if("number"==typeof s&&s<0||i<0||n<0)throw RangeError("The parameters can't be negative.");t.call(e,n,i,s)})},wrapAudioScheduledSourceNodeStopMethodNegativeParameters=e=>{var t;e.stop=(t=e.stop,(n=0)=>{if(n<0)throw RangeError("The parameter can't be negative.");t.call(e,n)})},testClonabilityOfAudioWorkletNodeOptions=e=>{let{port1:t}=new MessageChannel;try{t.postMessage(e)}finally{t.close()}},computeBufferSize=(e,t)=>null===e?512:Math.max(512,Math.min(16384,Math.pow(2,Math.round(Math.log2(e*t))))),cloneAudioWorkletNodeOptions=e=>new Promise((t,n)=>{let{port1:i,port2:s}=new MessageChannel;i.onmessage=({data:e})=>{i.close(),s.close(),t(e)},i.onmessageerror=({data:e})=>{i.close(),s.close(),n(e)},s.postMessage(e)}),createAudioWorkletProcessorPromise=async(e,t)=>{let n=await cloneAudioWorkletNodeOptions(t);return new e(n)},createAudioWorkletProcessor=(e,t,n,i)=>{let s=e7.get(e);void 0===s&&(s=new WeakMap,e7.set(e,s));let r=createAudioWorkletProcessorPromise(n,i);return s.set(t,r),r},createNativeBiquadFilterNode=(e,t)=>{let n=e.createBiquadFilter();return assignNativeAudioNodeOptions(n,t),assignNativeAudioNodeAudioParamValue(n,t,"Q"),assignNativeAudioNodeAudioParamValue(n,t,"detune"),assignNativeAudioNodeAudioParamValue(n,t,"frequency"),assignNativeAudioNodeAudioParamValue(n,t,"gain"),assignNativeAudioNodeOption(n,t,"type"),n},wrapChannelSplitterNode=e=>{let t=e.numberOfOutputs;Object.defineProperty(e,"channelCount",{get:()=>t,set:e=>{if(e!==t)throw createInvalidStateError()}}),Object.defineProperty(e,"channelCountMode",{get:()=>"explicit",set:e=>{if("explicit"!==e)throw createInvalidStateError()}}),Object.defineProperty(e,"channelInterpretation",{get:()=>"discrete",set:e=>{if("discrete"!==e)throw createInvalidStateError()}})},createNativeChannelSplitterNode=(e,t)=>{let n=e.createChannelSplitter(t.numberOfOutputs);return assignNativeAudioNodeOptions(n,t),wrapChannelSplitterNode(n),n},interceptConnections=(e,t)=>(e.connect=t.connect.bind(t),e.disconnect=t.disconnect.bind(t),e),createNativeDelayNode=(e,t)=>{let n=e.createDelay(t.maxDelayTime);return assignNativeAudioNodeOptions(n,t),assignNativeAudioNodeAudioParamValue(n,t,"delayTime"),n},createNativeGainNode=(e,t)=>{let n=e.createGain();return assignNativeAudioNodeOptions(n,t),assignNativeAudioNodeAudioParamValue(n,t,"gain"),n};function evaluatePolynomial(e,t){let n=[0,0];for(let s=e.length-1;s>=0;s-=1){var i;n=[(i=n)[0]*t[0]-i[1]*t[1],i[0]*t[1]+i[1]*t[0]],n[0]+=e[s]}return n}let createNativeScriptProcessorNode=(e,t,n,i)=>e.createScriptProcessor(t,n,i),createNotSupportedError=()=>new DOMException("","NotSupportedError"),t_={numberOfChannels:1},tg={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",detune:0,frequency:440,periodicWave:void 0,type:"sine"},tv={channelCount:2,channelCountMode:"clamped-max",channelInterpretation:"speakers",coneInnerAngle:360,coneOuterAngle:360,coneOuterGain:0,distanceModel:"inverse",maxDistance:1e4,orientationX:1,orientationY:0,orientationZ:0,panningModel:"equalpower",positionX:0,positionY:0,positionZ:0,refDistance:1,rolloffFactor:1},ty={disableNormalization:!1},tA={channelCount:2,channelCountMode:"explicit",channelInterpretation:"speakers",pan:0},createUnknownError=()=>new DOMException("","UnknownError"),tS={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",curve:null,oversample:"none"},getFirstSample=(e,t,n)=>void 0===e.copyFromChannel?e.getChannelData(n)[0]:(e.copyFromChannel(t,n),t[0]),isDCCurve=e=>{if(null===e)return!1;let t=e.length;return t%2!=0?0!==e[Math.floor(t/2)]:e[t/2-1]+e[t/2]!==0},overwriteAccessors=(e,t,n,i)=>{let s=e;for(;!s.hasOwnProperty(t);)s=Object.getPrototypeOf(s);let{get:r,set:o}=Object.getOwnPropertyDescriptor(s,t);Object.defineProperty(e,t,{get:n(r),set:i(o)})},setValueAtTimeUntilPossible=(e,t,n)=>{try{e.setValueAtTime(t,n)}catch(i){if(9!==i.code)throw i;setValueAtTimeUntilPossible(e,t,n+1e-7)}},testAudioScheduledSourceNodeStartMethodNegativeParametersSupport=e=>{let t=e.createOscillator();try{t.start(-1)}catch(e){return e instanceof RangeError}return!1},testAudioScheduledSourceNodeStopMethodConsecutiveCallsSupport=e=>{let t=e.createBuffer(1,1,44100),n=e.createBufferSource();n.buffer=t,n.start(),n.stop();try{return n.stop(),!0}catch{return!1}},testAudioScheduledSourceNodeStopMethodNegativeParametersSupport=e=>{let t=e.createOscillator();try{t.stop(-1)}catch(e){return e instanceof RangeError}return!1},wrapAudioScheduledSourceNodeStopMethodConsecutiveCalls=(e,t)=>{var n,i;let s;let r=t.createGain();e.connect(r);let o=(n=e.disconnect,()=>{n.call(e,r),e.removeEventListener("ended",o)});e.addEventListener("ended",o),interceptConnections(e,r),e.stop=(i=e.stop,s=!1,(t=0)=>{if(s)try{i.call(e,t)}catch{r.gain.setValueAtTime(0,t)}else i.call(e,t),s=!0})},wrapEventListener=(e,t)=>n=>{let i={value:e};return(Object.defineProperties(n,{currentTarget:i,target:i}),"function"==typeof t)?t.call(e,n):t.handleEvent.call(e,n)},tx=new WeakMap,tT=(r=new Map,o=new WeakMap,(e,t)=>{let n=o.get(e);if(void 0!==n)return n;let i=r.get(e);if(void 0!==i)return i;try{let n=t();if(n instanceof Promise)return r.set(e,n),n.catch(()=>!1).then(t=>(r.delete(e),o.set(e,t),t));return o.set(e,n),n}catch{return o.set(e,!1),!1}}),tC="undefined"==typeof window?null:window,createNativeAnalyserNode=(e,t)=>{let n=e.createAnalyser();if(assignNativeAudioNodeOptions(n,t),!(t.maxDecibels>t.minDecibels))throw createIndexSizeError();return assignNativeAudioNodeOption(n,t,"fftSize"),assignNativeAudioNodeOption(n,t,"maxDecibels"),assignNativeAudioNodeOption(n,t,"minDecibels"),assignNativeAudioNodeOption(n,t,"smoothingTimeConstant"),tT(testAnalyserNodeGetFloatTimeDomainDataMethodSupport,()=>testAnalyserNodeGetFloatTimeDomainDataMethodSupport(n))||wrapAnalyserNodeGetFloatTimeDomainDataMethod(n),n},getAudioNodeRenderer=e=>{let t=getAudioNodeConnections(e);if(null===t.renderer)throw Error("Missing the renderer of the given AudioNode in the audio graph.");return t.renderer},renderInputsOfAudioNode=async(e,t,n)=>{let i=getAudioNodeConnections(e);await Promise.all(i.activeInputs.map((i,s)=>Array.from(i).map(async([i,r])=>{let o=getAudioNodeRenderer(i),a=await o.render(i,t),l=e.context.destination;isPartOfACycle(i)||e===l&&isPartOfACycle(e)||a.connect(n,r,s)})).reduce((e,t)=>[...e,...t],[]))},getNativeContext=e=>{let t=e6.get(e);if(void 0===t)throw createInvalidStateError();return t},tN=null===tC?null:tC.hasOwnProperty("OfflineAudioContext")?tC.OfflineAudioContext:tC.hasOwnProperty("webkitOfflineAudioContext")?tC.webkitOfflineAudioContext:null,isNativeOfflineAudioContext=e=>null!==tN&&e instanceof tN,tw=new WeakMap,tb=class{constructor(e){this._nativeEventTarget=e,this._listeners=new WeakMap}addEventListener(e,t,n){if(null!==t){let i=this._listeners.get(t);void 0===i&&(i=wrapEventListener(this,t),"function"==typeof t&&this._listeners.set(t,i)),this._nativeEventTarget.addEventListener(e,i,n)}}dispatchEvent(e){return this._nativeEventTarget.dispatchEvent(e)}removeEventListener(e,t,n){let i=null===t?void 0:this._listeners.get(t);this._nativeEventTarget.removeEventListener(e,void 0===i?null:i,n)}},tO=null===tC?null:tC.hasOwnProperty("AudioContext")?tC.AudioContext:tC.hasOwnProperty("webkitAudioContext")?tC.webkitAudioContext:null,isNativeAudioContext=e=>null!==tO&&e instanceof tO,module_isNativeAudioNode=e=>null!==tC&&"function"==typeof tC.AudioNode&&e instanceof tC.AudioNode,isNativeAudioParam=e=>null!==tC&&"function"==typeof tC.AudioParam&&e instanceof tC.AudioParam,tk=null===tC?null:tC.hasOwnProperty("AudioWorkletNode")?tC.AudioWorkletNode:null,tM=(a=(e,t,n)=>{let i=[];for(let e=0;e<n.numberOfInputs;e+=1)i.push(new Set);e1.set(e,{activeInputs:i,outputs:new Set,passiveInputs:new WeakMap,renderer:t})},l=((e,t,n,i,s,r,o,a,l,u,c,h,d)=>{let p=new WeakMap;return(f,m,g,v,y)=>{let{activeInputs:A,passiveInputs:S}=r(m),{outputs:x}=r(f),T=a(f),eventListener=r=>{let a=l(m),u=l(f);if(r){let t=deletePassiveInputConnectionToAudioNode(S,f,g,v);e(A,f,t,!1),y||h(f)||n(u,a,g,v),d(m)&&setInternalStateToActive(m)}else{let e=i(A,f,g,v);t(S,v,e,!1),y||h(f)||s(u,a,g,v);let n=o(m);if(0===n)c(m)&&setInternalStateToPassiveWhenNecessary(m,A);else{let e=p.get(m);void 0!==e&&clearTimeout(e),p.set(m,setTimeout(()=>{c(m)&&setInternalStateToPassiveWhenNecessary(m,A)},1e3*n))}}};return!!u(x,[m,g,v],e=>e[0]===m&&e[1]===g&&e[2]===v,!0)&&(T.add(eventListener),c(f)?e(A,f,[g,v,eventListener],!0):t(S,v,[f,g,eventListener],!0),!0)}})((e,t,[n,i,s],r)=>{insertElementInSet(e[i],[t,n,s],e=>e[0]===t&&e[1]===n,r)},(e,t,[n,i,s],r)=>{let o=e.get(n);void 0===o?e.set(n,new Set([[i,t,s]])):insertElementInSet(o,[i,t,s],e=>e[0]===i&&e[1]===t,r)},connectNativeAudioNodeToNativeAudioNode,(e,t,n,i)=>pickElementFromSet(e[i],e=>e[0]===t&&e[1]===n),disconnectNativeAudioNodeFromNativeAudioNode,getAudioNodeConnections,e=>{var t;return null!==(t=tx.get(e))&&void 0!==t?t:0},getEventListenersOfAudioNode,getNativeAudioNode,insertElementInSet,isActiveAudioNode,isPartOfACycle,isPassiveAudioNode),u=e=>(t,n)=>{let i=e9.get(t);if(void 0===i){if(!e&&isActiveAudioNode(t)){let e=getNativeAudioNode(t),{outputs:n}=getAudioNodeConnections(t);for(let t of n)if(isAudioNodeOutputConnection(t)){let n=getNativeAudioNode(t[0]);disconnectNativeAudioNodeFromNativeAudioNode(e,n,t[1],t[2])}else{let n=getNativeAudioParam(t[0]);e.disconnect(n,t[1])}}e9.set(t,n)}else e9.set(t,i+n)},c=(e,t)=>{let n=e9.get(e);if(void 0===n)throw Error("Missing the expected cycle count.");let i=getNativeContext(e.context),s=isNativeOfflineAudioContext(i);if(n===t){if(e9.delete(e),!s&&isActiveAudioNode(e)){let t=getNativeAudioNode(e),{outputs:n}=getAudioNodeConnections(e);for(let e of n)if(isAudioNodeOutputConnection(e)){let n=getNativeAudioNode(e[0]);connectNativeAudioNodeToNativeAudioNode(t,n,e[1],e[2])}else{let n=getNativeAudioParam(e[0]);t.connect(n,e[1])}}}else e9.set(e,n-t)},h=function detectCycles(e,t){let n=isAudioNode(t)?t:getValueForKey(tw,t);if(isDelayNode(n))return[];if(e[0]===n)return[e];if(e.includes(n))return[];let{outputs:i}=getAudioNodeConnections(n);return Array.from(i).map(t=>detectCycles([...e,n],t[0])).reduce((e,t)=>e.concat(t),[])},d=tb,class extends d{constructor(e,t,n,i){super(n),this._context=e,this._nativeAudioNode=n;let s=getNativeContext(e);isNativeAudioContext(s)&&!0!==tT(testAudioNodeDisconnectMethodSupport,()=>testAudioNodeDisconnectMethodSupport(s,tk))&&wrapAudioNodeDisconnectMethod(n),e2.set(this,n),e4.set(this,new Set),"closed"!==e.state&&t&&setInternalStateToActive(this),a(this,i,n)}get channelCount(){return this._nativeAudioNode.channelCount}set channelCount(e){this._nativeAudioNode.channelCount=e}get channelCountMode(){return this._nativeAudioNode.channelCountMode}set channelCountMode(e){this._nativeAudioNode.channelCountMode=e}get channelInterpretation(){return this._nativeAudioNode.channelInterpretation}set channelInterpretation(e){this._nativeAudioNode.channelInterpretation=e}get context(){return this._context}get numberOfInputs(){return this._nativeAudioNode.numberOfInputs}get numberOfOutputs(){return this._nativeAudioNode.numberOfOutputs}connect(e,t=0,n=0){if(t<0||t>=this._nativeAudioNode.numberOfOutputs)throw createIndexSizeError();let i=getNativeContext(this._context),s=isNativeOfflineAudioContext(i);if(module_isNativeAudioNode(e)||isNativeAudioParam(e))throw createInvalidAccessError();if(isAudioNode(e)){let i=getNativeAudioNode(e);try{let r=connectNativeAudioNodeToNativeAudioNode(this._nativeAudioNode,i,t,n),o=isPassiveAudioNode(this);(s||o)&&this._nativeAudioNode.disconnect(...r),"closed"!==this.context.state&&!o&&isPassiveAudioNode(e)&&setInternalStateToActive(e)}catch(e){if(12===e.code)throw createInvalidAccessError();throw e}let r=l(this,e,t,n,s);if(r){let t=h([this],e);visitEachAudioNodeOnce(t,u(s))}return e}let r=getNativeAudioParam(e);if("playbackRate"===r.name&&1024===r.maxValue)throw createNotSupportedError();try{this._nativeAudioNode.connect(r,t),(s||isPassiveAudioNode(this))&&this._nativeAudioNode.disconnect(r,t)}catch(e){if(12===e.code)throw createInvalidAccessError();throw e}let o=addConnectionToAudioParamOfAudioContext(this,e,t,s);if(o){let t=h([this],e);visitEachAudioNodeOnce(t,u(s))}}disconnect(e,t,n){let i;let s=getNativeContext(this._context),r=isNativeOfflineAudioContext(s);if(void 0===e)i=deleteAnyConnection(this,r);else if("number"==typeof e){if(e<0||e>=this.numberOfOutputs)throw createIndexSizeError();i=deleteConnectionAtOutput(this,r,e)}else{if(void 0!==t&&(t<0||t>=this.numberOfOutputs)||isAudioNode(e)&&void 0!==n&&(n<0||n>=e.numberOfInputs))throw createIndexSizeError();if(0===(i=deleteConnectionToDestination(this,r,e,t,n)).length)throw createInvalidAccessError()}for(let e of i){let t=h([this],e);visitEachAudioNodeOnce(t,c)}}}),tE=(p=tM,f=()=>{let e=new WeakMap,createAnalyserNode=async(t,n)=>{let i=getNativeAudioNode(t),s=isOwnedByContext(i,n);if(!s){let e={channelCount:i.channelCount,channelCountMode:i.channelCountMode,channelInterpretation:i.channelInterpretation,fftSize:i.fftSize,maxDecibels:i.maxDecibels,minDecibels:i.minDecibels,smoothingTimeConstant:i.smoothingTimeConstant};i=createNativeAnalyserNode(n,e)}return e.set(n,i),await renderInputsOfAudioNode(t,n,i),i};return{render(t,n){let i=e.get(n);return void 0!==i?Promise.resolve(i):createAnalyserNode(t,n)}}},class extends p{constructor(e,t){let n=getNativeContext(e),i={...tn,...t},s=createNativeAnalyserNode(n,i),r=isNativeOfflineAudioContext(n)?f():null;super(e,!1,s,r),this._nativeAnalyserNode=s}get fftSize(){return this._nativeAnalyserNode.fftSize}set fftSize(e){this._nativeAnalyserNode.fftSize=e}get frequencyBinCount(){return this._nativeAnalyserNode.frequencyBinCount}get maxDecibels(){return this._nativeAnalyserNode.maxDecibels}set maxDecibels(e){let t=this._nativeAnalyserNode.maxDecibels;if(this._nativeAnalyserNode.maxDecibels=e,!(e>this._nativeAnalyserNode.minDecibels))throw this._nativeAnalyserNode.maxDecibels=t,createIndexSizeError()}get minDecibels(){return this._nativeAnalyserNode.minDecibels}set minDecibels(e){let t=this._nativeAnalyserNode.minDecibels;if(this._nativeAnalyserNode.minDecibels=e,!(this._nativeAnalyserNode.maxDecibels>e))throw this._nativeAnalyserNode.minDecibels=t,createIndexSizeError()}get smoothingTimeConstant(){return this._nativeAnalyserNode.smoothingTimeConstant}set smoothingTimeConstant(e){this._nativeAnalyserNode.smoothingTimeConstant=e}getByteFrequencyData(e){this._nativeAnalyserNode.getByteFrequencyData(e)}getByteTimeDomainData(e){this._nativeAnalyserNode.getByteTimeDomainData(e)}getFloatFrequencyData(e){this._nativeAnalyserNode.getFloatFrequencyData(e)}getFloatTimeDomainData(e){this._nativeAnalyserNode.getFloatTimeDomainData(e)}}),tD=new WeakSet,tI=null===tC?null:tC.hasOwnProperty("AudioBuffer")?tC.AudioBuffer:null,tP=(m=new Uint32Array(1),e=>(m[0]=e,m[0])),wrapAudioBufferCopyChannelMethods=e=>{e.copyFromChannel=(t,n,i=0)=>{let s=tP(i),r=tP(n);if(r>=e.numberOfChannels)throw createIndexSizeError();let o=e.length,a=e.getChannelData(r),l=t.length;for(let e=s<0?-s:0;e+s<o&&e<l;e+=1)t[e]=a[e+s]},e.copyToChannel=(t,n,i=0)=>{let s=tP(i),r=tP(n);if(r>=e.numberOfChannels)throw createIndexSizeError();let o=e.length,a=e.getChannelData(r),l=t.length;for(let e=s<0?-s:0;e+s<o&&e<l;e+=1)a[e+s]=t[e]}},wrapAudioBufferCopyChannelMethodsOutOfBounds=e=>{var t,n;e.copyFromChannel=(t=e.copyFromChannel,(n,i,s=0)=>{let r=tP(s),o=tP(i);if(r<e.length)return t.call(e,n,o,r)}),e.copyToChannel=(n=e.copyToChannel,(t,i,s=0)=>{let r=tP(s),o=tP(i);if(r<e.length)return n.call(e,t,o,r)})},tR=(g=()=>{if(null===tI)return!1;try{new tI({length:1,sampleRate:44100})}catch{return!1}return!0},i=null,class AudioBuffer{constructor(e){if(null===tN)throw Error("Missing the native OfflineAudioContext constructor.");let{length:t,numberOfChannels:n,sampleRate:s}={...ti,...e};null===i&&(i=new tN(1,1,44100));let r=null!==tI&&tT(g,g)?new tI({length:t,numberOfChannels:n,sampleRate:s}):i.createBuffer(n,t,s);if(0===r.numberOfChannels)throw createNotSupportedError();return"function"!=typeof r.copyFromChannel?(wrapAudioBufferCopyChannelMethods(r),wrapAudioBufferGetChannelDataMethod(r)):tT(testAudioBufferCopyChannelMethodsOutOfBoundsSupport,()=>testAudioBufferCopyChannelMethodsOutOfBoundsSupport(r))||wrapAudioBufferCopyChannelMethodsOutOfBounds(r),tD.add(r),r}static[Symbol.hasInstance](e){return null!==e&&"object"==typeof e&&Object.getPrototypeOf(e)===AudioBuffer.prototype||tD.has(e)}}),addSilentConnection=(e,t)=>{let n=createNativeGainNode(e,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0});t.connect(n).connect(e.destination);let disconnect=()=>{t.removeEventListener("ended",disconnect),t.disconnect(n),n.disconnect()};t.addEventListener("ended",disconnect)},renderInputsOfAudioParam=async(e,t,n)=>{let i=getAudioParamConnections(e);await Promise.all(Array.from(i.activeInputs).map(async([e,i])=>{let s=getAudioNodeRenderer(e),r=await s.render(e,t);isPartOfACycle(e)||r.connect(n,i)}))},connectAudioParam=(e,t,n)=>renderInputsOfAudioParam(t,e,n),tF=(v=e=>{let t=e.createBufferSource();t.start();try{t.start()}catch{return!0}return!1},y=e=>{let t=e.createBufferSource(),n=e.createBuffer(1,1,44100);t.buffer=n;try{t.start(0,1)}catch{return!1}return!0},A=e=>{let t=e.createBufferSource();t.start();try{t.stop()}catch{return!1}return!0},S=e=>{var t;e.start=(t=e.start,(n=0,i=0,s)=>{let r=e.buffer,o=null===r?i:Math.min(r.duration,i);null!==r&&o>r.duration-.5/e.context.sampleRate?t.call(e,n,0,0):t.call(e,n,o,s)})},x=(e,t)=>{let n=t.createBuffer(1,1,44100);null===e.buffer&&(e.buffer=n),overwriteAccessors(e,"buffer",t=>()=>{let i=t.call(e);return i===n?null:i},t=>i=>t.call(e,null===i?n:i))},(e,t)=>{let n=e.createBufferSource();return assignNativeAudioNodeOptions(n,t),assignNativeAudioNodeAudioParamValue(n,t,"playbackRate"),assignNativeAudioNodeOption(n,t,"buffer"),assignNativeAudioNodeOption(n,t,"loop"),assignNativeAudioNodeOption(n,t,"loopEnd"),assignNativeAudioNodeOption(n,t,"loopStart"),tT(v,()=>v(e))||wrapAudioBufferSourceNodeStartMethodConsecutiveCalls(n),tT(y,()=>y(e))||S(n),tT(A,()=>A(e))||x(n,e),tT(testAudioScheduledSourceNodeStartMethodNegativeParametersSupport,()=>testAudioScheduledSourceNodeStartMethodNegativeParametersSupport(e))||wrapAudioScheduledSourceNodeStartMethodNegativeParameters(n),tT(testAudioScheduledSourceNodeStopMethodConsecutiveCallsSupport,()=>testAudioScheduledSourceNodeStopMethodConsecutiveCallsSupport(e))||wrapAudioScheduledSourceNodeStopMethodConsecutiveCalls(n,e),tT(testAudioScheduledSourceNodeStopMethodNegativeParametersSupport,()=>testAudioScheduledSourceNodeStopMethodNegativeParametersSupport(e))||wrapAudioScheduledSourceNodeStopMethodNegativeParameters(n),addSilentConnection(e,n),n}),tV=(T=e=>{let t=getAudioParamConnections(e);if(null===t.renderer)throw Error("Missing the renderer of the given AudioParam in the audio graph.");return t.renderer},(e,t,n)=>{let i=T(t);return i.replay(n),renderInputsOfAudioParam(t,e,n)}),tq=(C=(e,t)=>{e8.set(e,{activeInputs:new Set,passiveInputs:new WeakMap,renderer:t})},N=e=>({replay(t){for(let n of e)if("exponentialRampToValue"===n.type){let{endTime:e,value:i}=n;t.exponentialRampToValueAtTime(i,e)}else if("linearRampToValue"===n.type){let{endTime:e,value:i}=n;t.linearRampToValueAtTime(i,e)}else if("setTarget"===n.type){let{startTime:e,target:i,timeConstant:s}=n;t.setTargetAtTime(i,e,s)}else if("setValue"===n.type){let{startTime:e,value:i}=n;t.setValueAtTime(i,e)}else if("setValueCurve"===n.type){let{duration:e,startTime:i,values:s}=n;t.setValueCurveAtTime(s,i,e)}else throw Error("Can't apply an unknown automation.")}}),w=eJ.createCancelAndHoldAutomationEvent,b=eJ.createCancelScheduledValuesAutomationEvent,O=eJ.createExponentialRampToValueAutomationEvent,k=eJ.createLinearRampToValueAutomationEvent,M=eJ.createSetTargetAutomationEvent,E=eJ.createSetValueAutomationEvent,D=eJ.createSetValueCurveAutomationEvent,(e,t,n,i=null,s=null)=>{let r=n.value,o=new eJ.AutomationEventList(r),a=t?N(o):null,l={get defaultValue(){return r},get maxValue(){return null===i?n.maxValue:i},get minValue(){return null===s?n.minValue:s},get value(){return n.value},set value(value){n.value=value,l.setValueAtTime(value,e.context.currentTime)},cancelAndHoldAtTime(t){if("function"==typeof n.cancelAndHoldAtTime)null===a&&o.flush(e.context.currentTime),o.add(w(t)),n.cancelAndHoldAtTime(t);else{let i=Array.from(o).pop();null===a&&o.flush(e.context.currentTime),o.add(w(t));let s=Array.from(o).pop();n.cancelScheduledValues(t),i!==s&&void 0!==s&&("exponentialRampToValue"===s.type?n.exponentialRampToValueAtTime(s.value,s.endTime):"linearRampToValue"===s.type?n.linearRampToValueAtTime(s.value,s.endTime):"setValue"===s.type?n.setValueAtTime(s.value,s.startTime):"setValueCurve"===s.type&&n.setValueCurveAtTime(s.values,s.startTime,s.duration))}return l},cancelScheduledValues:t=>(null===a&&o.flush(e.context.currentTime),o.add(b(t)),n.cancelScheduledValues(t),l),exponentialRampToValueAtTime(t,i){if(0===t||!Number.isFinite(i)||i<0)throw RangeError();let s=e.context.currentTime;return null===a&&o.flush(s),0===Array.from(o).length&&(o.add(E(r,s)),n.setValueAtTime(r,s)),o.add(O(t,i)),n.exponentialRampToValueAtTime(t,i),l},linearRampToValueAtTime(t,i){let s=e.context.currentTime;return null===a&&o.flush(s),0===Array.from(o).length&&(o.add(E(r,s)),n.setValueAtTime(r,s)),o.add(k(t,i)),n.linearRampToValueAtTime(t,i),l},setTargetAtTime:(t,i,s)=>(null===a&&o.flush(e.context.currentTime),o.add(M(t,i,s)),n.setTargetAtTime(t,i,s),l),setValueAtTime:(t,i)=>(null===a&&o.flush(e.context.currentTime),o.add(E(t,i)),n.setValueAtTime(t,i),l),setValueCurveAtTime(t,i,s){let r=t instanceof Float32Array?t:new Float32Array(t);if(null!==tO&&"webkitAudioContext"===tO.name){let t=i+s,u=e.context.sampleRate,c=Math.ceil(i*u),h=Math.floor(t*u),d=h-c,p=new Float32Array(d);for(let e=0;e<d;e+=1){let t=(r.length-1)/s*((c+e)/u-i),n=Math.floor(t),o=Math.ceil(t);p[e]=n===o?r[n]:(1-(t-n))*r[n]+(1-(o-t))*r[o]}null===a&&o.flush(e.context.currentTime),o.add(D(p,i,s)),n.setValueCurveAtTime(p,i,s);let f=h/u;f<t&&setValueAtTimeUntilPossible(l,p[p.length-1],f),setValueAtTimeUntilPossible(l,r[r.length-1],t)}else null===a&&o.flush(e.context.currentTime),o.add(D(r,i,s)),n.setValueCurveAtTime(r,i,s);return l}};return e3.set(l,n),tw.set(l,e),C(l,a),l}),tB=(I=tM,P=()=>{let e=new WeakMap,t=null,n=null,createAudioBufferSourceNode=async(i,s)=>{let r=getNativeAudioNode(i),o=isOwnedByContext(r,s);if(!o){let e={buffer:r.buffer,channelCount:r.channelCount,channelCountMode:r.channelCountMode,channelInterpretation:r.channelInterpretation,loop:r.loop,loopEnd:r.loopEnd,loopStart:r.loopStart,playbackRate:r.playbackRate.value};r=tF(s,e),null!==t&&r.start(...t),null!==n&&r.stop(n)}return e.set(s,r),o?await connectAudioParam(s,i.playbackRate,r.playbackRate):await tV(s,i.playbackRate,r.playbackRate),await renderInputsOfAudioNode(i,s,r),r};return{set start(value){t=value},set stop(value){n=value},render(t,n){let i=e.get(n);return void 0!==i?Promise.resolve(i):createAudioBufferSourceNode(t,n)}}},class extends I{constructor(e,t){let n=getNativeContext(e),i={...ts,...t},s=tF(n,i),r=isNativeOfflineAudioContext(n),o=r?P():null;super(e,!1,s,o),this._audioBufferSourceNodeRenderer=o,this._isBufferNullified=!1,this._isBufferSet=null!==i.buffer,this._nativeAudioBufferSourceNode=s,this._onended=null,this._playbackRate=tq(this,r,s.playbackRate,34028234663852886e22,-34028234663852886e22)}get buffer(){return this._isBufferNullified?null:this._nativeAudioBufferSourceNode.buffer}set buffer(e){if(this._nativeAudioBufferSourceNode.buffer=e,null!==e){if(this._isBufferSet)throw createInvalidStateError();this._isBufferSet=!0}}get loop(){return this._nativeAudioBufferSourceNode.loop}set loop(e){this._nativeAudioBufferSourceNode.loop=e}get loopEnd(){return this._nativeAudioBufferSourceNode.loopEnd}set loopEnd(e){this._nativeAudioBufferSourceNode.loopEnd=e}get loopStart(){return this._nativeAudioBufferSourceNode.loopStart}set loopStart(e){this._nativeAudioBufferSourceNode.loopStart=e}get onended(){return this._onended}set onended(e){let t="function"==typeof e?wrapEventListener(this,e):null;this._nativeAudioBufferSourceNode.onended=t;let n=this._nativeAudioBufferSourceNode.onended;this._onended=null!==n&&n===t?e:n}get playbackRate(){return this._playbackRate}start(e=0,t=0,n){if(this._nativeAudioBufferSourceNode.start(e,t,n),null!==this._audioBufferSourceNodeRenderer&&(this._audioBufferSourceNodeRenderer.start=void 0===n?[e,t]:[e,t,n]),"closed"!==this.context.state){setInternalStateToActive(this);let resetInternalStateToPassive=()=>{this._nativeAudioBufferSourceNode.removeEventListener("ended",resetInternalStateToPassive),isActiveAudioNode(this)&&setInternalStateToPassive(this)};this._nativeAudioBufferSourceNode.addEventListener("ended",resetInternalStateToPassive)}}stop(e=0){this._nativeAudioBufferSourceNode.stop(e),null!==this._audioBufferSourceNodeRenderer&&(this._audioBufferSourceNodeRenderer.stop=e)}}),tW=(R=tM,F=e=>{let t=new WeakMap,createAudioDestinationNode=async(n,i)=>{let s=i.destination;return t.set(i,s),await e(n,i,s),s};return{render(e,n){let i=t.get(n);return void 0!==i?Promise.resolve(i):createAudioDestinationNode(e,n)}}},V=(e,t,n)=>{let i=e.destination;if(i.channelCount!==t)try{i.channelCount=t}catch{}n&&"explicit"!==i.channelCountMode&&(i.channelCountMode="explicit"),0===i.maxChannelCount&&Object.defineProperty(i,"maxChannelCount",{value:t});let s=createNativeGainNode(e,{channelCount:t,channelCountMode:i.channelCountMode,channelInterpretation:i.channelInterpretation,gain:1});return overwriteAccessors(s,"channelCount",e=>()=>e.call(s),e=>t=>{e.call(s,t);try{i.channelCount=t}catch(e){if(t>i.maxChannelCount)throw e}}),overwriteAccessors(s,"channelCountMode",e=>()=>e.call(s),e=>t=>{e.call(s,t),i.channelCountMode=t}),overwriteAccessors(s,"channelInterpretation",e=>()=>e.call(s),e=>t=>{e.call(s,t),i.channelInterpretation=t}),Object.defineProperty(s,"maxChannelCount",{get:()=>i.maxChannelCount}),s.connect(i),s},class extends R{constructor(e,t){let n=getNativeContext(e),i=isNativeOfflineAudioContext(n),s=V(n,t,i),r=i?F(renderInputsOfAudioNode):null;super(e,!1,s,r),this._isNodeOfNativeOfflineAudioContext=i,this._nativeAudioDestinationNode=s}get channelCount(){return this._nativeAudioDestinationNode.channelCount}set channelCount(e){if(this._isNodeOfNativeOfflineAudioContext)throw createInvalidStateError();if(e>this._nativeAudioDestinationNode.maxChannelCount)throw createIndexSizeError();this._nativeAudioDestinationNode.channelCount=e}get channelCountMode(){return this._nativeAudioDestinationNode.channelCountMode}set channelCountMode(e){if(this._isNodeOfNativeOfflineAudioContext)throw createInvalidStateError();this._nativeAudioDestinationNode.channelCountMode=e}get maxChannelCount(){return this._nativeAudioDestinationNode.maxChannelCount}}),setAudioNodeTailTime=(e,t)=>tx.set(e,t),tL=(q=tM,B=()=>{let e=new WeakMap,createBiquadFilterNode=async(t,n)=>{let i=getNativeAudioNode(t),s=isOwnedByContext(i,n);if(!s){let e={Q:i.Q.value,channelCount:i.channelCount,channelCountMode:i.channelCountMode,channelInterpretation:i.channelInterpretation,detune:i.detune.value,frequency:i.frequency.value,gain:i.gain.value,type:i.type};i=createNativeBiquadFilterNode(n,e)}return e.set(n,i),s?(await connectAudioParam(n,t.Q,i.Q),await connectAudioParam(n,t.detune,i.detune),await connectAudioParam(n,t.frequency,i.frequency),await connectAudioParam(n,t.gain,i.gain)):(await tV(n,t.Q,i.Q),await tV(n,t.detune,i.detune),await tV(n,t.frequency,i.frequency),await tV(n,t.gain,i.gain)),await renderInputsOfAudioNode(t,n,i),i};return{render(t,n){let i=e.get(n);return void 0!==i?Promise.resolve(i):createBiquadFilterNode(t,n)}}},class extends q{constructor(e,t){let n=getNativeContext(e),i={...to,...t},s=createNativeBiquadFilterNode(n,i),r=isNativeOfflineAudioContext(n),o=r?B():null;super(e,!1,s,o),this._Q=tq(this,r,s.Q,34028234663852886e22,-34028234663852886e22),this._detune=tq(this,r,s.detune,1200*Math.log2(34028234663852886e22),-1200*Math.log2(34028234663852886e22)),this._frequency=tq(this,r,s.frequency,e.sampleRate/2,0),this._gain=tq(this,r,s.gain,40*Math.log10(34028234663852886e22),-34028234663852886e22),this._nativeBiquadFilterNode=s,setAudioNodeTailTime(this,1)}get detune(){return this._detune}get frequency(){return this._frequency}get gain(){return this._gain}get Q(){return this._Q}get type(){return this._nativeBiquadFilterNode.type}set type(e){this._nativeBiquadFilterNode.type=e}getFrequencyResponse(e,t,n){try{this._nativeBiquadFilterNode.getFrequencyResponse(e,t,n)}catch(e){if(11===e.code)throw createInvalidAccessError();throw e}if(e.length!==t.length||t.length!==n.length)throw createInvalidAccessError()}}),monitorConnections=(e,t,n)=>{var i,s;let r=new Set;return e.connect=(i=e.connect,(n,s=0,o=0)=>{let a=0===r.size;if(module_isNativeAudioNode(n))return i.call(e,n,s,o),insertElementInSet(r,[n,s,o],e=>e[0]===n&&e[1]===s&&e[2]===o,!0),a&&t(),n;i.call(e,n,s),insertElementInSet(r,[n,s],e=>e[0]===n&&e[1]===s,!0),a&&t()}),e.disconnect=(s=e.disconnect,(t,i,o)=>{let a=r.size>0;if(void 0===t)s.apply(e),r.clear();else if("number"==typeof t)for(let n of(s.call(e,t),r))n[1]===t&&r.delete(n);else for(let n of(module_isNativeAudioNode(t)?s.call(e,t,i,o):s.call(e,t,i),r))n[0]===t&&(void 0===i||n[1]===i)&&(void 0===o||n[2]===o)&&r.delete(n);let l=0===r.size;a&&l&&n()}),e},tG=(W=(e,t)=>{t.channelCount=1,t.channelCountMode="explicit",Object.defineProperty(t,"channelCount",{get:()=>1,set:()=>{throw createInvalidStateError()}}),Object.defineProperty(t,"channelCountMode",{get:()=>"explicit",set:()=>{throw createInvalidStateError()}});let n=e.createBufferSource();monitorConnections(t,()=>{let e=t.numberOfInputs;for(let i=0;i<e;i+=1)n.connect(t,0,i)},()=>n.disconnect(t))},(e,t)=>{let n=e.createChannelMerger(t.numberOfInputs);return null!==tO&&"webkitAudioContext"===tO.name&&W(e,n),assignNativeAudioNodeOptions(n,t),n}),tj=(L=tM,G=()=>{let e=new WeakMap,createAudioNode=async(t,n)=>{let i=getNativeAudioNode(t),s=isOwnedByContext(i,n);if(!s){let e={channelCount:i.channelCount,channelCountMode:i.channelCountMode,channelInterpretation:i.channelInterpretation,numberOfInputs:i.numberOfInputs};i=tG(n,e)}return e.set(n,i),await renderInputsOfAudioNode(t,n,i),i};return{render(t,n){let i=e.get(n);return void 0!==i?Promise.resolve(i):createAudioNode(t,n)}}},class extends L{constructor(e,t){let n=getNativeContext(e),i={...ta,...t},s=tG(n,i),r=isNativeOfflineAudioContext(n)?G():null;super(e,!1,s,r)}}),tY=(j=tM,Y=()=>{let e=new WeakMap,createAudioNode=async(t,n)=>{let i=getNativeAudioNode(t),s=isOwnedByContext(i,n);if(!s){let e={channelCount:i.channelCount,channelCountMode:i.channelCountMode,channelInterpretation:i.channelInterpretation,numberOfOutputs:i.numberOfOutputs};i=createNativeChannelSplitterNode(n,e)}return e.set(n,i),await renderInputsOfAudioNode(t,n,i),i};return{render(t,n){let i=e.get(n);return void 0!==i?Promise.resolve(i):createAudioNode(t,n)}}},z=e=>({...e,channelCount:e.numberOfOutputs}),class extends j{constructor(e,t){let n=getNativeContext(e),i=z({...tl,...t}),s=createNativeChannelSplitterNode(n,i),r=isNativeOfflineAudioContext(n)?Y():null;super(e,!1,s,r)}}),tz=(U=(e,{offset:t,...n})=>{let i=e.createBuffer(1,2,44100),s=tF(e,{buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1}),r=createNativeGainNode(e,{...n,gain:t}),o=i.getChannelData(0);return o[0]=1,o[1]=1,s.buffer=i,s.loop=!0,addSilentConnection(e,s),monitorConnections(interceptConnections({get bufferSize(){return},get channelCount(){return r.channelCount},set channelCount(value){r.channelCount=value},get channelCountMode(){return r.channelCountMode},set channelCountMode(value){r.channelCountMode=value},get channelInterpretation(){return r.channelInterpretation},set channelInterpretation(value){r.channelInterpretation=value},get context(){return r.context},get inputs(){return[]},get numberOfInputs(){return s.numberOfInputs},get numberOfOutputs(){return r.numberOfOutputs},get offset(){return r.gain},get onended(){return s.onended},set onended(value){s.onended=value},addEventListener:(...e)=>s.addEventListener(e[0],e[1],e[2]),dispatchEvent:(...e)=>s.dispatchEvent(e[0]),removeEventListener:(...e)=>s.removeEventListener(e[0],e[1],e[2]),start(e=0){s.start.call(s,e)},stop(e=0){s.stop.call(s,e)}},r),()=>s.connect(r),()=>s.disconnect(r))},(e,t)=>{if(void 0===e.createConstantSource)return U(e,t);let n=e.createConstantSource();return assignNativeAudioNodeOptions(n,t),assignNativeAudioNodeAudioParamValue(n,t,"offset"),tT(testAudioScheduledSourceNodeStartMethodNegativeParametersSupport,()=>testAudioScheduledSourceNodeStartMethodNegativeParametersSupport(e))||wrapAudioScheduledSourceNodeStartMethodNegativeParameters(n),tT(testAudioScheduledSourceNodeStopMethodNegativeParametersSupport,()=>testAudioScheduledSourceNodeStopMethodNegativeParametersSupport(e))||wrapAudioScheduledSourceNodeStopMethodNegativeParameters(n),addSilentConnection(e,n),n}),tU=(H=tM,$=()=>{let e=new WeakMap,t=null,n=null,createConstantSourceNode=async(i,s)=>{let r=getNativeAudioNode(i),o=isOwnedByContext(r,s);if(!o){let e={channelCount:r.channelCount,channelCountMode:r.channelCountMode,channelInterpretation:r.channelInterpretation,offset:r.offset.value};r=tz(s,e),null!==t&&r.start(t),null!==n&&r.stop(n)}return e.set(s,r),o?await connectAudioParam(s,i.offset,r.offset):await tV(s,i.offset,r.offset),await renderInputsOfAudioNode(i,s,r),r};return{set start(value){t=value},set stop(value){n=value},render(t,n){let i=e.get(n);return void 0!==i?Promise.resolve(i):createConstantSourceNode(t,n)}}},class extends H{constructor(e,t){let n=getNativeContext(e),i={...tu,...t},s=tz(n,i),r=isNativeOfflineAudioContext(n),o=r?$():null;super(e,!1,s,o),this._constantSourceNodeRenderer=o,this._nativeConstantSourceNode=s,this._offset=tq(this,r,s.offset,34028234663852886e22,-34028234663852886e22),this._onended=null}get offset(){return this._offset}get onended(){return this._onended}set onended(e){let t="function"==typeof e?wrapEventListener(this,e):null;this._nativeConstantSourceNode.onended=t;let n=this._nativeConstantSourceNode.onended;this._onended=null!==n&&n===t?e:n}start(e=0){if(this._nativeConstantSourceNode.start(e),null!==this._constantSourceNodeRenderer&&(this._constantSourceNodeRenderer.start=e),"closed"!==this.context.state){setInternalStateToActive(this);let resetInternalStateToPassive=()=>{this._nativeConstantSourceNode.removeEventListener("ended",resetInternalStateToPassive),isActiveAudioNode(this)&&setInternalStateToPassive(this)};this._nativeConstantSourceNode.addEventListener("ended",resetInternalStateToPassive)}}stop(e=0){this._nativeConstantSourceNode.stop(e),null!==this._constantSourceNodeRenderer&&(this._constantSourceNodeRenderer.stop=e)}}),createNativeConvolverNode=(e,t)=>{let n=e.createConvolver();if(assignNativeAudioNodeOptions(n,t),t.disableNormalization===n.normalize&&(n.normalize=!t.disableNormalization),assignNativeAudioNodeOption(n,t,"buffer"),t.channelCount>2||(overwriteAccessors(n,"channelCount",e=>()=>e.call(n),e=>t=>{if(t>2)throw createNotSupportedError();return e.call(n,t)}),"max"===t.channelCountMode))throw createNotSupportedError();return overwriteAccessors(n,"channelCountMode",e=>()=>e.call(n),e=>t=>{if("max"===t)throw createNotSupportedError();return e.call(n,t)}),n},tH=(K=tM,Z=()=>{let e=new WeakMap,createConvolverNode=async(t,n)=>{let i=getNativeAudioNode(t),s=isOwnedByContext(i,n);if(!s){let e={buffer:i.buffer,channelCount:i.channelCount,channelCountMode:i.channelCountMode,channelInterpretation:i.channelInterpretation,disableNormalization:!i.normalize};i=createNativeConvolverNode(n,e)}return e.set(n,i),isNativeAudioNodeFaker(i)?await renderInputsOfAudioNode(t,n,i.inputs[0]):await renderInputsOfAudioNode(t,n,i),i};return{render(t,n){let i=e.get(n);return void 0!==i?Promise.resolve(i):createConvolverNode(t,n)}}},class extends K{constructor(e,t){let n=getNativeContext(e),i={...tc,...t},s=createNativeConvolverNode(n,i),r=isNativeOfflineAudioContext(n),o=r?Z():null;super(e,!1,s,o),this._isBufferNullified=!1,this._nativeConvolverNode=s,null!==i.buffer&&setAudioNodeTailTime(this,i.buffer.duration)}get buffer(){return this._isBufferNullified?null:this._nativeConvolverNode.buffer}set buffer(e){if(this._nativeConvolverNode.buffer=e,null===e&&null!==this._nativeConvolverNode.buffer){let e=this._nativeConvolverNode.context;this._nativeConvolverNode.buffer=e.createBuffer(1,1,e.sampleRate),this._isBufferNullified=!0,setAudioNodeTailTime(this,0)}else this._isBufferNullified=!1,setAudioNodeTailTime(this,null===this._nativeConvolverNode.buffer?0:this._nativeConvolverNode.buffer.duration)}get normalize(){return this._nativeConvolverNode.normalize}set normalize(e){this._nativeConvolverNode.normalize=e}}),t$=(X=tM,Q=e=>{let t=new WeakMap,createDelayNode=async(n,i)=>{let s=getNativeAudioNode(n),r=isOwnedByContext(s,i);if(!r){let t={channelCount:s.channelCount,channelCountMode:s.channelCountMode,channelInterpretation:s.channelInterpretation,delayTime:s.delayTime.value,maxDelayTime:e};s=createNativeDelayNode(i,t)}return t.set(i,s),r?await connectAudioParam(i,n.delayTime,s.delayTime):await tV(i,n.delayTime,s.delayTime),await renderInputsOfAudioNode(n,i,s),s};return{render(e,n){let i=t.get(n);return void 0!==i?Promise.resolve(i):createDelayNode(e,n)}}},class extends X{constructor(e,t){let n=getNativeContext(e),i={...th,...t},s=createNativeDelayNode(n,i),r=isNativeOfflineAudioContext(n),o=r?Q(i.maxDelayTime):null;super(e,!1,s,o),this._delayTime=tq(this,r,s.delayTime),setAudioNodeTailTime(this,i.maxDelayTime)}get delayTime(){return this._delayTime}}),createNativeDynamicsCompressorNode=(e,t)=>{let n=e.createDynamicsCompressor();if(assignNativeAudioNodeOptions(n,t),t.channelCount>2||"max"===t.channelCountMode)throw createNotSupportedError();return assignNativeAudioNodeAudioParamValue(n,t,"attack"),assignNativeAudioNodeAudioParamValue(n,t,"knee"),assignNativeAudioNodeAudioParamValue(n,t,"ratio"),assignNativeAudioNodeAudioParamValue(n,t,"release"),assignNativeAudioNodeAudioParamValue(n,t,"threshold"),n},tK=(J=tM,ee=()=>{let e=new WeakMap,createDynamicsCompressorNode=async(t,n)=>{let i=getNativeAudioNode(t),s=isOwnedByContext(i,n);if(!s){let e={attack:i.attack.value,channelCount:i.channelCount,channelCountMode:i.channelCountMode,channelInterpretation:i.channelInterpretation,knee:i.knee.value,ratio:i.ratio.value,release:i.release.value,threshold:i.threshold.value};i=createNativeDynamicsCompressorNode(n,e)}return e.set(n,i),s?(await connectAudioParam(n,t.attack,i.attack),await connectAudioParam(n,t.knee,i.knee),await connectAudioParam(n,t.ratio,i.ratio),await connectAudioParam(n,t.release,i.release),await connectAudioParam(n,t.threshold,i.threshold)):(await tV(n,t.attack,i.attack),await tV(n,t.knee,i.knee),await tV(n,t.ratio,i.ratio),await tV(n,t.release,i.release),await tV(n,t.threshold,i.threshold)),await renderInputsOfAudioNode(t,n,i),i};return{render(t,n){let i=e.get(n);return void 0!==i?Promise.resolve(i):createDynamicsCompressorNode(t,n)}}},class extends J{constructor(e,t){let n=getNativeContext(e),i={...td,...t},s=createNativeDynamicsCompressorNode(n,i),r=isNativeOfflineAudioContext(n),o=r?ee():null;super(e,!1,s,o),this._attack=tq(this,r,s.attack),this._knee=tq(this,r,s.knee),this._nativeDynamicsCompressorNode=s,this._ratio=tq(this,r,s.ratio),this._release=tq(this,r,s.release),this._threshold=tq(this,r,s.threshold),setAudioNodeTailTime(this,.006)}get attack(){return this._attack}get channelCount(){return this._nativeDynamicsCompressorNode.channelCount}set channelCount(e){let t=this._nativeDynamicsCompressorNode.channelCount;if(this._nativeDynamicsCompressorNode.channelCount=e,e>2)throw this._nativeDynamicsCompressorNode.channelCount=t,createNotSupportedError()}get channelCountMode(){return this._nativeDynamicsCompressorNode.channelCountMode}set channelCountMode(e){let t=this._nativeDynamicsCompressorNode.channelCountMode;if(this._nativeDynamicsCompressorNode.channelCountMode=e,"max"===e)throw this._nativeDynamicsCompressorNode.channelCountMode=t,createNotSupportedError()}get knee(){return this._knee}get ratio(){return this._ratio}get reduction(){return"number"==typeof this._nativeDynamicsCompressorNode.reduction.value?this._nativeDynamicsCompressorNode.reduction.value:this._nativeDynamicsCompressorNode.reduction}get release(){return this._release}get threshold(){return this._threshold}}),tZ=(et=tM,en=()=>{let e=new WeakMap,createGainNode=async(t,n)=>{let i=getNativeAudioNode(t),s=isOwnedByContext(i,n);if(!s){let e={channelCount:i.channelCount,channelCountMode:i.channelCountMode,channelInterpretation:i.channelInterpretation,gain:i.gain.value};i=createNativeGainNode(n,e)}return e.set(n,i),s?await connectAudioParam(n,t.gain,i.gain):await tV(n,t.gain,i.gain),await renderInputsOfAudioNode(t,n,i),i};return{render(t,n){let i=e.get(n);return void 0!==i?Promise.resolve(i):createGainNode(t,n)}}},class extends et{constructor(e,t){let n=getNativeContext(e),i={...tp,...t},s=createNativeGainNode(n,i),r=isNativeOfflineAudioContext(n),o=r?en():null;super(e,!1,s,o),this._gain=tq(this,r,s.gain,34028234663852886e22,-34028234663852886e22)}get gain(){return this._gain}}),tX=(ei=()=>{if(null===tN)return Promise.resolve(!1);let e=new tN(1,1,44100),t=createNativeGainNode(e,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0});return new Promise(n=>{e.oncomplete=()=>{t.disconnect(),n(0!==e.currentTime)},e.startRendering()})},e=>tT(testPromiseSupport,()=>testPromiseSupport(e))?Promise.resolve(tT(ei,ei)).then(t=>{if(!t){let t=createNativeScriptProcessorNode(e,512,0,1);e.oncomplete=()=>{t.onaudioprocess=null,t.disconnect()},t.onaudioprocess=()=>e.currentTime,t.connect(e.destination)}return e.startRendering()}):new Promise(t=>{let n=createNativeGainNode(e,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0});e.oncomplete=e=>{n.disconnect(),t(e.renderedBuffer)},n.connect(e.destination),e.startRendering()})),tQ=(es=(e,t,{channelCount:n,channelCountMode:i,channelInterpretation:s,feedback:r,feedforward:o})=>{let a=computeBufferSize(t,e.sampleRate),l=r instanceof Float64Array?r:new Float64Array(r),u=o instanceof Float64Array?o:new Float64Array(o),c=l.length,h=u.length,d=Math.min(c,h);if(0===c||c>20)throw createNotSupportedError();if(0===l[0])throw createInvalidStateError();if(0===h||h>20)throw createNotSupportedError();if(0===u[0])throw createInvalidStateError();if(1!==l[0]){for(let e=0;e<h;e+=1)u[e]/=l[0];for(let e=1;e<c;e+=1)l[e]/=l[0]}let p=createNativeScriptProcessorNode(e,a,n,n);p.channelCount=n,p.channelCountMode=i,p.channelInterpretation=s;let f=[],m=[],g=[];for(let e=0;e<n;e+=1){f.push(0);let e=new Float32Array(32),t=new Float32Array(32);e.fill(0),t.fill(0),m.push(e),g.push(t)}p.onaudioprocess=e=>{let t=e.inputBuffer,n=e.outputBuffer,i=t.numberOfChannels;for(let e=0;e<i;e+=1){let i=t.getChannelData(e),s=n.getChannelData(e);f[e]=filterBuffer(l,c,u,h,d,m[e],g[e],f[e],32,i,s)}};let v=e.sampleRate/2;return interceptConnections({get bufferSize(){return a},get channelCount(){return p.channelCount},set channelCount(value){p.channelCount=value},get channelCountMode(){return p.channelCountMode},set channelCountMode(value){p.channelCountMode=value},get channelInterpretation(){return p.channelInterpretation},set channelInterpretation(value){p.channelInterpretation=value},get context(){return p.context},get inputs(){return[p]},get numberOfInputs(){return p.numberOfInputs},get numberOfOutputs(){return p.numberOfOutputs},addEventListener:(...e)=>p.addEventListener(e[0],e[1],e[2]),dispatchEvent:(...e)=>p.dispatchEvent(e[0]),getFrequencyResponse(e,t,n){if(e.length!==t.length||t.length!==n.length)throw createInvalidAccessError();let i=e.length;for(let s=0;s<i;s+=1){let i=-Math.PI*(e[s]/v),r=[Math.cos(i),Math.sin(i)],o=evaluatePolynomial(u,r),a=evaluatePolynomial(l,r),c=function(e,t){let n=t[0]*t[0]+t[1]*t[1];return[(e[0]*t[0]+e[1]*t[1])/n,(e[1]*t[0]-e[0]*t[1])/n]}(o,a);t[s]=Math.sqrt(c[0]*c[0]+c[1]*c[1]),n[s]=Math.atan2(c[1],c[0])}},removeEventListener:(...e)=>p.removeEventListener(e[0],e[1],e[2])},p)},(e,t,n)=>{if(void 0===e.createIIRFilter)return es(e,t,n);let i=e.createIIRFilter(n.feedforward,n.feedback);return assignNativeAudioNodeOptions(i,n),i}),tJ=(er=tM,eo=(e,t)=>{let n=new WeakMap,i=null,createAudioNode=async(s,r)=>{let o=null,a=getNativeAudioNode(s),l=isOwnedByContext(a,r);if(void 0===r.createIIRFilter?o=tF(r,{buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1}):l||(a=r.createIIRFilter(t,e)),n.set(r,null===o?a:o),null!==o){if(null===i){if(null===tN)throw Error("Missing the native OfflineAudioContext constructor.");let n=new tN(s.context.destination.channelCount,s.context.length,r.sampleRate);i=(async()=>{await renderInputsOfAudioNode(s,n,n.destination);let i=await tX(n);return filterFullBuffer(i,r,e,t)})()}let n=await i;return o.buffer=n,o.start(0),o}return await renderInputsOfAudioNode(s,r,a),a};return{render(e,t){let i=n.get(t);return void 0!==i?Promise.resolve(i):createAudioNode(e,t)}}},class extends er{constructor(e,t){let n=getNativeContext(e),i=isNativeOfflineAudioContext(n),s={...tf,...t},r=tQ(n,i?null:e.baseLatency,s),o=i?eo(s.feedback,s.feedforward):null;super(e,!1,r,o),wrapIIRFilterNodeGetFrequencyResponseMethod(r),this._nativeIIRFilterNode=r,setAudioNodeTailTime(this,1)}getFrequencyResponse(e,t,n){return this._nativeIIRFilterNode.getFrequencyResponse(e,t,n)}}),t0=new WeakMap,t1=(ea=(e,t)=>{let n=t.listener,{forwardX:i,forwardY:s,forwardZ:r,positionX:o,positionY:a,positionZ:l,upX:u,upY:c,upZ:h}=void 0===n.forwardX?(()=>{let i=new Float32Array(1),s=tG(t,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:9}),r=isNativeOfflineAudioContext(t),o=!1,a=[0,0,-1,0,1,0],l=[0,0,0],createScriptProcessorNode=()=>{if(o)return;o=!0;let e=createNativeScriptProcessorNode(t,256,9,0);e.onaudioprocess=({inputBuffer:e})=>{let t=[getFirstSample(e,i,0),getFirstSample(e,i,1),getFirstSample(e,i,2),getFirstSample(e,i,3),getFirstSample(e,i,4),getFirstSample(e,i,5)];t.some((e,t)=>e!==a[t])&&(n.setOrientation(...t),a=t);let s=[getFirstSample(e,i,6),getFirstSample(e,i,7),getFirstSample(e,i,8)];s.some((e,t)=>e!==l[t])&&(n.setPosition(...s),l=s)},s.connect(e)},createSetOrientation=e=>t=>{t!==a[e]&&(a[e]=t,n.setOrientation(...a))},createSetPosition=e=>t=>{t!==l[e]&&(l[e]=t,n.setPosition(...l))},createFakeAudioParam=(n,i,o)=>{var a,l,u,c,h,d,p;let f=tz(t,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",offset:i});f.connect(s,0,n),f.start(),Object.defineProperty(f.offset,"defaultValue",{get:()=>i});let m=tq({context:e},r,f.offset,34028234663852886e22,-34028234663852886e22);return overwriteAccessors(m,"value",e=>()=>e.call(m),e=>t=>{try{e.call(m,t)}catch(e){if(9!==e.code)throw e}createScriptProcessorNode(),r&&o(t)}),m.cancelAndHoldAtTime=(a=m.cancelAndHoldAtTime,r?()=>{throw createNotSupportedError()}:(...e)=>{let t=a.apply(m,e);return createScriptProcessorNode(),t}),m.cancelScheduledValues=(l=m.cancelScheduledValues,r?()=>{throw createNotSupportedError()}:(...e)=>{let t=l.apply(m,e);return createScriptProcessorNode(),t}),m.exponentialRampToValueAtTime=(u=m.exponentialRampToValueAtTime,r?()=>{throw createNotSupportedError()}:(...e)=>{let t=u.apply(m,e);return createScriptProcessorNode(),t}),m.linearRampToValueAtTime=(c=m.linearRampToValueAtTime,r?()=>{throw createNotSupportedError()}:(...e)=>{let t=c.apply(m,e);return createScriptProcessorNode(),t}),m.setTargetAtTime=(h=m.setTargetAtTime,r?()=>{throw createNotSupportedError()}:(...e)=>{let t=h.apply(m,e);return createScriptProcessorNode(),t}),m.setValueAtTime=(d=m.setValueAtTime,r?()=>{throw createNotSupportedError()}:(...e)=>{let t=d.apply(m,e);return createScriptProcessorNode(),t}),m.setValueCurveAtTime=(p=m.setValueCurveAtTime,r?()=>{throw createNotSupportedError()}:(...e)=>{let t=p.apply(m,e);return createScriptProcessorNode(),t}),m};return{forwardX:createFakeAudioParam(0,0,createSetOrientation(0)),forwardY:createFakeAudioParam(1,0,createSetOrientation(1)),forwardZ:createFakeAudioParam(2,-1,createSetOrientation(2)),positionX:createFakeAudioParam(6,0,createSetPosition(0)),positionY:createFakeAudioParam(7,0,createSetPosition(1)),positionZ:createFakeAudioParam(8,0,createSetPosition(2)),upX:createFakeAudioParam(3,0,createSetOrientation(3)),upY:createFakeAudioParam(4,1,createSetOrientation(4)),upZ:createFakeAudioParam(5,0,createSetOrientation(5))}})():n;return{get forwardX(){return i},get forwardY(){return s},get forwardZ(){return r},get positionX(){return o},get positionY(){return a},get positionZ(){return l},get upX(){return u},get upY(){return c},get upZ(){return h}}},el=tb,class extends el{constructor(e,t){super(e),this._nativeContext=e,e6.set(this,e),isNativeOfflineAudioContext(e)&&t0.set(e,new Set),this._destination=new tW(this,t),this._listener=ea(this,e),this._onstatechange=null}get currentTime(){return this._nativeContext.currentTime}get destination(){return this._destination}get listener(){return this._listener}get onstatechange(){return this._onstatechange}set onstatechange(e){let t="function"==typeof e?wrapEventListener(this,e):null;this._nativeContext.onstatechange=t;let n=this._nativeContext.onstatechange;this._onstatechange=null!==n&&n===t?e:n}get sampleRate(){return this._nativeContext.sampleRate}get state(){return this._nativeContext.state}}),createNativeOscillatorNode=(e,t)=>{let n=e.createOscillator();return assignNativeAudioNodeOptions(n,t),assignNativeAudioNodeAudioParamValue(n,t,"detune"),assignNativeAudioNodeAudioParamValue(n,t,"frequency"),void 0!==t.periodicWave?n.setPeriodicWave(t.periodicWave):assignNativeAudioNodeOption(n,t,"type"),tT(testAudioScheduledSourceNodeStartMethodNegativeParametersSupport,()=>testAudioScheduledSourceNodeStartMethodNegativeParametersSupport(e))||wrapAudioScheduledSourceNodeStartMethodNegativeParameters(n),tT(testAudioScheduledSourceNodeStopMethodConsecutiveCallsSupport,()=>testAudioScheduledSourceNodeStopMethodConsecutiveCallsSupport(e))||wrapAudioScheduledSourceNodeStopMethodConsecutiveCalls(n,e),tT(testAudioScheduledSourceNodeStopMethodNegativeParametersSupport,()=>testAudioScheduledSourceNodeStopMethodNegativeParametersSupport(e))||wrapAudioScheduledSourceNodeStopMethodNegativeParameters(n),addSilentConnection(e,n),n},t2=(eu=tM,ec=()=>{let e=new WeakMap,t=null,n=null,i=null,createOscillatorNode=async(s,r)=>{let o=getNativeAudioNode(s),a=isOwnedByContext(o,r);if(!a){let e={channelCount:o.channelCount,channelCountMode:o.channelCountMode,channelInterpretation:o.channelInterpretation,detune:o.detune.value,frequency:o.frequency.value,periodicWave:null===t?void 0:t,type:o.type};o=createNativeOscillatorNode(r,e),null!==n&&o.start(n),null!==i&&o.stop(i)}return e.set(r,o),a?(await connectAudioParam(r,s.detune,o.detune),await connectAudioParam(r,s.frequency,o.frequency)):(await tV(r,s.detune,o.detune),await tV(r,s.frequency,o.frequency)),await renderInputsOfAudioNode(s,r,o),o};return{set periodicWave(value){t=value},set start(value){n=value},set stop(value){i=value},render(t,n){let i=e.get(n);return void 0!==i?Promise.resolve(i):createOscillatorNode(t,n)}}},class extends eu{constructor(e,t){let n=getNativeContext(e),i={...tg,...t},s=createNativeOscillatorNode(n,i),r=isNativeOfflineAudioContext(n),o=r?ec():null,a=e.sampleRate/2;super(e,!1,s,o),this._detune=tq(this,r,s.detune,153600,-153600),this._frequency=tq(this,r,s.frequency,a,-a),this._nativeOscillatorNode=s,this._onended=null,this._oscillatorNodeRenderer=o,null!==this._oscillatorNodeRenderer&&void 0!==i.periodicWave&&(this._oscillatorNodeRenderer.periodicWave=i.periodicWave)}get detune(){return this._detune}get frequency(){return this._frequency}get onended(){return this._onended}set onended(e){let t="function"==typeof e?wrapEventListener(this,e):null;this._nativeOscillatorNode.onended=t;let n=this._nativeOscillatorNode.onended;this._onended=null!==n&&n===t?e:n}get type(){return this._nativeOscillatorNode.type}set type(e){this._nativeOscillatorNode.type=e,null!==this._oscillatorNodeRenderer&&(this._oscillatorNodeRenderer.periodicWave=null)}setPeriodicWave(e){this._nativeOscillatorNode.setPeriodicWave(e),null!==this._oscillatorNodeRenderer&&(this._oscillatorNodeRenderer.periodicWave=e)}start(e=0){if(this._nativeOscillatorNode.start(e),null!==this._oscillatorNodeRenderer&&(this._oscillatorNodeRenderer.start=e),"closed"!==this.context.state){setInternalStateToActive(this);let resetInternalStateToPassive=()=>{this._nativeOscillatorNode.removeEventListener("ended",resetInternalStateToPassive),isActiveAudioNode(this)&&setInternalStateToPassive(this)};this._nativeOscillatorNode.addEventListener("ended",resetInternalStateToPassive)}}stop(e=0){this._nativeOscillatorNode.stop(e),null!==this._oscillatorNodeRenderer&&(this._oscillatorNodeRenderer.stop=e)}}),createConnectedNativeAudioBufferSourceNode=(e,t)=>{let n=tF(e,{buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1}),i=e.createBuffer(1,2,44100);return n.buffer=i,n.loop=!0,n.connect(t),n.start(),()=>{n.stop(),n.disconnect(t)}},t8=(eh=(e,{curve:t,oversample:n,...i})=>{let s=e.createWaveShaper(),r=e.createWaveShaper();assignNativeAudioNodeOptions(s,i),assignNativeAudioNodeOptions(r,i);let o=createNativeGainNode(e,{...i,gain:1}),a=createNativeGainNode(e,{...i,gain:-1}),l=createNativeGainNode(e,{...i,gain:1}),u=createNativeGainNode(e,{...i,gain:-1}),c=null,h=!1,d=null,p={get bufferSize(){return},get channelCount(){return s.channelCount},set channelCount(value){o.channelCount=value,a.channelCount=value,s.channelCount=value,l.channelCount=value,r.channelCount=value,u.channelCount=value},get channelCountMode(){return s.channelCountMode},set channelCountMode(value){o.channelCountMode=value,a.channelCountMode=value,s.channelCountMode=value,l.channelCountMode=value,r.channelCountMode=value,u.channelCountMode=value},get channelInterpretation(){return s.channelInterpretation},set channelInterpretation(value){o.channelInterpretation=value,a.channelInterpretation=value,s.channelInterpretation=value,l.channelInterpretation=value,r.channelInterpretation=value,u.channelInterpretation=value},get context(){return s.context},get curve(){return d},set curve(value){if(null!==value&&value.length<2)throw createInvalidStateError();if(null===value)s.curve=value,r.curve=value;else{let e=value.length,t=new Float32Array(e+2-e%2),n=new Float32Array(e+2-e%2);t[0]=value[0],n[0]=-value[e-1];let i=Math.ceil((e+1)/2),o=(e+1)/2-1;for(let s=1;s<i;s+=1){let r=s/i*o,a=Math.floor(r),l=Math.ceil(r);t[s]=a===l?value[a]:(1-(r-a))*value[a]+(1-(l-r))*value[l],n[s]=a===l?-value[e-1-a]:-((1-(r-a))*value[e-1-a])-(1-(l-r))*value[e-1-l]}t[i]=e%2==1?value[i-1]:(value[i-2]+value[i-1])/2,s.curve=t,r.curve=n}d=value,h&&(isDCCurve(d)&&null===c?c=createConnectedNativeAudioBufferSourceNode(e,o):null!==c&&(c(),c=null))},get inputs(){return[o]},get numberOfInputs(){return s.numberOfInputs},get numberOfOutputs(){return s.numberOfOutputs},get oversample(){return s.oversample},set oversample(value){s.oversample=value,r.oversample=value},addEventListener:(...e)=>o.addEventListener(e[0],e[1],e[2]),dispatchEvent:(...e)=>o.dispatchEvent(e[0]),removeEventListener:(...e)=>o.removeEventListener(e[0],e[1],e[2])};return null!==t&&(p.curve=t instanceof Float32Array?t:new Float32Array(t)),n!==p.oversample&&(p.oversample=n),monitorConnections(interceptConnections(p,l),()=>{o.connect(s).connect(l),o.connect(a).connect(r).connect(u).connect(l),h=!0,isDCCurve(d)&&(c=createConnectedNativeAudioBufferSourceNode(e,o))},()=>{o.disconnect(s),s.disconnect(l),o.disconnect(a),a.disconnect(r),r.disconnect(u),u.disconnect(l),h=!1,null!==c&&(c(),c=null)})},(e,t)=>{let n=e.createWaveShaper();if(null!==tO&&"webkitAudioContext"===tO.name&&void 0===e.createGain().gain.automationRate)return eh(e,t);assignNativeAudioNodeOptions(n,t);let i=null===t.curve||t.curve instanceof Float32Array?t.curve:new Float32Array(t.curve);if(null!==i&&i.length<2)throw createInvalidStateError();assignNativeAudioNodeOption(n,{curve:i},"curve"),assignNativeAudioNodeOption(n,t,"oversample");let s=null,r=!1;return overwriteAccessors(n,"curve",e=>()=>e.call(n),t=>i=>(t.call(n,i),r&&(isDCCurve(i)&&null===s?s=createConnectedNativeAudioBufferSourceNode(e,n):isDCCurve(i)||null===s||(s(),s=null)),i)),monitorConnections(n,()=>{r=!0,isDCCurve(n.curve)&&(s=createConnectedNativeAudioBufferSourceNode(e,n))},()=>{r=!1,null!==s&&(s(),s=null)})}),t3=(ed=(e,{coneInnerAngle:t,coneOuterAngle:n,coneOuterGain:i,distanceModel:s,maxDistance:r,orientationX:o,orientationY:a,orientationZ:l,panningModel:u,positionX:c,positionY:h,positionZ:d,refDistance:p,rolloffFactor:f,...m})=>{let g=e.createPanner();if(m.channelCount>2||"max"===m.channelCountMode)throw createNotSupportedError();assignNativeAudioNodeOptions(g,m);let v={channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete"},y=tG(e,{...v,channelInterpretation:"speakers",numberOfInputs:6}),A=createNativeGainNode(e,{...m,gain:1}),S=createNativeGainNode(e,{...v,gain:1}),x=createNativeGainNode(e,{...v,gain:0}),T=createNativeGainNode(e,{...v,gain:0}),C=createNativeGainNode(e,{...v,gain:0}),N=createNativeGainNode(e,{...v,gain:0}),w=createNativeGainNode(e,{...v,gain:0}),b=createNativeScriptProcessorNode(e,256,6,1),O=t8(e,{...v,curve:new Float32Array([1,1]),oversample:"none"}),k=[o,a,l],M=[c,h,d],E=new Float32Array(1);b.onaudioprocess=({inputBuffer:e})=>{let t=[getFirstSample(e,E,0),getFirstSample(e,E,1),getFirstSample(e,E,2)];t.some((e,t)=>e!==k[t])&&(g.setOrientation(...t),k=t);let n=[getFirstSample(e,E,3),getFirstSample(e,E,4),getFirstSample(e,E,5)];n.some((e,t)=>e!==M[t])&&(g.setPosition(...n),M=n)},Object.defineProperty(x.gain,"defaultValue",{get:()=>0}),Object.defineProperty(T.gain,"defaultValue",{get:()=>0}),Object.defineProperty(C.gain,"defaultValue",{get:()=>0}),Object.defineProperty(N.gain,"defaultValue",{get:()=>0}),Object.defineProperty(w.gain,"defaultValue",{get:()=>0});let D={get bufferSize(){return},get channelCount(){return g.channelCount},set channelCount(value){if(value>2)throw createNotSupportedError();A.channelCount=value,g.channelCount=value},get channelCountMode(){return g.channelCountMode},set channelCountMode(value){if("max"===value)throw createNotSupportedError();A.channelCountMode=value,g.channelCountMode=value},get channelInterpretation(){return g.channelInterpretation},set channelInterpretation(value){A.channelInterpretation=value,g.channelInterpretation=value},get coneInnerAngle(){return g.coneInnerAngle},set coneInnerAngle(value){g.coneInnerAngle=value},get coneOuterAngle(){return g.coneOuterAngle},set coneOuterAngle(value){g.coneOuterAngle=value},get coneOuterGain(){return g.coneOuterGain},set coneOuterGain(value){if(value<0||value>1)throw createInvalidStateError();g.coneOuterGain=value},get context(){return g.context},get distanceModel(){return g.distanceModel},set distanceModel(value){g.distanceModel=value},get inputs(){return[A]},get maxDistance(){return g.maxDistance},set maxDistance(value){if(value<0)throw RangeError();g.maxDistance=value},get numberOfInputs(){return g.numberOfInputs},get numberOfOutputs(){return g.numberOfOutputs},get orientationX(){return S.gain},get orientationY(){return x.gain},get orientationZ(){return T.gain},get panningModel(){return g.panningModel},set panningModel(value){g.panningModel=value},get positionX(){return C.gain},get positionY(){return N.gain},get positionZ(){return w.gain},get refDistance(){return g.refDistance},set refDistance(value){if(value<0)throw RangeError();g.refDistance=value},get rolloffFactor(){return g.rolloffFactor},set rolloffFactor(value){if(value<0)throw RangeError();g.rolloffFactor=value},addEventListener:(...e)=>A.addEventListener(e[0],e[1],e[2]),dispatchEvent:(...e)=>A.dispatchEvent(e[0]),removeEventListener:(...e)=>A.removeEventListener(e[0],e[1],e[2])};return t!==D.coneInnerAngle&&(D.coneInnerAngle=t),n!==D.coneOuterAngle&&(D.coneOuterAngle=n),i!==D.coneOuterGain&&(D.coneOuterGain=i),s!==D.distanceModel&&(D.distanceModel=s),r!==D.maxDistance&&(D.maxDistance=r),o!==D.orientationX.value&&(D.orientationX.value=o),a!==D.orientationY.value&&(D.orientationY.value=a),l!==D.orientationZ.value&&(D.orientationZ.value=l),u!==D.panningModel&&(D.panningModel=u),c!==D.positionX.value&&(D.positionX.value=c),h!==D.positionY.value&&(D.positionY.value=h),d!==D.positionZ.value&&(D.positionZ.value=d),p!==D.refDistance&&(D.refDistance=p),f!==D.rolloffFactor&&(D.rolloffFactor=f),(1!==k[0]||0!==k[1]||0!==k[2])&&g.setOrientation(...k),(0!==M[0]||0!==M[1]||0!==M[2])&&g.setPosition(...M),monitorConnections(interceptConnections(D,g),()=>{A.connect(g),connectNativeAudioNodeToNativeAudioNode(A,O,0,0),O.connect(S).connect(y,0,0),O.connect(x).connect(y,0,1),O.connect(T).connect(y,0,2),O.connect(C).connect(y,0,3),O.connect(N).connect(y,0,4),O.connect(w).connect(y,0,5),y.connect(b).connect(e.destination)},()=>{A.disconnect(g),disconnectNativeAudioNodeFromNativeAudioNode(A,O,0,0),O.disconnect(S),S.disconnect(y),O.disconnect(x),x.disconnect(y),O.disconnect(T),T.disconnect(y),O.disconnect(C),C.disconnect(y),O.disconnect(N),N.disconnect(y),O.disconnect(w),w.disconnect(y),y.disconnect(b),b.disconnect(e.destination)})},(e,t)=>{let n=e.createPanner();return void 0===n.orientationX?ed(e,t):(assignNativeAudioNodeOptions(n,t),assignNativeAudioNodeAudioParamValue(n,t,"orientationX"),assignNativeAudioNodeAudioParamValue(n,t,"orientationY"),assignNativeAudioNodeAudioParamValue(n,t,"orientationZ"),assignNativeAudioNodeAudioParamValue(n,t,"positionX"),assignNativeAudioNodeAudioParamValue(n,t,"positionY"),assignNativeAudioNodeAudioParamValue(n,t,"positionZ"),assignNativeAudioNodeOption(n,t,"coneInnerAngle"),assignNativeAudioNodeOption(n,t,"coneOuterAngle"),assignNativeAudioNodeOption(n,t,"coneOuterGain"),assignNativeAudioNodeOption(n,t,"distanceModel"),assignNativeAudioNodeOption(n,t,"maxDistance"),assignNativeAudioNodeOption(n,t,"panningModel"),assignNativeAudioNodeOption(n,t,"refDistance"),assignNativeAudioNodeOption(n,t,"rolloffFactor"),n)}),t6=(ep=tM,ef=()=>{let e=new WeakMap,t=null,createAudioNode=async(n,i)=>{let s=null,r=getNativeAudioNode(n),o={channelCount:r.channelCount,channelCountMode:r.channelCountMode,channelInterpretation:r.channelInterpretation},a={...o,coneInnerAngle:r.coneInnerAngle,coneOuterAngle:r.coneOuterAngle,coneOuterGain:r.coneOuterGain,distanceModel:r.distanceModel,maxDistance:r.maxDistance,panningModel:r.panningModel,refDistance:r.refDistance,rolloffFactor:r.rolloffFactor},l=isOwnedByContext(r,i);if("bufferSize"in r)s=createNativeGainNode(i,{...o,gain:1});else if(!l){let e={...a,orientationX:r.orientationX.value,orientationY:r.orientationY.value,orientationZ:r.orientationZ.value,positionX:r.positionX.value,positionY:r.positionY.value,positionZ:r.positionZ.value};r=t3(i,e)}if(e.set(i,null===s?r:s),null!==s){if(null===t){if(null===tN)throw Error("Missing the native OfflineAudioContext constructor.");let e=new tN(6,n.context.length,i.sampleRate),s=tG(e,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:6});s.connect(e.destination),t=(async()=>{let t=await Promise.all([n.orientationX,n.orientationY,n.orientationZ,n.positionX,n.positionY,n.positionZ].map(async(t,n)=>{let i=tz(e,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",offset:0===n?1:0});return await tV(e,t,i.offset),i}));for(let e=0;e<6;e+=1)t[e].connect(s,0,e),t[e].start(0);return tX(e)})()}let e=await t,r=createNativeGainNode(i,{...o,gain:1});await renderInputsOfAudioNode(n,i,r);let l=[];for(let t=0;t<e.numberOfChannels;t+=1)l.push(e.getChannelData(t));let u=[l[0][0],l[1][0],l[2][0]],c=[l[3][0],l[4][0],l[5][0]],h=createNativeGainNode(i,{...o,gain:1}),d=t3(i,{...a,orientationX:u[0],orientationY:u[1],orientationZ:u[2],positionX:c[0],positionY:c[1],positionZ:c[2]});r.connect(h).connect(d.inputs[0]),d.connect(s);for(let t=128;t<e.length;t+=128){let e=[l[0][t],l[1][t],l[2][t]],n=[l[3][t],l[4][t],l[5][t]];if(e.some((e,t)=>e!==u[t])||n.some((e,t)=>e!==c[t])){u=e,c=n;let l=t/i.sampleRate;h.gain.setValueAtTime(0,l),h=createNativeGainNode(i,{...o,gain:0}),d=t3(i,{...a,orientationX:u[0],orientationY:u[1],orientationZ:u[2],positionX:c[0],positionY:c[1],positionZ:c[2]}),h.gain.setValueAtTime(1,l),r.connect(h).connect(d.inputs[0]),d.connect(s)}}return s}return l?(await connectAudioParam(i,n.orientationX,r.orientationX),await connectAudioParam(i,n.orientationY,r.orientationY),await connectAudioParam(i,n.orientationZ,r.orientationZ),await connectAudioParam(i,n.positionX,r.positionX),await connectAudioParam(i,n.positionY,r.positionY),await connectAudioParam(i,n.positionZ,r.positionZ)):(await tV(i,n.orientationX,r.orientationX),await tV(i,n.orientationY,r.orientationY),await tV(i,n.orientationZ,r.orientationZ),await tV(i,n.positionX,r.positionX),await tV(i,n.positionY,r.positionY),await tV(i,n.positionZ,r.positionZ)),isNativeAudioNodeFaker(r)?await renderInputsOfAudioNode(n,i,r.inputs[0]):await renderInputsOfAudioNode(n,i,r),r};return{render(t,n){let i=e.get(n);return void 0!==i?Promise.resolve(i):createAudioNode(t,n)}}},class extends ep{constructor(e,t){let n=getNativeContext(e),i={...tv,...t},s=t3(n,i),r=isNativeOfflineAudioContext(n),o=r?ef():null;super(e,!1,s,o),this._nativePannerNode=s,this._orientationX=tq(this,r,s.orientationX,34028234663852886e22,-34028234663852886e22),this._orientationY=tq(this,r,s.orientationY,34028234663852886e22,-34028234663852886e22),this._orientationZ=tq(this,r,s.orientationZ,34028234663852886e22,-34028234663852886e22),this._positionX=tq(this,r,s.positionX,34028234663852886e22,-34028234663852886e22),this._positionY=tq(this,r,s.positionY,34028234663852886e22,-34028234663852886e22),this._positionZ=tq(this,r,s.positionZ,34028234663852886e22,-34028234663852886e22),setAudioNodeTailTime(this,1)}get coneInnerAngle(){return this._nativePannerNode.coneInnerAngle}set coneInnerAngle(e){this._nativePannerNode.coneInnerAngle=e}get coneOuterAngle(){return this._nativePannerNode.coneOuterAngle}set coneOuterAngle(e){this._nativePannerNode.coneOuterAngle=e}get coneOuterGain(){return this._nativePannerNode.coneOuterGain}set coneOuterGain(e){this._nativePannerNode.coneOuterGain=e}get distanceModel(){return this._nativePannerNode.distanceModel}set distanceModel(e){this._nativePannerNode.distanceModel=e}get maxDistance(){return this._nativePannerNode.maxDistance}set maxDistance(e){this._nativePannerNode.maxDistance=e}get orientationX(){return this._orientationX}get orientationY(){return this._orientationY}get orientationZ(){return this._orientationZ}get panningModel(){return this._nativePannerNode.panningModel}set panningModel(e){this._nativePannerNode.panningModel=e}get positionX(){return this._positionX}get positionY(){return this._positionY}get positionZ(){return this._positionZ}get refDistance(){return this._nativePannerNode.refDistance}set refDistance(e){this._nativePannerNode.refDistance=e}get rolloffFactor(){return this._nativePannerNode.rolloffFactor}set rolloffFactor(e){this._nativePannerNode.rolloffFactor=e}}),t4=(em=(e,{disableNormalization:t,imag:n,real:i})=>{let s=n instanceof Float32Array?n:new Float32Array(n),r=i instanceof Float32Array?i:new Float32Array(i),o=e.createPeriodicWave(r,s,{disableNormalization:t});if(Array.from(n).length<2)throw createIndexSizeError();return o},e_=new WeakSet,eg=e=>{let{imag:t,real:n}=e;return void 0===t?void 0===n?{...e,imag:[0,0],real:[0,0]}:{...e,imag:Array.from(n,()=>0),real:n}:void 0===n?{...e,imag:t,real:Array.from(t,()=>0)}:{...e,imag:t,real:n}},class PeriodicWave{constructor(e,t){let n=getNativeContext(e),i=eg({...ty,...t}),s=em(n,i);return e_.add(s),s}static[Symbol.hasInstance](e){return null!==e&&"object"==typeof e&&Object.getPrototypeOf(e)===PeriodicWave.prototype||e_.has(e)}}),t9=((e,t,n,i,s,r)=>{let o=new Float32Array([1,1]),a=Math.PI/2,l={channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete"},u={...l,oversample:"none"},buildInternalGraphForMono=(e,t,s,r)=>{let c=new Float32Array(16385),h=new Float32Array(16385);for(let e=0;e<16385;e+=1){let t=e/16384*a;c[e]=Math.cos(t),h[e]=Math.sin(t)}let d=n(e,{...l,gain:0}),p=i(e,{...u,curve:c}),f=i(e,{...u,curve:o}),m=n(e,{...l,gain:0}),g=i(e,{...u,curve:h});return{connectGraph(){t.connect(d),t.connect(void 0===f.inputs?f:f.inputs[0]),t.connect(m),f.connect(s),s.connect(void 0===p.inputs?p:p.inputs[0]),s.connect(void 0===g.inputs?g:g.inputs[0]),p.connect(d.gain),g.connect(m.gain),d.connect(r,0,0),m.connect(r,0,1)},disconnectGraph(){t.disconnect(d),t.disconnect(void 0===f.inputs?f:f.inputs[0]),t.disconnect(m),f.disconnect(s),s.disconnect(void 0===p.inputs?p:p.inputs[0]),s.disconnect(void 0===g.inputs?g:g.inputs[0]),p.disconnect(d.gain),g.disconnect(m.gain),d.disconnect(r,0,0),m.disconnect(r,0,1)}}},buildInternalGraphForStereo=(e,s,r,c)=>{let h=new Float32Array(16385),d=new Float32Array(16385),p=new Float32Array(16385),f=new Float32Array(16385),m=Math.floor(8192.5);for(let e=0;e<16385;e+=1)if(e>m){let t=(e-m)/(16384-m)*a;h[e]=Math.cos(t),d[e]=Math.sin(t),p[e]=0,f[e]=1}else{let t=e/(16384-m)*a;h[e]=1,d[e]=0,p[e]=Math.cos(t),f[e]=Math.sin(t)}let g=t(e,{channelCount:2,channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:2}),v=n(e,{...l,gain:0}),y=i(e,{...u,curve:h}),A=n(e,{...l,gain:0}),S=i(e,{...u,curve:d}),x=i(e,{...u,curve:o}),T=n(e,{...l,gain:0}),C=i(e,{...u,curve:p}),N=n(e,{...l,gain:0}),w=i(e,{...u,curve:f});return{connectGraph(){s.connect(g),s.connect(void 0===x.inputs?x:x.inputs[0]),g.connect(v,0),g.connect(A,0),g.connect(T,1),g.connect(N,1),x.connect(r),r.connect(void 0===y.inputs?y:y.inputs[0]),r.connect(void 0===S.inputs?S:S.inputs[0]),r.connect(void 0===C.inputs?C:C.inputs[0]),r.connect(void 0===w.inputs?w:w.inputs[0]),y.connect(v.gain),S.connect(A.gain),C.connect(T.gain),w.connect(N.gain),v.connect(c,0,0),T.connect(c,0,0),A.connect(c,0,1),N.connect(c,0,1)},disconnectGraph(){s.disconnect(g),s.disconnect(void 0===x.inputs?x:x.inputs[0]),g.disconnect(v,0),g.disconnect(A,0),g.disconnect(T,1),g.disconnect(N,1),x.disconnect(r),r.disconnect(void 0===y.inputs?y:y.inputs[0]),r.disconnect(void 0===S.inputs?S:S.inputs[0]),r.disconnect(void 0===C.inputs?C:C.inputs[0]),r.disconnect(void 0===w.inputs?w:w.inputs[0]),y.disconnect(v.gain),S.disconnect(A.gain),C.disconnect(T.gain),w.disconnect(N.gain),v.disconnect(c,0,0),T.disconnect(c,0,0),A.disconnect(c,0,1),N.disconnect(c,0,1)}}},buildInternalGraph=(e,t,n,i,r)=>{if(1===t)return buildInternalGraphForMono(e,n,i,r);if(2===t)return buildInternalGraphForStereo(e,n,i,r);throw s()};return(t,{channelCount:i,channelCountMode:o,pan:a,...l})=>{if("max"===o)throw s();let u=e(t,{...l,channelCount:1,channelCountMode:o,numberOfInputs:2}),c=n(t,{...l,channelCount:i,channelCountMode:o,gain:1}),h=n(t,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:a}),{connectGraph:d,disconnectGraph:p}=buildInternalGraph(t,i,c,h,u);Object.defineProperty(h.gain,"defaultValue",{get:()=>0}),Object.defineProperty(h.gain,"maxValue",{get:()=>1}),Object.defineProperty(h.gain,"minValue",{get:()=>-1});let f=!1;return r(interceptConnections({get bufferSize(){return},get channelCount(){return c.channelCount},set channelCount(value){c.channelCount!==value&&(f&&p(),{connectGraph:d,disconnectGraph:p}=buildInternalGraph(t,value,c,h,u),f&&d()),c.channelCount=value},get channelCountMode(){return c.channelCountMode},set channelCountMode(value){if("clamped-max"===value||"max"===value)throw s();c.channelCountMode=value},get channelInterpretation(){return c.channelInterpretation},set channelInterpretation(value){c.channelInterpretation=value},get context(){return c.context},get inputs(){return[c]},get numberOfInputs(){return c.numberOfInputs},get numberOfOutputs(){return c.numberOfOutputs},get pan(){return h.gain},addEventListener:(...e)=>c.addEventListener(e[0],e[1],e[2]),dispatchEvent:(...e)=>c.dispatchEvent(e[0]),removeEventListener:(...e)=>c.removeEventListener(e[0],e[1],e[2])},u),()=>{d(),f=!0},()=>{p(),f=!1})}})(tG,createNativeChannelSplitterNode,createNativeGainNode,t8,createNotSupportedError,monitorConnections),createNativeStereoPannerNode=(e,t)=>{let n=t.channelCountMode;if("clamped-max"===n)throw createNotSupportedError();if(void 0===e.createStereoPanner)return t9(e,t);let i=e.createStereoPanner();return assignNativeAudioNodeOptions(i,t),assignNativeAudioNodeAudioParamValue(i,t,"pan"),Object.defineProperty(i,"channelCountMode",{get:()=>n,set:e=>{if(e!==n)throw createNotSupportedError()}}),i},t5=(ev=tM,ey=()=>{let e=new WeakMap,createStereoPannerNode=async(t,n)=>{let i=getNativeAudioNode(t),s=isOwnedByContext(i,n);if(!s){let e={channelCount:i.channelCount,channelCountMode:i.channelCountMode,channelInterpretation:i.channelInterpretation,pan:i.pan.value};i=createNativeStereoPannerNode(n,e)}return e.set(n,i),s?await connectAudioParam(n,t.pan,i.pan):await tV(n,t.pan,i.pan),isNativeAudioNodeFaker(i)?await renderInputsOfAudioNode(t,n,i.inputs[0]):await renderInputsOfAudioNode(t,n,i),i};return{render(t,n){let i=e.get(n);return void 0!==i?Promise.resolve(i):createStereoPannerNode(t,n)}}},class extends ev{constructor(e,t){let n=getNativeContext(e),i={...tA,...t},s=createNativeStereoPannerNode(n,i),r=isNativeOfflineAudioContext(n),o=r?ey():null;super(e,!1,s,o),this._pan=tq(this,r,s.pan)}get pan(){return this._pan}}),t7=(eA=tM,eS=()=>{let e=new WeakMap,createWaveShaperNode=async(t,n)=>{let i=getNativeAudioNode(t),s=isOwnedByContext(i,n);if(!s){let e={channelCount:i.channelCount,channelCountMode:i.channelCountMode,channelInterpretation:i.channelInterpretation,curve:i.curve,oversample:i.oversample};i=t8(n,e)}return e.set(n,i),isNativeAudioNodeFaker(i)?await renderInputsOfAudioNode(t,n,i.inputs[0]):await renderInputsOfAudioNode(t,n,i),i};return{render(t,n){let i=e.get(n);return void 0!==i?Promise.resolve(i):createWaveShaperNode(t,n)}}},class extends eA{constructor(e,t){let n=getNativeContext(e),i={...tS,...t},s=t8(n,i),r=isNativeOfflineAudioContext(n),o=r?eS():null;super(e,!0,s,o),this._isCurveNullified=!1,this._nativeWaveShaperNode=s,setAudioNodeTailTime(this,1)}get curve(){return this._isCurveNullified?null:this._nativeWaveShaperNode.curve}set curve(e){if(null===e)this._isCurveNullified=!0,this._nativeWaveShaperNode.curve=new Float32Array([0,0]);else{if(e.length<2)throw createInvalidStateError();this._isCurveNullified=!1,this._nativeWaveShaperNode.curve=e}}get oversample(){return this._nativeWaveShaperNode.oversample}set oversample(e){this._nativeWaveShaperNode.oversample=e}}),ne=null!==tC&&tC.isSecureContext,exposeCurrentFrameAndCurrentTime=(e,t,n)=>{Object.defineProperties(tC,{currentFrame:{configurable:!0,get:()=>Math.round(e*t)},currentTime:{configurable:!0,get:()=>e}});try{return n()}finally{null!==tC&&(delete tC.currentFrame,delete tC.currentTime)}},nt=new WeakMap,nn=ne?(eT=e=>new Promise((t,n)=>{if(null===tC){n(SyntaxError());return}let i=tC.document.head;if(null===i)n(SyntaxError());else{let s=tC.document.createElement("script"),r=new Blob([e],{type:"application/javascript"}),o=URL.createObjectURL(r),a=tC.onerror,removeErrorEventListenerAndRevokeUrl=()=>{tC.onerror=a,URL.revokeObjectURL(o)};tC.onerror=(e,t,i,s,r)=>t===o||t===tC.location.href&&1===i&&1===s?(removeErrorEventListenerAndRevokeUrl(),n(r),!1):null!==a?a(e,t,i,s,r):void 0,s.onerror=()=>{removeErrorEventListenerAndRevokeUrl(),n(SyntaxError())},s.onload=()=>{removeErrorEventListenerAndRevokeUrl(),t()},s.src=o,s.type="module",i.appendChild(s)}}),ex=()=>new DOMException("","AbortError"),eC=async e=>{try{let t=await fetch(e);if(t.ok)return[await t.text(),t.url]}catch{}throw ex()},eN=e=>{let t=nt.get(e);if(void 0!==t)return t;if(null===tN)throw Error("Missing the native OfflineAudioContext constructor.");return t=new tN(1,1,44100),nt.set(e,t),t},ew=new WeakMap,eb=new WeakMap,eO=async()=>{if(null===tk)return!0;if(null===tN)return!1;let e=new Blob(['class A extends AudioWorkletProcessor{process(i){this.port.postMessage(i,[i[0][0].buffer])}}registerProcessor("a",A)'],{type:"application/javascript; charset=utf-8"}),t=new tN(1,128,44100),n=URL.createObjectURL(e),i=!1,s=!1;try{await t.audioWorklet.addModule(n);let e=new tk(t,"a",{numberOfOutputs:0}),r=t.createOscillator();e.port.onmessage=()=>i=!0,e.onprocessorerror=()=>s=!0,r.connect(e),r.start(0),await t.startRendering(),await new Promise(e=>setTimeout(e))}catch{}finally{URL.revokeObjectURL(n)}return i&&!s},s=0,(e,t,n={credentials:"omit"})=>{let i=eb.get(e);if(void 0!==i&&i.has(t))return Promise.resolve();let r=ew.get(e);if(void 0!==r){let e=r.get(t);if(void 0!==e)return e}let o=getNativeContext(e),a=void 0===o.audioWorklet?eC(t).then(([e,t])=>{let[n,i]=splitImportStatements(e,t),s=`${n};((a,b)=>{(a[b]=a[b]||[]).push((AudioWorkletProcessor,global,registerProcessor,sampleRate,self,window)=>{${i}
})})(window,'_AWGS')`;return eT(s)}).then(()=>{let e=tC._AWGS.pop();if(void 0===e)throw SyntaxError();exposeCurrentFrameAndCurrentTime(o.currentTime,o.sampleRate,()=>e(class{},void 0,(e,t)=>{if(""===e.trim())throw createNotSupportedError();let n=e5.get(o);if(void 0!==n){if(n.has(e))throw createNotSupportedError();verifyProcessorCtor(t),verifyParameterDescriptors(t.parameterDescriptors),n.set(e,t)}else verifyProcessorCtor(t),verifyParameterDescriptors(t.parameterDescriptors),e5.set(o,new Map([[e,t]]))},o.sampleRate,void 0,void 0))}):Promise.all([eC(t),Promise.resolve(tT(eO,eO))]).then(([[e,t],i])=>{let r=s+1;s=r;let[a,l]=splitImportStatements(e,t),u=`${a};((AudioWorkletProcessor,registerProcessor)=>{${l}
})(${i?"AudioWorkletProcessor":"class extends AudioWorkletProcessor {__b=new WeakSet();constructor(){super();(p=>p.postMessage=(q=>(m,t)=>q.call(p,m,t?t.filter(u=>!this.__b.has(u)):t))(p.postMessage))(this.port)}}"},(n,p)=>registerProcessor(n,class extends p{${i?"":"__c = (a) => a.forEach(e=>this.__b.add(e.buffer));"}process(i,o,p){${i?"":"i.forEach(this.__c);o.forEach(this.__c);this.__c(Object.values(p));"}return super.process(i.map(j=>j.some(k=>k.length===0)?[]:j),o,p)}}));registerProcessor('__sac${r}',class extends AudioWorkletProcessor{process(){return !1}})`,c=new Blob([u],{type:"application/javascript; charset=utf-8"}),h=URL.createObjectURL(c);return o.audioWorklet.addModule(h,n).then(()=>{if(isNativeOfflineAudioContext(o))return o;let e=eN(o);return e.audioWorklet.addModule(h,n).then(()=>e)}).then(e=>{if(null===tk)throw SyntaxError();try{new tk(e,`__sac${r}`)}catch{throw SyntaxError()}}).finally(()=>URL.revokeObjectURL(h))});return void 0===r?ew.set(e,new Map([[t,a]])):r.set(t,a),a.then(()=>{let n=eb.get(e);void 0===n?eb.set(e,new Set([t])):n.add(t)}).finally(()=>{let n=ew.get(e);void 0!==n&&n.delete(t)}),a}):void 0,ni=(ek=()=>new DOMException("","DataCloneError"),eM=()=>new DOMException("","EncodingError"),eE=new WeakSet,eD=e=>isNativeAudioContext(e)||isNativeOfflineAudioContext(e),(e,t)=>{let n=eD(e)?e:getNativeContext(e);if(eE.has(t)){let e=ek();return Promise.reject(e)}try{eE.add(t)}catch{}return tT(testPromiseSupport,()=>testPromiseSupport(n))?n.decodeAudioData(t).then(e=>(detachArrayBuffer(t).catch(()=>{}),tT(testAudioBufferCopyChannelMethodsOutOfBoundsSupport,()=>testAudioBufferCopyChannelMethodsOutOfBoundsSupport(e))||wrapAudioBufferCopyChannelMethodsOutOfBounds(e),tD.add(e),e)):new Promise((e,i)=>{let complete=async()=>{try{await detachArrayBuffer(t)}catch{}},fail=e=>{i(e),complete()};try{n.decodeAudioData(t,t=>{"function"!=typeof t.copyFromChannel&&(wrapAudioBufferCopyChannelMethods(t),wrapAudioBufferGetChannelDataMethod(t)),tD.add(t),complete().then(()=>e(t))},e=>{null===e?fail(eM()):fail(e)})}catch(e){fail(e)}})}),ns=(eI=t1,class extends eI{constructor(e,t){super(e,t),this._nativeContext=e,this._audioWorklet=void 0===nn?void 0:{addModule:(e,t)=>nn(this,e,t)}}get audioWorklet(){return this._audioWorklet}createAnalyser(){return new tE(this)}createBiquadFilter(){return new tL(this)}createBuffer(e,t,n){return new tR({length:t,numberOfChannels:e,sampleRate:n})}createBufferSource(){return new tB(this)}createChannelMerger(e=6){return new tj(this,{numberOfInputs:e})}createChannelSplitter(e=6){return new tY(this,{numberOfOutputs:e})}createConstantSource(){return new tU(this)}createConvolver(){return new tH(this)}createDelay(e=1){return new t$(this,{maxDelayTime:e})}createDynamicsCompressor(){return new tK(this)}createGain(){return new tZ(this)}createIIRFilter(e,t){return new tJ(this,{feedback:t,feedforward:e})}createOscillator(){return new t2(this)}createPanner(){return new t6(this)}createPeriodicWave(e,t,n={disableNormalization:!1}){return new t4(this,{...n,imag:t,real:e})}createStereoPanner(){return new t5(this)}createWaveShaper(){return new t7(this)}decodeAudioData(e,t,n){return ni(this._nativeContext,e).then(e=>("function"==typeof t&&t(e),e),e=>{throw"function"==typeof n&&n(e),e})}}),nr=(eP=tM,eR=(e,t)=>e.createMediaElementSource(t.mediaElement),class extends eP{constructor(e,t){let n=getNativeContext(e),i=eR(n,t);if(isNativeOfflineAudioContext(n))throw TypeError();super(e,!0,i,null),this._nativeMediaElementAudioSourceNode=i}get mediaElement(){return this._nativeMediaElementAudioSourceNode.mediaElement}}),no=(eF=tM,eV=(e,t)=>{let n=e.createMediaStreamDestination();return assignNativeAudioNodeOptions(n,t),1===n.numberOfOutputs&&Object.defineProperty(n,"numberOfOutputs",{get:()=>0}),n},class extends eF{constructor(e,t){let n=getNativeContext(e);if(isNativeOfflineAudioContext(n))throw TypeError();let i={...tm,...t},s=eV(n,i);super(e,!1,s,null),this._nativeMediaStreamAudioDestinationNode=s}get stream(){return this._nativeMediaStreamAudioDestinationNode.stream}}),na=(eq=tM,eB=(e,{mediaStream:t})=>{let n=t.getAudioTracks();n.sort((e,t)=>e.id<t.id?-1:e.id>t.id?1:0);let i=n.slice(0,1),s=e.createMediaStreamSource(new MediaStream(i));return Object.defineProperty(s,"mediaStream",{value:t}),s},class extends eq{constructor(e,t){let n=getNativeContext(e),i=eB(n,t);if(isNativeOfflineAudioContext(n))throw TypeError();super(e,!0,i,null),this._nativeMediaStreamAudioSourceNode=i}get mediaStream(){return this._nativeMediaStreamAudioSourceNode.mediaStream}}),nl=(eW=tM,eL=(e,{mediaStreamTrack:t})=>{if("function"==typeof e.createMediaStreamTrackSource)return e.createMediaStreamTrackSource(t);let n=new MediaStream([t]),i=e.createMediaStreamSource(n);if("audio"!==t.kind)throw createInvalidStateError();if(isNativeOfflineAudioContext(e))throw TypeError();return i},class extends eW{constructor(e,t){let n=getNativeContext(e),i=eL(n,t);super(e,!0,i,null)}}),nu=(eG=ns,class extends eG{constructor(e={}){let t;if(null===tO)throw Error("Missing the native AudioContext constructor.");try{t=new tO(e)}catch(e){if(12===e.code&&"sampleRate is not in range"===e.message)throw createNotSupportedError();throw e}if(null===t)throw createUnknownError();if(!isValidLatencyHint(e.latencyHint))throw TypeError(`The provided value '${e.latencyHint}' is not a valid enum value of type AudioContextLatencyCategory.`);if(void 0!==e.sampleRate&&t.sampleRate!==e.sampleRate)throw createNotSupportedError();super(t,2);let{latencyHint:n}=e,{sampleRate:i}=t;if(this._baseLatency="number"==typeof t.baseLatency?t.baseLatency:"balanced"===n?512/i:"interactive"===n||void 0===n?256/i:"playback"===n?1024/i:128*Math.max(2,Math.min(128,Math.round(n*i/128)))/i,this._nativeAudioContext=t,"webkitAudioContext"===tO.name?(this._nativeGainNode=t.createGain(),this._nativeOscillatorNode=t.createOscillator(),this._nativeGainNode.gain.value=1e-37,this._nativeOscillatorNode.connect(this._nativeGainNode).connect(t.destination),this._nativeOscillatorNode.start()):(this._nativeGainNode=null,this._nativeOscillatorNode=null),this._state=null,"running"===t.state){this._state="suspended";let revokeState=()=>{"suspended"===this._state&&(this._state=null),t.removeEventListener("statechange",revokeState)};t.addEventListener("statechange",revokeState)}}get baseLatency(){return this._baseLatency}get state(){return null!==this._state?this._state:this._nativeAudioContext.state}close(){return"closed"===this.state?this._nativeAudioContext.close().then(()=>{throw createInvalidStateError()}):("suspended"===this._state&&(this._state=null),this._nativeAudioContext.close().then(()=>{null!==this._nativeGainNode&&null!==this._nativeOscillatorNode&&(this._nativeOscillatorNode.stop(),this._nativeGainNode.disconnect(),this._nativeOscillatorNode.disconnect()),deactivateAudioGraph(this)}))}createMediaElementSource(e){return new nr(this,{mediaElement:e})}createMediaStreamDestination(){return new no(this)}createMediaStreamSource(e){return new na(this,{mediaStream:e})}createMediaStreamTrackSource(e){return new nl(this,{mediaStreamTrack:e})}resume(){return"suspended"===this._state?new Promise((e,t)=>{let resolvePromise=()=>{this._nativeAudioContext.removeEventListener("statechange",resolvePromise),"running"===this._nativeAudioContext.state?e():this.resume().then(e,t)};this._nativeAudioContext.addEventListener("statechange",resolvePromise)}):this._nativeAudioContext.resume().catch(e=>{if(void 0===e||15===e.code)throw createInvalidStateError();throw e})}suspend(){return this._nativeAudioContext.suspend().catch(e=>{if(void 0===e)throw createInvalidStateError();throw e})}}),getUnrenderedAudioWorkletNodes=e=>{let t=t0.get(e);if(void 0===t)throw Error("The context has no set of AudioWorkletNodes.");return t},connectMultipleOutputs=(e,t,n=0,i=0)=>{let s=e[n];if(void 0===s)throw createIndexSizeError();return isNativeAudioNode(t)?s.connect(t,0,i):s.connect(t,0)},disconnectMultipleOutputs=(e,t,n,i=0)=>void 0===t?e.forEach(e=>e.disconnect()):"number"==typeof t?getOutputAudioNodeAtIndex(createIndexSizeError,e,t).disconnect():isNativeAudioNode(t)?void 0===n?e.forEach(e=>e.disconnect(t)):void 0===i?getOutputAudioNodeAtIndex(createIndexSizeError,e,n).disconnect(t,0):getOutputAudioNodeAtIndex(createIndexSizeError,e,n).disconnect(t,0,i):void 0===n?e.forEach(e=>e.disconnect(t)):getOutputAudioNodeAtIndex(createIndexSizeError,e,n).disconnect(t,0),nc=new WeakMap,nh=(ej=e=>getValueForKey(nc,e),(e,t,n,i)=>{var s,r;if(0===i.numberOfInputs&&0===i.numberOfOutputs)throw createNotSupportedError();let o=Array.isArray(i.outputChannelCount)?i.outputChannelCount:Array.from(i.outputChannelCount);if(o.some(e=>e<1))throw createNotSupportedError();if(o.length!==i.numberOfOutputs)throw createIndexSizeError();if("explicit"!==i.channelCountMode)throw createNotSupportedError();let a=i.channelCount*i.numberOfInputs,l=o.reduce((e,t)=>e+t,0),u=void 0===n.parameterDescriptors?0:n.parameterDescriptors.length;if(a+u>6||l>6)throw createNotSupportedError();let c=new MessageChannel,h=[],d=[];for(let t=0;t<i.numberOfInputs;t+=1)h.push(createNativeGainNode(e,{channelCount:i.channelCount,channelCountMode:i.channelCountMode,channelInterpretation:i.channelInterpretation,gain:1})),d.push(createNativeChannelSplitterNode(e,{channelCount:i.channelCount,channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:i.channelCount}));let p=[];if(void 0!==n.parameterDescriptors)for(let{defaultValue:t,maxValue:s,minValue:r,name:o}of n.parameterDescriptors){let n=tz(e,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",offset:void 0!==i.parameterData[o]?i.parameterData[o]:void 0===t?0:t});Object.defineProperties(n.offset,{defaultValue:{get:()=>void 0===t?0:t},maxValue:{get:()=>void 0===s?34028234663852886e22:s},minValue:{get:()=>void 0===r?-34028234663852886e22:r}}),p.push(n)}let f=tG(e,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:Math.max(1,a+u)}),m=computeBufferSize(t,e.sampleRate),g=createNativeScriptProcessorNode(e,m,a+u,Math.max(1,l)),v=createNativeChannelSplitterNode(e,{channelCount:Math.max(1,l),channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:Math.max(1,l)}),y=[];for(let t=0;t<i.numberOfOutputs;t+=1)y.push(tG(e,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:o[t]}));for(let e=0;e<i.numberOfInputs;e+=1){h[e].connect(d[e]);for(let t=0;t<i.channelCount;t+=1)d[e].connect(f,t,e*i.channelCount+t)}let A=new ReadOnlyMap(void 0===n.parameterDescriptors?[]:n.parameterDescriptors.map(({name:e},t)=>{let n=p[t];return n.connect(f,0,a+t),n.start(0),[e,n.offset]}));f.connect(g);let S=i.channelInterpretation,x=null,T=0===i.numberOfOutputs?[g]:y,C={get bufferSize(){return m},get channelCount(){return i.channelCount},set channelCount(_){throw createInvalidStateError()},get channelCountMode(){return i.channelCountMode},set channelCountMode(_){throw createInvalidStateError()},get channelInterpretation(){return S},set channelInterpretation(value){for(let e of h)e.channelInterpretation=value;S=value},get context(){return g.context},get inputs(){return h},get numberOfInputs(){return i.numberOfInputs},get numberOfOutputs(){return i.numberOfOutputs},get onprocessorerror(){return x},set onprocessorerror(value){"function"==typeof x&&C.removeEventListener("processorerror",x),"function"==typeof(x="function"==typeof value?value:null)&&C.addEventListener("processorerror",x)},get parameters(){return A},get port(){return c.port2},addEventListener:(...e)=>g.addEventListener(e[0],e[1],e[2]),connect:connectMultipleOutputs.bind(null,T),disconnect:disconnectMultipleOutputs.bind(null,T),dispatchEvent:(...e)=>g.dispatchEvent(e[0]),removeEventListener:(...e)=>g.removeEventListener(e[0],e[1],e[2])},N=new Map;c.port1.addEventListener=(s=c.port1.addEventListener,(...t)=>{if("message"===t[0]){let n="function"==typeof t[1]?t[1]:"object"==typeof t[1]&&null!==t[1]&&"function"==typeof t[1].handleEvent?t[1].handleEvent:null;if(null!==n){let i=N.get(t[1]);void 0!==i?t[1]=i:(t[1]=t=>{exposeCurrentFrameAndCurrentTime(e.currentTime,e.sampleRate,()=>n(t))},N.set(n,t[1]))}}return s.call(c.port1,t[0],t[1],t[2])}),c.port1.removeEventListener=(r=c.port1.removeEventListener,(...e)=>{if("message"===e[0]){let t=N.get(e[1]);void 0!==t&&(N.delete(e[1]),e[1]=t)}return r.call(c.port1,e[0],e[1],e[2])});let w=null;Object.defineProperty(c.port1,"onmessage",{get:()=>w,set:e=>{"function"==typeof w&&c.port1.removeEventListener("message",w),"function"==typeof(w="function"==typeof e?e:null)&&(c.port1.addEventListener("message",w),c.port1.start())}}),n.prototype.port=c.port1;let b=null,O=createAudioWorkletProcessor(e,C,n,i);O.then(e=>b=e);let k=createNestedArrays(i.numberOfInputs,i.channelCount),M=createNestedArrays(i.numberOfOutputs,o),E=void 0===n.parameterDescriptors?[]:n.parameterDescriptors.reduce((e,{name:t})=>({...e,[t]:new Float32Array(128)}),{}),D=!0,disconnectOutputsGraph=()=>{i.numberOfOutputs>0&&g.disconnect(v);for(let e=0,t=0;e<i.numberOfOutputs;e+=1){let n=y[e];for(let i=0;i<o[e];i+=1)v.disconnect(n,t+i,i);t+=o[e]}},I=new Map;g.onaudioprocess=({inputBuffer:t,outputBuffer:s})=>{if(null!==b){let r=ej(C);for(let l=0;l<m;l+=128){for(let e=0;e<i.numberOfInputs;e+=1)for(let n=0;n<i.channelCount;n+=1)copyFromChannel(t,k[e],n,n,l);void 0!==n.parameterDescriptors&&n.parameterDescriptors.forEach(({name:e},n)=>{copyFromChannel(t,E,e,a+n,l)});for(let e=0;e<i.numberOfInputs;e+=1)for(let t=0;t<o[e];t+=1)0===M[e][t].byteLength&&(M[e][t]=new Float32Array(128));try{let t=k.map((e,t)=>{let n=r[t];if(n.size>0)return I.set(t,m/128),e;let i=I.get(t);return void 0===i?[]:(e.every(e=>e.every(e=>0===e))&&(1===i?I.delete(t):I.set(t,i-1)),e)}),n=exposeCurrentFrameAndCurrentTime(e.currentTime+l/e.sampleRate,e.sampleRate,()=>b.process(t,M,E));D=n;for(let e=0,t=0;e<i.numberOfOutputs;e+=1){for(let n=0;n<o[e];n+=1)copyToChannel(s,M[e],n,t+n,l);t+=o[e]}}catch(e){D=!1,C.dispatchEvent(new ErrorEvent("processorerror",{colno:e.colno,filename:e.filename,lineno:e.lineno,message:e.message}))}if(!D){for(let e=0;e<i.numberOfInputs;e+=1){h[e].disconnect(d[e]);for(let t=0;t<i.channelCount;t+=1)d[l].disconnect(f,t,e*i.channelCount+t)}if(void 0!==n.parameterDescriptors){let e=n.parameterDescriptors.length;for(let t=0;t<e;t+=1){let e=p[t];e.disconnect(f,0,a+t),e.stop()}}f.disconnect(g),g.onaudioprocess=null,P?disconnectOutputsGraph():disconnectFakeGraph();break}}}};let P=!1,R=createNativeGainNode(e,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0}),connectFakeGraph=()=>g.connect(R).connect(e.destination),disconnectFakeGraph=()=>{g.disconnect(R),R.disconnect()};return connectFakeGraph(),monitorConnections(C,()=>{if(D){disconnectFakeGraph(),i.numberOfOutputs>0&&g.connect(v);for(let e=0,t=0;e<i.numberOfOutputs;e+=1){let n=y[e];for(let i=0;i<o[e];i+=1)v.connect(n,t+i,i);t+=o[e]}}P=!0},()=>{D&&(connectFakeGraph(),disconnectOutputsGraph()),P=!1})}),nd=(eY=(e,t)=>{getUnrenderedAudioWorkletNodes(e).delete(t)},(e,t,n)=>{let i=new WeakMap,s=null,createAudioNode=async(r,o)=>{let a=getNativeAudioNode(r),l=null,u=isOwnedByContext(a,o),c=Array.isArray(t.outputChannelCount)?t.outputChannelCount:Array.from(t.outputChannelCount);if(null===tk){let e=c.reduce((e,t)=>e+t,0),n=createNativeChannelSplitterNode(o,{channelCount:Math.max(1,e),channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:Math.max(1,e)}),i=[];for(let e=0;e<r.numberOfOutputs;e+=1)i.push(tG(o,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:c[e]}));let s=createNativeGainNode(o,{channelCount:t.channelCount,channelCountMode:t.channelCountMode,channelInterpretation:t.channelInterpretation,gain:1});s.connect=connectMultipleOutputs.bind(null,i),s.disconnect=disconnectMultipleOutputs.bind(null,i),l=[n,i,s]}else u||(a=new tk(o,e));if(i.set(o,null===l?a:l[2]),null!==l){if(null===s){if(void 0===n)throw Error("Missing the processor constructor.");if(null===tN)throw Error("Missing the native OfflineAudioContext constructor.");let e=r.channelCount*r.numberOfInputs,i=void 0===n.parameterDescriptors?0:n.parameterDescriptors.length,a=e+i,renderBuffer=async()=>{let n=new tN(a,128*Math.ceil(r.context.length/128),o.sampleRate),s=[],l=[];for(let e=0;e<t.numberOfInputs;e+=1)s.push(createNativeGainNode(n,{channelCount:t.channelCount,channelCountMode:t.channelCountMode,channelInterpretation:t.channelInterpretation,gain:1})),l.push(createNativeChannelSplitterNode(n,{channelCount:t.channelCount,channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:t.channelCount}));let u=await Promise.all(Array.from(r.parameters.values()).map(async e=>{let t=tz(n,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",offset:e.value});return await tV(n,e,t.offset),t})),c=tG(n,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:Math.max(1,e+i)});for(let e=0;e<t.numberOfInputs;e+=1){s[e].connect(l[e]);for(let n=0;n<t.channelCount;n+=1)l[e].connect(c,n,e*t.channelCount+n)}for(let[t,n]of u.entries())n.connect(c,0,e+t),n.start(0);return c.connect(n.destination),await Promise.all(s.map(e=>renderInputsOfAudioNode(r,n,e))),tX(n)};s=processBuffer(r,0===a?null:await renderBuffer(),o,t,c,n,exposeCurrentFrameAndCurrentTime)}let e=await s,i=tF(o,{buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1}),[a,u,h]=l;null!==e&&(i.buffer=e,i.start(0)),i.connect(a);for(let e=0,t=0;e<r.numberOfOutputs;e+=1){let n=u[e];for(let i=0;i<c[e];i+=1)a.connect(n,t+i,i);t+=c[e]}return h}if(u)for(let[e,t]of r.parameters.entries())await connectAudioParam(o,t,a.parameters.get(e));else for(let[e,t]of r.parameters.entries())await tV(o,t,a.parameters.get(e));return await renderInputsOfAudioNode(r,o,a),a};return{render(e,t){eY(t,e);let n=i.get(t);return void 0!==n?Promise.resolve(n):createAudioNode(e,t)}}}),np=ne?(ez=(e,t)=>{getUnrenderedAudioWorkletNodes(e).add(t)},eU=tM,eH=(e,t,n,i,s,r)=>{if(null!==n)try{var o,a;let t=new n(e,i,r),s=new Map,l=null;if(Object.defineProperties(t,{channelCount:{get:()=>r.channelCount,set:()=>{throw createInvalidStateError()}},channelCountMode:{get:()=>"explicit",set:()=>{throw createInvalidStateError()}},onprocessorerror:{get:()=>l,set:e=>{"function"==typeof l&&t.removeEventListener("processorerror",l),l="function"==typeof e?e:null,"function"==typeof l&&t.addEventListener("processorerror",l)}}}),t.addEventListener=(o=t.addEventListener,(...e)=>{if("processorerror"===e[0]){let t="function"==typeof e[1]?e[1]:"object"==typeof e[1]&&null!==e[1]&&"function"==typeof e[1].handleEvent?e[1].handleEvent:null;if(null!==t){let n=s.get(e[1]);void 0!==n?e[1]=n:(e[1]=n=>{"error"===n.type?(Object.defineProperties(n,{type:{value:"processorerror"}}),t(n)):t(new ErrorEvent(e[0],{...n}))},s.set(t,e[1]))}}return o.call(t,"error",e[1],e[2]),o.call(t,...e)}),t.removeEventListener=(a=t.removeEventListener,(...e)=>{if("processorerror"===e[0]){let t=s.get(e[1]);void 0!==t&&(s.delete(e[1]),e[1]=t)}return a.call(t,"error",e[1],e[2]),a.call(t,e[0],e[1],e[2])}),0!==r.numberOfOutputs){let n=createNativeGainNode(e,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0});return t.connect(n).connect(e.destination),monitorConnections(t,()=>n.disconnect(),()=>n.connect(e.destination))}return t}catch(e){if(11===e.code)throw createNotSupportedError();throw e}if(void 0===s)throw createNotSupportedError();return testClonabilityOfAudioWorkletNodeOptions(r),nh(e,t,s,r)},e$=e=>nt.get(e),eK=e=>({...e,outputChannelCount:void 0!==e.outputChannelCount?e.outputChannelCount:1===e.numberOfInputs&&1===e.numberOfOutputs?[e.channelCount]:Array.from({length:e.numberOfOutputs},()=>1)}),eZ=(e,t)=>{nc.set(e,t)},eX=e=>{let{port1:t,port2:n}=new MessageChannel;try{t.postMessage(e)}finally{t.close(),n.close()}},class extends eU{constructor(e,t,n){var i;let s=getNativeContext(e),r=isNativeOfflineAudioContext(s),o=eK({...tr,...n});eX(o);let a=e5.get(s),l=null==a?void 0:a.get(t),u=r||"closed"!==s.state?s:null!==(i=e$(s))&&void 0!==i?i:s,c=eH(u,r?null:e.baseLatency,tk,t,l,o),h=r?nd(t,o,l):null;super(e,!0,c,h);let d=[];c.parameters.forEach((e,t)=>{let n=tq(this,r,e);d.push([t,n])}),this._nativeAudioWorkletNode=c,this._onprocessorerror=null,this._parameters=new ReadOnlyMap(d),r&&ez(s,this);let{activeInputs:p}=getAudioNodeConnections(this);eZ(c,p)}get onprocessorerror(){return this._onprocessorerror}set onprocessorerror(e){let t="function"==typeof e?wrapEventListener(this,e):null;this._nativeAudioWorkletNode.onprocessorerror=t;let n=this._nativeAudioWorkletNode.onprocessorerror;this._onprocessorerror=null!==n&&n===t?e:n}get parameters(){return null===this._parameters?this._nativeAudioWorkletNode.parameters:this._parameters}get port(){return this._nativeAudioWorkletNode.port}}):void 0,createNativeOfflineAudioContext=(e,t,n)=>{if(null===tN)throw Error("Missing the native OfflineAudioContext constructor.");try{return new tN(e,t,n)}catch(e){if("SyntaxError"===e.name)throw createNotSupportedError();throw e}},startRendering=(e,t)=>getAudioNodeRenderer(e).render(e,t).then(()=>Promise.all(Array.from(getUnrenderedAudioWorkletNodes(t)).map(e=>getAudioNodeRenderer(e).render(e,t)))).then(()=>tX(t)).then(e=>("function"!=typeof e.copyFromChannel?(wrapAudioBufferCopyChannelMethods(e),wrapAudioBufferGetChannelDataMethod(e)):tT(testAudioBufferCopyChannelMethodsOutOfBoundsSupport,()=>testAudioBufferCopyChannelMethodsOutOfBoundsSupport(e))||wrapAudioBufferCopyChannelMethodsOutOfBounds(e),tD.add(e),e)),nf=(eQ=ns,class extends eQ{constructor(e,t,n){let i;if("number"==typeof e&&void 0!==t&&void 0!==n)i={length:t,numberOfChannels:e,sampleRate:n};else if("object"==typeof e)i=e;else throw Error("The given parameters are not valid.");let{length:s,numberOfChannels:r,sampleRate:o}={...t_,...i},a=createNativeOfflineAudioContext(r,s,o);tT(testPromiseSupport,()=>testPromiseSupport(a))||a.addEventListener("statechange",(()=>{let e=0,delayStateChangeEvent=t=>{"running"===this._state&&(e>0?(a.removeEventListener("statechange",delayStateChangeEvent),t.stopImmediatePropagation(),this._waitForThePromiseToSettle(t)):e+=1)};return delayStateChangeEvent})()),super(a,r),this._length=s,this._nativeOfflineAudioContext=a,this._state=null}get length(){return void 0===this._nativeOfflineAudioContext.length?this._length:this._nativeOfflineAudioContext.length}get state(){return null===this._state?this._nativeOfflineAudioContext.state:this._state}startRendering(){return"running"===this._state?Promise.reject(createInvalidStateError()):(this._state="running",startRendering(this.destination,this._nativeOfflineAudioContext).finally(()=>{this._state=null,deactivateAudioGraph(this)}))}_waitForThePromiseToSettle(e){null===this._state?this._nativeOfflineAudioContext.dispatchEvent(e):setTimeout(()=>this._waitForThePromiseToSettle(e))}}),isAnyAudioContext=e=>{let t=e6.get(e);return isNativeAudioContext(t)||isNativeAudioContext(e)},isAnyAudioNode=e=>e2.has(e)||module_isNativeAudioNode(e),isAnyAudioParam=e=>e3.has(e)||isNativeAudioParam(e),isAnyOfflineAudioContext=e=>{let t=e6.get(e);return isNativeOfflineAudioContext(t)||isNativeOfflineAudioContext(e)}},2128:function(e,t,n){"use strict";n.d(t,{f:function(){return Volume}});var i=n(689),s=n(1957),r=n(988),o=n(8886);let Volume=class Volume extends s.HD{constructor(){super((0,r.Y9)(Volume.getDefaults(),arguments,["volume"])),this.name="Volume";let e=(0,r.Y9)(Volume.getDefaults(),arguments,["volume"]);this.input=this.output=new i.S({context:this.context,gain:e.volume,units:"decibels"}),this.volume=this.output.gain,(0,o.qt)(this,"volume"),this._unmutedVolume=e.volume,this.mute=e.mute}static getDefaults(){return Object.assign(s.HD.getDefaults(),{mute:!1,volume:0})}get mute(){return this.volume.value===-1/0}set mute(e){!this.mute&&e?(this._unmutedVolume=this.volume.value,this.volume.value=-1/0):this.mute&&!e&&(this.volume.value=this._unmutedVolume)}dispose(){return super.dispose(),this.input.dispose(),this.volume.dispose(),this}}},7797:function(e,t,n){"use strict";n.d(t,{fw:function(){return getContext},BL:function(){return start}});var i=n(665),s=n(4270),r=n(4182),o=n(44),a=n(7448);let DummyContext=class DummyContext extends a.r{constructor(){super(...arguments),this.lookAhead=0,this.latencyHint=0,this.isOffline=!1}createAnalyser(){return{}}createOscillator(){return{}}createBufferSource(){return{}}createBiquadFilter(){return{}}createBuffer(e,t,n){return{}}createChannelMerger(e){return{}}createChannelSplitter(e){return{}}createConstantSource(){return{}}createConvolver(){return{}}createDelay(e){return{}}createDynamicsCompressor(){return{}}createGain(){return{}}createIIRFilter(e,t){return{}}createPanner(){return{}}createPeriodicWave(e,t,n){return{}}createStereoPanner(){return{}}createWaveShaper(){return{}}createMediaStreamSource(e){return{}}createMediaElementSource(e){return{}}createMediaStreamDestination(){return{}}decodeAudioData(e){return Promise.resolve({})}createAudioWorkletNode(e,t){return{}}get rawContext(){return{}}addAudioWorkletModule(e,t){return(0,o.mG)(this,void 0,void 0,function*(){return Promise.resolve()})}resume(){return Promise.resolve()}setTimeout(e,t){return 0}clearTimeout(e){return this}setInterval(e,t){return 0}clearInterval(e){return this}getConstant(e){return{}}get currentTime(){return 0}get state(){return{}}get sampleRate(){return 0}get listener(){return{}}get transport(){return{}}get draw(){return{}}set draw(e){}get destination(){return{}}set destination(e){}now(){return 0}immediate(){return 0}};var l=n(3584),u=n(125);let c=new DummyContext,h=c;function getContext(){var e;return h===c&&s.bh&&(e=new r._,h=(0,u.ge)(e)?new r._(e):(0,u.Ls)(e)?new l.n(e):e),h}function start(){return h.resume()}if(s.qN&&!s.qN.TONE_SILENCE_LOGGING){let e="v";"dev"===i.i&&(e="");let t=` * Tone.js ${e}${i.i} * `;console.log(`%c${t}`,"background: #000; color: #fff")}},6346:function(e,t,n){"use strict";n.d(t,{d:function(){return Tone}});var i=n(665),s=n(4270),r=n(9277);/**
 * Tone.js
 * @author Yotam Mann
 * @license http://opensource.org/licenses/MIT MIT License
 * @copyright 2014-2019 Yotam Mann
 */let Tone=class Tone{constructor(){this.debug=!1,this._wasDisposed=!1}static getDefaults(){return{}}log(...e){(this.debug||s.qN&&this.toString()===s.qN.TONE_DEBUG_CLASS)&&(0,r.cM)(this,...e)}dispose(){return this._wasDisposed=!0,this}get disposed(){return this._wasDisposed}toString(){return this.name}};Tone.version=i.i},4270:function(e,t,n){"use strict";n.d(t,{MW:function(){return createAudioContext},RM:function(){return createAudioWorkletNode},bh:function(){return a},qN:function(){return o},zt:function(){return createOfflineAudioContext}});var i=n(5348),s=n(9277),r=n(1626);function createAudioContext(e){return new i.Hm(e)}function createOfflineAudioContext(e,t,n){return new i.uM(e,t,n)}let o="object"==typeof self?self:null,a=o&&(o.hasOwnProperty("AudioContext")||o.hasOwnProperty("webkitAudioContext"));function createAudioWorkletNode(e,t,n){return(0,s.hu)((0,r.$K)(i.c9),"This node only works in a secure context (https or localhost)"),new i.c9(e,t,n)}},7448:function(e,t,n){"use strict";n.d(t,{r:function(){return BaseContext}});var i=n(1250);let BaseContext=class BaseContext extends i.Q{constructor(){super(...arguments),this.isOffline=!1}toJSON(){return{}}}},4182:function(e,t,n){"use strict";n.d(t,{_:function(){return Context}});var i=n(44);let Ticker=class Ticker{constructor(e,t,n){this._callback=e,this._type=t,this._updateInterval=n,this._createClock()}_createWorker(){let e=new Blob([`
			// the initial timeout time
			let timeoutTime =  ${(1e3*this._updateInterval).toFixed(1)};
			// onmessage callback
			self.onmessage = function(msg){
				timeoutTime = parseInt(msg.data);
			};
			// the tick function which posts a message
			// and schedules a new tick
			function tick(){
				setTimeout(tick, timeoutTime);
				self.postMessage('tick');
			}
			// call tick initially
			tick();
			`],{type:"text/javascript"}),t=URL.createObjectURL(e),n=new Worker(t);n.onmessage=this._callback.bind(this),this._worker=n}_createTimeout(){this._timeout=setTimeout(()=>{this._createTimeout(),this._callback()},1e3*this._updateInterval)}_createClock(){if("worker"===this._type)try{this._createWorker()}catch(e){this._type="timeout",this._createClock()}else"timeout"===this._type&&this._createTimeout()}_disposeClock(){this._timeout&&(clearTimeout(this._timeout),this._timeout=0),this._worker&&(this._worker.terminate(),this._worker.onmessage=null)}get updateInterval(){return this._updateInterval}set updateInterval(e){this._updateInterval=Math.max(e,128/44100),"worker"===this._type&&this._worker.postMessage(Math.max(1e3*e,1))}get type(){return this._type}set type(e){this._disposeClock(),this._type=e,this._createClock()}dispose(){this._disposeClock()}};var s=n(125),r=n(988),o=n(6371),a=n(1626),l=n(4270),u=n(9284),c=n(7448),h=n(9277);let Context=class Context extends c.r{constructor(){super(),this.name="Context",this._constants=new Map,this._timeouts=new o.T,this._timeoutIds=0,this._initialized=!1,this.isOffline=!1,this._workletModules=new Map;let e=(0,r.Y9)(Context.getDefaults(),arguments,["context"]);e.context?this._context=e.context:this._context=(0,l.MW)({latencyHint:e.latencyHint}),this._ticker=new Ticker(this.emit.bind(this,"tick"),e.clockSource,e.updateInterval),this.on("tick",this._timeoutLoop.bind(this)),this._context.onstatechange=()=>{this.emit("statechange",this.state)},this._setLatencyHint(e.latencyHint),this.lookAhead=e.lookAhead}static getDefaults(){return{clockSource:"worker",latencyHint:"interactive",lookAhead:.1,updateInterval:.05}}initialize(){return this._initialized||((0,u.z8)(this),this._initialized=!0),this}createAnalyser(){return this._context.createAnalyser()}createOscillator(){return this._context.createOscillator()}createBufferSource(){return this._context.createBufferSource()}createBiquadFilter(){return this._context.createBiquadFilter()}createBuffer(e,t,n){return this._context.createBuffer(e,t,n)}createChannelMerger(e){return this._context.createChannelMerger(e)}createChannelSplitter(e){return this._context.createChannelSplitter(e)}createConstantSource(){return this._context.createConstantSource()}createConvolver(){return this._context.createConvolver()}createDelay(e){return this._context.createDelay(e)}createDynamicsCompressor(){return this._context.createDynamicsCompressor()}createGain(){return this._context.createGain()}createIIRFilter(e,t){return this._context.createIIRFilter(e,t)}createPanner(){return this._context.createPanner()}createPeriodicWave(e,t,n){return this._context.createPeriodicWave(e,t,n)}createStereoPanner(){return this._context.createStereoPanner()}createWaveShaper(){return this._context.createWaveShaper()}createMediaStreamSource(e){(0,h.hu)((0,s.ge)(this._context),"Not available if OfflineAudioContext");let t=this._context;return t.createMediaStreamSource(e)}createMediaElementSource(e){(0,h.hu)((0,s.ge)(this._context),"Not available if OfflineAudioContext");let t=this._context;return t.createMediaElementSource(e)}createMediaStreamDestination(){(0,h.hu)((0,s.ge)(this._context),"Not available if OfflineAudioContext");let e=this._context;return e.createMediaStreamDestination()}decodeAudioData(e){return this._context.decodeAudioData(e)}get currentTime(){return this._context.currentTime}get state(){return this._context.state}get sampleRate(){return this._context.sampleRate}get listener(){return this.initialize(),this._listener}set listener(e){(0,h.hu)(!this._initialized,"The listener cannot be set after initialization."),this._listener=e}get transport(){return this.initialize(),this._transport}set transport(e){(0,h.hu)(!this._initialized,"The transport cannot be set after initialization."),this._transport=e}get draw(){return this.initialize(),this._draw}set draw(e){(0,h.hu)(!this._initialized,"Draw cannot be set after initialization."),this._draw=e}get destination(){return this.initialize(),this._destination}set destination(e){(0,h.hu)(!this._initialized,"The destination cannot be set after initialization."),this._destination=e}createAudioWorkletNode(e,t){return(0,l.RM)(this.rawContext,e,t)}addAudioWorkletModule(e,t){return(0,i.mG)(this,void 0,void 0,function*(){(0,h.hu)((0,a.$K)(this.rawContext.audioWorklet),"AudioWorkletNode is only available in a secure context (https or localhost)"),this._workletModules.has(t)||this._workletModules.set(t,this.rawContext.audioWorklet.addModule(e)),yield this._workletModules.get(t)})}workletsAreReady(){return(0,i.mG)(this,void 0,void 0,function*(){let e=[];this._workletModules.forEach(t=>e.push(t)),yield Promise.all(e)})}get updateInterval(){return this._ticker.updateInterval}set updateInterval(e){this._ticker.updateInterval=e}get clockSource(){return this._ticker.type}set clockSource(e){this._ticker.type=e}get latencyHint(){return this._latencyHint}_setLatencyHint(e){let t=0;if(this._latencyHint=e,(0,a.HD)(e))switch(e){case"interactive":t=.1;break;case"playback":t=.5;break;case"balanced":t=.25}this.lookAhead=t,this.updateInterval=t/2}get rawContext(){return this._context}now(){return this._context.currentTime+this.lookAhead}immediate(){return this._context.currentTime}resume(){return(0,s.ge)(this._context)?this._context.resume():Promise.resolve()}close(){return(0,i.mG)(this,void 0,void 0,function*(){(0,s.ge)(this._context)&&(yield this._context.close()),this._initialized&&(0,u.rA)(this)})}getConstant(e){if(this._constants.has(e))return this._constants.get(e);{let t=this._context.createBuffer(1,128,this._context.sampleRate),n=t.getChannelData(0);for(let t=0;t<n.length;t++)n[t]=e;let i=this._context.createBufferSource();return i.channelCount=1,i.channelCountMode="explicit",i.buffer=t,i.loop=!0,i.start(0),this._constants.set(e,i),i}}dispose(){return super.dispose(),this._ticker.dispose(),this._timeouts.dispose(),Object.keys(this._constants).map(e=>this._constants[e].disconnect()),this}_timeoutLoop(){let e=this.now(),t=this._timeouts.peek();for(;this._timeouts.length&&t&&t.time<=e;)t.callback(),this._timeouts.shift(),t=this._timeouts.peek()}setTimeout(e,t){this._timeoutIds++;let n=this.now();return this._timeouts.add({callback:e,id:this._timeoutIds,time:n+t}),this._timeoutIds}clearTimeout(e){return this._timeouts.forEach(t=>{t.id===e&&this._timeouts.remove(t)}),this}clearInterval(e){return this.clearTimeout(e)}setInterval(e,t){let n=++this._timeoutIds,intervalFn=()=>{let i=this.now();this._timeouts.add({callback:()=>{e(),intervalFn()},id:n,time:i+t})};return intervalFn(),n}}},9284:function(e,t,n){"use strict";n.d(t,{Fc:function(){return onContextClose},YV:function(){return onContextInit},rA:function(){return closeContext},z8:function(){return initializeContext}});let i=[];function onContextInit(e){i.push(e)}function initializeContext(e){i.forEach(t=>t(e))}let s=[];function onContextClose(e){s.push(e)}function closeContext(e){s.forEach(t=>t(e))}},689:function(e,t,n){"use strict";n.d(t,{S:function(){return Gain}});var i=n(5055),s=n(988),r=n(8886),o=n(1957);let Gain=class Gain extends o.HD{constructor(){super((0,s.Y9)(Gain.getDefaults(),arguments,["gain","units"])),this.name="Gain",this._gainNode=this.context.createGain(),this.input=this._gainNode,this.output=this._gainNode;let e=(0,s.Y9)(Gain.getDefaults(),arguments,["gain","units"]);this.gain=new i.d({context:this.context,convert:e.convert,param:this._gainNode.gain,units:e.units,value:e.gain,minValue:e.minValue,maxValue:e.maxValue}),(0,r.qt)(this,"gain")}static getDefaults(){return Object.assign(o.HD.getDefaults(),{convert:!0,gain:1,units:"gain"})}dispose(){return super.dispose(),this._gainNode.disconnect(),this.gain.dispose(),this}}},3584:function(e,t,n){"use strict";n.d(t,{n:function(){return OfflineContext}});var i=n(44),s=n(4270),r=n(4182),o=n(125),a=n(137);let OfflineContext=class OfflineContext extends r._{constructor(){super({clockSource:"offline",context:(0,o.Ls)(arguments[0])?arguments[0]:(0,s.zt)(arguments[0],arguments[1]*arguments[2],arguments[2]),lookAhead:0,updateInterval:(0,o.Ls)(arguments[0])?128/arguments[0].sampleRate:128/arguments[2]}),this.name="OfflineContext",this._currentTime=0,this.isOffline=!0,this._duration=(0,o.Ls)(arguments[0])?arguments[0].length/arguments[0].sampleRate:arguments[1]}now(){return this._currentTime}get currentTime(){return this._currentTime}_renderClock(e){return(0,i.mG)(this,void 0,void 0,function*(){let t=0;for(;this._duration-this._currentTime>=0;){this.emit("tick"),this._currentTime+=128/this.sampleRate,t++;let n=Math.floor(this.sampleRate/128);e&&t%n==0&&(yield new Promise(e=>setTimeout(e,1)))}})}render(e=!0){return(0,i.mG)(this,void 0,void 0,function*(){yield this.workletsAreReady(),yield this._renderClock(e);let t=yield this._context.startRendering();return new a.p(t)})}close(){return Promise.resolve()}}},5055:function(e,t,n){"use strict";n.d(t,{d:function(){return Param}});var i=n(1205),s=n(125),r=n(988),o=n(6371),a=n(1626),l=n(7470),u=n(2140),c=n(9277);let Param=class Param extends l.v{constructor(){super((0,r.Y9)(Param.getDefaults(),arguments,["param","units","convert"])),this.name="Param",this.overridden=!1,this._minOutput=1e-7;let e=(0,r.Y9)(Param.getDefaults(),arguments,["param","units","convert"]);for((0,c.hu)((0,a.$K)(e.param)&&((0,s.$n)(e.param)||e.param instanceof Param),"param must be an AudioParam");!(0,s.$n)(e.param);)e.param=e.param._param;this._swappable=!!(0,a.$K)(e.swappable)&&e.swappable,this._swappable?(this.input=this.context.createGain(),this._param=e.param,this.input.connect(this._param)):this._param=this.input=e.param,this._events=new o.T(1e3),this._initialValue=this._param.defaultValue,this.units=e.units,this.convert=e.convert,this._minValue=e.minValue,this._maxValue=e.maxValue,(0,a.$K)(e.value)&&e.value!==this._toType(this._initialValue)&&this.setValueAtTime(e.value,0)}static getDefaults(){return Object.assign(l.v.getDefaults(),{convert:!0,units:"number"})}get value(){let e=this.now();return this.getValueAtTime(e)}set value(e){this.cancelScheduledValues(this.now()),this.setValueAtTime(e,this.now())}get minValue(){return(0,a.$K)(this._minValue)?this._minValue:"time"===this.units||"frequency"===this.units||"normalRange"===this.units||"positive"===this.units||"transportTime"===this.units||"ticks"===this.units||"bpm"===this.units||"hertz"===this.units||"samples"===this.units?0:"audioRange"===this.units?-1:"decibels"===this.units?-1/0:this._param.minValue}get maxValue(){return(0,a.$K)(this._maxValue)?this._maxValue:"normalRange"===this.units||"audioRange"===this.units?1:this._param.maxValue}_is(e,t){return this.units===t}_assertRange(e){return(0,a.$K)(this.maxValue)&&(0,a.$K)(this.minValue)&&(0,c.gI)(e,this._fromType(this.minValue),this._fromType(this.maxValue)),e}_fromType(e){return this.convert&&!this.overridden?this._is(e,"time")?this.toSeconds(e):this._is(e,"decibels")?(0,i.xz)(e):this._is(e,"frequency")?this.toFrequency(e):e:this.overridden?0:e}_toType(e){return this.convert&&"decibels"===this.units?(0,i.H2)(e):e}setValueAtTime(e,t){let n=this.toSeconds(t),i=this._fromType(e);return(0,c.hu)(isFinite(i)&&isFinite(n),`Invalid argument(s) to setValueAtTime: ${JSON.stringify(e)}, ${JSON.stringify(t)}`),this._assertRange(i),this.log(this.units,"setValueAtTime",e,n),this._events.add({time:n,type:"setValueAtTime",value:i}),this._param.setValueAtTime(i,n),this}getValueAtTime(e){let t=Math.max(this.toSeconds(e),0),n=this._events.getAfter(t),i=this._events.get(t),s=this._initialValue;if(null===i)s=this._initialValue;else if("setTargetAtTime"===i.type&&(null===n||"setValueAtTime"===n.type)){let e;let n=this._events.getBefore(i.time);e=null===n?this._initialValue:n.value,"setTargetAtTime"===i.type&&(s=this._exponentialApproach(i.time,e,i.value,i.constant,t))}else if(null===n)s=i.value;else if("linearRampToValueAtTime"===n.type||"exponentialRampToValueAtTime"===n.type){let e=i.value;if("setTargetAtTime"===i.type){let t=this._events.getBefore(i.time);e=null===t?this._initialValue:t.value}s="linearRampToValueAtTime"===n.type?this._linearInterpolate(i.time,e,n.time,n.value,t):this._exponentialInterpolate(i.time,e,n.time,n.value,t)}else s=i.value;return this._toType(s)}setRampPoint(e){e=this.toSeconds(e);let t=this.getValueAtTime(e);return this.cancelAndHoldAtTime(e),0===this._fromType(t)&&(t=this._toType(this._minOutput)),this.setValueAtTime(t,e),this}linearRampToValueAtTime(e,t){let n=this._fromType(e),i=this.toSeconds(t);return(0,c.hu)(isFinite(n)&&isFinite(i),`Invalid argument(s) to linearRampToValueAtTime: ${JSON.stringify(e)}, ${JSON.stringify(t)}`),this._assertRange(n),this._events.add({time:i,type:"linearRampToValueAtTime",value:n}),this.log(this.units,"linearRampToValueAtTime",e,i),this._param.linearRampToValueAtTime(n,i),this}exponentialRampToValueAtTime(e,t){let n=this._fromType(e);n=(0,u.EQ)(n,0)?this._minOutput:n,this._assertRange(n);let i=this.toSeconds(t);return(0,c.hu)(isFinite(n)&&isFinite(i),`Invalid argument(s) to exponentialRampToValueAtTime: ${JSON.stringify(e)}, ${JSON.stringify(t)}`),this._events.add({time:i,type:"exponentialRampToValueAtTime",value:n}),this.log(this.units,"exponentialRampToValueAtTime",e,i),this._param.exponentialRampToValueAtTime(n,i),this}exponentialRampTo(e,t,n){return n=this.toSeconds(n),this.setRampPoint(n),this.exponentialRampToValueAtTime(e,n+this.toSeconds(t)),this}linearRampTo(e,t,n){return n=this.toSeconds(n),this.setRampPoint(n),this.linearRampToValueAtTime(e,n+this.toSeconds(t)),this}targetRampTo(e,t,n){return n=this.toSeconds(n),this.setRampPoint(n),this.exponentialApproachValueAtTime(e,n,t),this}exponentialApproachValueAtTime(e,t,n){t=this.toSeconds(t),n=this.toSeconds(n);let i=Math.log(n+1)/Math.log(200);return this.setTargetAtTime(e,t,i),this.cancelAndHoldAtTime(t+.9*n),this.linearRampToValueAtTime(e,t+n),this}setTargetAtTime(e,t,n){let i=this._fromType(e);(0,c.hu)(isFinite(n)&&n>0,"timeConstant must be a number greater than 0");let s=this.toSeconds(t);return this._assertRange(i),(0,c.hu)(isFinite(i)&&isFinite(s),`Invalid argument(s) to setTargetAtTime: ${JSON.stringify(e)}, ${JSON.stringify(t)}`),this._events.add({constant:n,time:s,type:"setTargetAtTime",value:i}),this.log(this.units,"setTargetAtTime",e,s,n),this._param.setTargetAtTime(i,s,n),this}setValueCurveAtTime(e,t,n,i=1){n=this.toSeconds(n),t=this.toSeconds(t);let s=this._fromType(e[0])*i;this.setValueAtTime(this._toType(s),t);let r=n/(e.length-1);for(let n=1;n<e.length;n++){let s=this._fromType(e[n])*i;this.linearRampToValueAtTime(this._toType(s),t+n*r)}return this}cancelScheduledValues(e){let t=this.toSeconds(e);return(0,c.hu)(isFinite(t),`Invalid argument to cancelScheduledValues: ${JSON.stringify(e)}`),this._events.cancel(t),this._param.cancelScheduledValues(t),this.log(this.units,"cancelScheduledValues",t),this}cancelAndHoldAtTime(e){let t=this.toSeconds(e),n=this._fromType(this.getValueAtTime(t));(0,c.hu)(isFinite(t),`Invalid argument to cancelAndHoldAtTime: ${JSON.stringify(e)}`),this.log(this.units,"cancelAndHoldAtTime",t,"value="+n);let i=this._events.get(t),s=this._events.getAfter(t);return i&&(0,u.EQ)(i.time,t)?s?(this._param.cancelScheduledValues(s.time),this._events.cancel(s.time)):(this._param.cancelAndHoldAtTime(t),this._events.cancel(t+this.sampleTime)):s&&(this._param.cancelScheduledValues(s.time),this._events.cancel(s.time),"linearRampToValueAtTime"===s.type?this.linearRampToValueAtTime(this._toType(n),t):"exponentialRampToValueAtTime"===s.type&&this.exponentialRampToValueAtTime(this._toType(n),t)),this._events.add({time:t,type:"setValueAtTime",value:n}),this._param.setValueAtTime(n,t),this}rampTo(e,t=.1,n){return"frequency"===this.units||"bpm"===this.units||"decibels"===this.units?this.exponentialRampTo(e,t,n):this.linearRampTo(e,t,n),this}apply(e){let t=this.context.currentTime;e.setValueAtTime(this.getValueAtTime(t),t);let n=this._events.get(t);if(n&&"setTargetAtTime"===n.type){let i=this._events.getAfter(n.time),s=i?i.time:t+2,r=(s-t)/10;for(let n=t;n<s;n+=r)e.linearRampToValueAtTime(this.getValueAtTime(n),n)}return this._events.forEachAfter(this.context.currentTime,t=>{"cancelScheduledValues"===t.type?e.cancelScheduledValues(t.time):"setTargetAtTime"===t.type?e.setTargetAtTime(t.value,t.time,t.constant):e[t.type](t.value,t.time)}),this}setParam(e){(0,c.hu)(this._swappable,"The Param must be assigned as 'swappable' in the constructor");let t=this.input;return t.disconnect(this._param),this.apply(e),this._param=e,t.connect(this._param),this}dispose(){return super.dispose(),this._events.dispose(),this}get defaultValue(){return this._toType(this._param.defaultValue)}_exponentialApproach(e,t,n,i,s){return n+(t-n)*Math.exp(-(s-e)/i)}_linearInterpolate(e,t,n,i,s){return t+(i-t)*((s-e)/(n-e))}_exponentialInterpolate(e,t,n,i,s){return t*Math.pow(i/t,(s-e)/(n-e))}}},137:function(e,t,n){"use strict";n.d(t,{p:function(){return ToneAudioBuffer}});var i=n(44),s=n(7797),r=n(6346),o=n(125),a=n(988),l=n(8886),u=n(1626),c=n(9277);let ToneAudioBuffer=class ToneAudioBuffer extends r.d{constructor(){super(),this.name="ToneAudioBuffer",this.onload=l.EI;let e=(0,a.Y9)(ToneAudioBuffer.getDefaults(),arguments,["url","onload","onerror"]);this.reverse=e.reverse,this.onload=e.onload,e.url&&(0,o.MS)(e.url)||e.url instanceof ToneAudioBuffer?this.set(e.url):(0,u.HD)(e.url)&&this.load(e.url).catch(e.onerror)}static getDefaults(){return{onerror:l.EI,onload:l.EI,reverse:!1}}get sampleRate(){return this._buffer?this._buffer.sampleRate:(0,s.fw)().sampleRate}set(e){return e instanceof ToneAudioBuffer?e.loaded?this._buffer=e.get():e.onload=()=>{this.set(e),this.onload(this)}:this._buffer=e,this._reversed&&this._reverse(),this}get(){return this._buffer}load(e){return(0,i.mG)(this,void 0,void 0,function*(){let t=ToneAudioBuffer.load(e).then(e=>{this.set(e),this.onload(this)});ToneAudioBuffer.downloads.push(t);try{yield t}finally{let e=ToneAudioBuffer.downloads.indexOf(t);ToneAudioBuffer.downloads.splice(e,1)}return this})}dispose(){return super.dispose(),this._buffer=void 0,this}fromArray(e){let t=(0,u.kJ)(e)&&e[0].length>0,n=t?e.length:1,i=t?e[0].length:e.length,r=(0,s.fw)(),o=r.createBuffer(n,i,r.sampleRate),a=t||1!==n?e:[e];for(let e=0;e<n;e++)o.copyToChannel(a[e],e);return this._buffer=o,this}toMono(e){if((0,u.hj)(e))this.fromArray(this.toArray(e));else{let e=new Float32Array(this.length),t=this.numberOfChannels;for(let n=0;n<t;n++){let t=this.toArray(n);for(let n=0;n<t.length;n++)e[n]+=t[n]}e=e.map(e=>e/t),this.fromArray(e)}return this}toArray(e){if((0,u.hj)(e))return this.getChannelData(e);if(1===this.numberOfChannels)return this.toArray(0);{let e=[];for(let t=0;t<this.numberOfChannels;t++)e[t]=this.getChannelData(t);return e}}getChannelData(e){return this._buffer?this._buffer.getChannelData(e):new Float32Array(0)}slice(e,t=this.duration){let n=Math.floor(e*this.sampleRate),i=Math.floor(t*this.sampleRate);(0,c.hu)(n<i,"The start time must be less than the end time");let r=i-n,o=(0,s.fw)().createBuffer(this.numberOfChannels,r,this.sampleRate);for(let e=0;e<this.numberOfChannels;e++)o.copyToChannel(this.getChannelData(e).subarray(n,i),e);return new ToneAudioBuffer(o)}_reverse(){if(this.loaded)for(let e=0;e<this.numberOfChannels;e++)this.getChannelData(e).reverse();return this}get loaded(){return this.length>0}get duration(){return this._buffer?this._buffer.duration:0}get length(){return this._buffer?this._buffer.length:0}get numberOfChannels(){return this._buffer?this._buffer.numberOfChannels:0}get reverse(){return this._reversed}set reverse(e){this._reversed!==e&&(this._reversed=e,this._reverse())}static fromArray(e){return new ToneAudioBuffer().fromArray(e)}static fromUrl(e){return(0,i.mG)(this,void 0,void 0,function*(){let t=new ToneAudioBuffer;return yield t.load(e)})}static load(e){return(0,i.mG)(this,void 0,void 0,function*(){let t=e.match(/\[([^\]\[]+\|.+)\]$/);if(t){let n=t[1].split("|"),i=n[0];for(let e of n)if(ToneAudioBuffer.supportsType(e)){i=e;break}e=e.replace(t[0],i)}let n=""===ToneAudioBuffer.baseUrl||ToneAudioBuffer.baseUrl.endsWith("/")?ToneAudioBuffer.baseUrl:ToneAudioBuffer.baseUrl+"/",i=yield fetch(n+e);if(!i.ok)throw Error(`could not load url: ${e}`);let r=yield i.arrayBuffer(),o=yield(0,s.fw)().decodeAudioData(r);return o})}static supportsType(e){let t=e.split("."),n=t[t.length-1],i=document.createElement("audio").canPlayType("audio/"+n);return""!==i}static loaded(){return(0,i.mG)(this,void 0,void 0,function*(){for(yield Promise.resolve();ToneAudioBuffer.downloads.length;)yield ToneAudioBuffer.downloads[0]})}};ToneAudioBuffer.baseUrl="",ToneAudioBuffer.downloads=[]},1957:function(e,t,n){"use strict";n.d(t,{$j:function(){return connect},HD:function(){return ToneAudioNode},ft:function(){return connectSeries},zP:function(){return disconnect}});var i=n(125),s=n(1626),r=n(5055),o=n(7470),a=n(9277);let ToneAudioNode=class ToneAudioNode extends o.v{constructor(){super(...arguments),this.name="ToneAudioNode",this._internalChannels=[]}get numberOfInputs(){return(0,s.$K)(this.input)?(0,i.$n)(this.input)||this.input instanceof r.d?1:this.input.numberOfInputs:0}get numberOfOutputs(){return(0,s.$K)(this.output)?this.output.numberOfOutputs:0}_isAudioNode(e){return(0,s.$K)(e)&&(e instanceof ToneAudioNode||(0,i.kU)(e))}_getInternalNodes(){let e=this._internalChannels.slice(0);return this._isAudioNode(this.input)&&e.push(this.input),this._isAudioNode(this.output)&&this.input!==this.output&&e.push(this.output),e}_setChannelProperties(e){let t=this._getInternalNodes();t.forEach(t=>{t.channelCount=e.channelCount,t.channelCountMode=e.channelCountMode,t.channelInterpretation=e.channelInterpretation})}_getChannelProperties(){let e=this._getInternalNodes();(0,a.hu)(e.length>0,"ToneAudioNode does not have any internal nodes");let t=e[0];return{channelCount:t.channelCount,channelCountMode:t.channelCountMode,channelInterpretation:t.channelInterpretation}}get channelCount(){return this._getChannelProperties().channelCount}set channelCount(e){let t=this._getChannelProperties();this._setChannelProperties(Object.assign(t,{channelCount:e}))}get channelCountMode(){return this._getChannelProperties().channelCountMode}set channelCountMode(e){let t=this._getChannelProperties();this._setChannelProperties(Object.assign(t,{channelCountMode:e}))}get channelInterpretation(){return this._getChannelProperties().channelInterpretation}set channelInterpretation(e){let t=this._getChannelProperties();this._setChannelProperties(Object.assign(t,{channelInterpretation:e}))}connect(e,t=0,n=0){return connect(this,e,t,n),this}toDestination(){return this.connect(this.context.destination),this}toMaster(){return(0,a.ZK)("toMaster() has been renamed toDestination()"),this.toDestination()}disconnect(e,t=0,n=0){return disconnect(this,e,t,n),this}chain(...e){return connectSeries(this,...e),this}fan(...e){return e.forEach(e=>this.connect(e)),this}dispose(){return super.dispose(),(0,s.$K)(this.input)&&(this.input instanceof ToneAudioNode?this.input.dispose():(0,i.kU)(this.input)&&this.input.disconnect()),(0,s.$K)(this.output)&&(this.output instanceof ToneAudioNode?this.output.dispose():(0,i.kU)(this.output)&&this.output.disconnect()),this._internalChannels=[],this}};function connectSeries(...e){let t=e.shift();e.reduce((e,t)=>(e instanceof ToneAudioNode?e.connect(t):(0,i.kU)(e)&&connect(e,t),t),t)}function connect(e,t,n=0,o=0){for((0,a.hu)((0,s.$K)(e),"Cannot connect from undefined node"),(0,a.hu)((0,s.$K)(t),"Cannot connect to undefined node"),(t instanceof ToneAudioNode||(0,i.kU)(t))&&(0,a.hu)(t.numberOfInputs>0,"Cannot connect to node with no inputs"),(0,a.hu)(e.numberOfOutputs>0,"Cannot connect from node with no outputs");t instanceof ToneAudioNode||t instanceof r.d;)(0,s.$K)(t.input)&&(t=t.input);for(;e instanceof ToneAudioNode;)(0,s.$K)(e.output)&&(e=e.output);(0,i.$n)(t)?e.connect(t,n):e.connect(t,n,o)}function disconnect(e,t,n=0,r=0){if((0,s.$K)(t))for(;t instanceof ToneAudioNode;)t=t.input;for(;!(0,i.kU)(e);)(0,s.$K)(e.output)&&(e=e.output);(0,i.$n)(t)?e.disconnect(t,n):(0,i.kU)(t)?e.disconnect(t,n,r):e.disconnect()}},7470:function(e,t,n){"use strict";n.d(t,{v:function(){return ToneWithContext}});var i=n(7797),s=n(6346),r=n(6407),o=n(8609),a=n(573),l=n(988),u=n(1626);let ToneWithContext=class ToneWithContext extends s.d{constructor(){super();let e=(0,l.Y9)(ToneWithContext.getDefaults(),arguments,["context"]);this.defaultContext?this.context=this.defaultContext:this.context=e.context}static getDefaults(){return{context:(0,i.fw)()}}now(){return this.context.currentTime+this.context.lookAhead}immediate(){return this.context.currentTime}get sampleTime(){return 1/this.context.sampleRate}get blockTime(){return 128/this.context.sampleRate}toSeconds(e){return new o.A(this.context,e).toSeconds()}toFrequency(e){return new r.W(this.context,e).toFrequency()}toTicks(e){return new a.w(this.context,e).toTicks()}_getPartialProperties(e){let t=this.get();return Object.keys(t).forEach(n=>{(0,u.G7)(e[n])&&delete t[n]}),t}get(){let e=(0,l.W0)(this);return Object.keys(e).forEach(t=>{if(Reflect.has(this,t)){let n=this[t];(0,u.$K)(n)&&(0,u.$K)(n.value)&&(0,u.$K)(n.setValueAtTime)?e[t]=n.value:n instanceof ToneWithContext?e[t]=n._getPartialProperties(e[t]):(0,u.kJ)(n)||(0,u.hj)(n)||(0,u.HD)(n)||(0,u.jn)(n)?e[t]=n:delete e[t]}}),e}set(e){return Object.keys(e).forEach(t=>{Reflect.has(this,t)&&(0,u.$K)(this[t])&&(this[t]&&(0,u.$K)(this[t].value)&&(0,u.$K)(this[t].setValueAtTime)?this[t].value!==e[t]&&(this[t].value=e[t]):this[t]instanceof ToneWithContext?this[t].set(e[t]):this[t]=e[t])}),this}}},1205:function(e,t,n){"use strict";function dbToGain(e){return Math.pow(10,e/20)}function gainToDb(e){return 20*(Math.log(e)/Math.LN10)}function intervalToFrequencyRatio(e){return Math.pow(2,e/12)}n.d(t,{GB:function(){return ftom},H2:function(){return gainToDb},IF:function(){return mtof},Im:function(){return intervalToFrequencyRatio},_0:function(){return ftomf},_J:function(){return getA4},r:function(){return setA4},xz:function(){return dbToGain}});let i=440;function getA4(){return i}function setA4(e){i=e}function ftom(e){return Math.round(ftomf(e))}function ftomf(e){return 69+12*Math.log2(e/i)}function mtof(e){return i*Math.pow(2,(e-69)/12)}},6407:function(e,t,n){"use strict";n.d(t,{D:function(){return Frequency},W:function(){return FrequencyClass}});var i=n(7797),s=n(1205),r=n(8609);let FrequencyClass=class FrequencyClass extends r.A{constructor(){super(...arguments),this.name="Frequency",this.defaultUnits="hz"}static get A4(){return(0,s._J)()}static set A4(e){(0,s.r)(e)}_getExpressions(){return Object.assign({},super._getExpressions(),{midi:{regexp:/^(\d+(?:\.\d+)?midi)/,method(e){return"midi"===this.defaultUnits?e:FrequencyClass.mtof(e)}},note:{regexp:/^([a-g]{1}(?:b|#|x|bb)?)(-?[0-9]+)/i,method(e,t){let n=o[e.toLowerCase()],i=n+(parseInt(t,10)+1)*12;return"midi"===this.defaultUnits?i:FrequencyClass.mtof(i)}},tr:{regexp:/^(\d+(?:\.\d+)?):(\d+(?:\.\d+)?):?(\d+(?:\.\d+)?)?/,method(e,t,n){let i=1;return e&&"0"!==e&&(i*=this._beatsToUnits(this._getTimeSignature()*parseFloat(e))),t&&"0"!==t&&(i*=this._beatsToUnits(parseFloat(t))),n&&"0"!==n&&(i*=this._beatsToUnits(parseFloat(n)/4)),i}}})}transpose(e){return new FrequencyClass(this.context,this.valueOf()*(0,s.Im)(e))}harmonize(e){return e.map(e=>this.transpose(e))}toMidi(){return(0,s.GB)(this.valueOf())}toNote(){let e=this.toFrequency(),t=Math.log2(e/FrequencyClass.A4),n=Math.round(12*t)+57,i=Math.floor(n/12);i<0&&(n+=-12*i);let s=a[n%12];return s+i.toString()}toSeconds(){return 1/super.toSeconds()}toTicks(){let e=this._beatsToUnits(1),t=this.valueOf()/e;return Math.floor(t*this._getPPQ())}_noArg(){return 0}_frequencyToUnits(e){return e}_ticksToUnits(e){return 1/(60*e/(this._getBpm()*this._getPPQ()))}_beatsToUnits(e){return 1/super._beatsToUnits(e)}_secondsToUnits(e){return 1/e}static mtof(e){return(0,s.IF)(e)}static ftom(e){return(0,s.GB)(e)}};let o={cbb:-2,cb:-1,c:0,"c#":1,cx:2,dbb:0,db:1,d:2,"d#":3,dx:4,ebb:2,eb:3,e:4,"e#":5,ex:6,fbb:3,fb:4,f:5,"f#":6,fx:7,gbb:5,gb:6,g:7,"g#":8,gx:9,abb:7,ab:8,a:9,"a#":10,ax:11,bbb:9,bb:10,b:11,"b#":12,bx:13},a=["C","C#","D","D#","E","F","F#","G","G#","A","A#","B"];function Frequency(e,t){return new FrequencyClass((0,i.fw)(),e,t)}},8609:function(e,t,n){"use strict";n.d(t,{A:function(){return TimeClass}}),n(7797);var i=n(1205),s=n(6346),r=n(1626);let TimeBaseClass=class TimeBaseClass extends s.d{constructor(e,t,n){super(),this.defaultUnits="s",this._val=t,this._units=n,this.context=e,this._expressions=this._getExpressions()}_getExpressions(){return{hz:{method:e=>this._frequencyToUnits(parseFloat(e)),regexp:/^(\d+(?:\.\d+)?)hz$/i},i:{method:e=>this._ticksToUnits(parseInt(e,10)),regexp:/^(\d+)i$/i},m:{method:e=>this._beatsToUnits(parseInt(e,10)*this._getTimeSignature()),regexp:/^(\d+)m$/i},n:{method:(e,t)=>{let n=parseInt(e,10),i="."===t?1.5:1;return 1===n?this._beatsToUnits(this._getTimeSignature())*i:this._beatsToUnits(4/n)*i},regexp:/^(\d+)n(\.?)$/i},number:{method:e=>this._expressions[this.defaultUnits].method.call(this,e),regexp:/^(\d+(?:\.\d+)?)$/},s:{method:e=>this._secondsToUnits(parseFloat(e)),regexp:/^(\d+(?:\.\d+)?)s$/},samples:{method:e=>parseInt(e,10)/this.context.sampleRate,regexp:/^(\d+)samples$/},t:{method:e=>{let t=parseInt(e,10);return this._beatsToUnits(8/(3*Math.floor(t)))},regexp:/^(\d+)t$/i},tr:{method:(e,t,n)=>{let i=0;return e&&"0"!==e&&(i+=this._beatsToUnits(this._getTimeSignature()*parseFloat(e))),t&&"0"!==t&&(i+=this._beatsToUnits(parseFloat(t))),n&&"0"!==n&&(i+=this._beatsToUnits(parseFloat(n)/4)),i},regexp:/^(\d+(?:\.\d+)?):(\d+(?:\.\d+)?):?(\d+(?:\.\d+)?)?$/}}}valueOf(){if(this._val instanceof TimeBaseClass&&this.fromType(this._val),(0,r.G7)(this._val))return this._noArg();if((0,r.HD)(this._val)&&(0,r.G7)(this._units)){for(let e in this._expressions)if(this._expressions[e].regexp.test(this._val.trim())){this._units=e;break}}else if((0,r.Kn)(this._val)){let e=0;for(let t in this._val)if((0,r.$K)(this._val[t])){let n=this._val[t],i=new this.constructor(this.context,t).valueOf()*n;e+=i}return e}if((0,r.$K)(this._units)){let e=this._expressions[this._units],t=this._val.toString().trim().match(e.regexp);return t?e.method.apply(this,t.slice(1)):e.method.call(this,this._val)}return(0,r.HD)(this._val)?parseFloat(this._val):this._val}_frequencyToUnits(e){return 1/e}_beatsToUnits(e){return 60/this._getBpm()*e}_secondsToUnits(e){return e}_ticksToUnits(e){return e*this._beatsToUnits(1)/this._getPPQ()}_noArg(){return this._now()}_getBpm(){return this.context.transport.bpm.value}_getTimeSignature(){return this.context.transport.timeSignature}_getPPQ(){return this.context.transport.PPQ}fromType(e){switch(this._units=void 0,this.defaultUnits){case"s":this._val=e.toSeconds();break;case"i":this._val=e.toTicks();break;case"hz":this._val=e.toFrequency();break;case"midi":this._val=e.toMidi()}return this}toFrequency(){return 1/this.toSeconds()}toSamples(){return this.toSeconds()*this.context.sampleRate}toMilliseconds(){return 1e3*this.toSeconds()}};let TimeClass=class TimeClass extends TimeBaseClass{constructor(){super(...arguments),this.name="TimeClass"}_getExpressions(){return Object.assign(super._getExpressions(),{now:{method:e=>this._now()+new this.constructor(this.context,e).valueOf(),regexp:/^\+(.+)/},quantize:{method:e=>{let t=new TimeClass(this.context,e).valueOf();return this._secondsToUnits(this.context.transport.nextSubdivision(t))},regexp:/^@(.+)/}})}quantize(e,t=1){let n=new this.constructor(this.context,e).valueOf(),i=this.valueOf();return i+(Math.round(i/n)*n-i)*t}toNotation(){let e=this.toSeconds(),t=["1m"];for(let e=1;e<9;e++){let n=Math.pow(2,e);t.push(n+"n."),t.push(n+"n"),t.push(n+"t")}t.push("0");let n=t[0],i=new TimeClass(this.context,t[0]).toSeconds();return t.forEach(t=>{let s=new TimeClass(this.context,t).toSeconds();Math.abs(s-e)<Math.abs(i-e)&&(n=t,i=s)}),n}toBarsBeatsSixteenths(){let e=this._beatsToUnits(1),t=this.valueOf()/e;t=parseFloat(t.toFixed(4));let n=Math.floor(t/this._getTimeSignature()),i=t%1*4;t=Math.floor(t)%this._getTimeSignature();let s=i.toString();s.length>3&&(i=parseFloat(parseFloat(s).toFixed(3)));let r=[n,t,i];return r.join(":")}toTicks(){let e=this._beatsToUnits(1),t=this.valueOf()/e;return Math.round(t*this._getPPQ())}toSeconds(){return this.valueOf()}toMidi(){return(0,i.GB)(this.toFrequency())}_now(){return this.context.now()}}},573:function(e,t,n){"use strict";n.d(t,{w:function(){return TransportTimeClass}}),n(7797);var i=n(8609);let TransportTimeClass=class TransportTimeClass extends i.A{constructor(){super(...arguments),this.name="TransportTime"}_now(){return this.context.transport.seconds}}},125:function(e,t,n){"use strict";n.d(t,{$n:function(){return isAudioParam},Ls:function(){return isOfflineAudioContext},MS:function(){return isAudioBuffer},ge:function(){return isAudioContext},kU:function(){return isAudioNode}});var i=n(5348);function isAudioParam(e){return(0,i.Qz)(e)}function isAudioNode(e){return(0,i.D2)(e)}function isOfflineAudioContext(e){return(0,i.km)(e)}function isAudioContext(e){return(0,i.E_)(e)}function isAudioBuffer(e){return e instanceof AudioBuffer}},9277:function(e,t,n){"use strict";function assert(e,t){if(!e)throw Error(t)}function assertRange(e,t,n=1/0){if(!(t<=e&&e<=n))throw RangeError(`Value must be within [${t}, ${n}], got: ${e}`)}function assertContextRunning(e){e.isOffline||"running"===e.state||warn('The AudioContext is "suspended". Invoke Tone.start() from a user action to start the audio.')}n.d(t,{Ms:function(){return assertContextRunning},ZK:function(){return warn},cM:function(){return log},gI:function(){return assertRange},hu:function(){return assert}});let i=console;function log(...e){i.log(...e)}function warn(...e){i.warn(...e)}},988:function(e,t,n){"use strict";n.d(t,{PK:function(){return defaultArg},RH:function(){return deepMerge},W0:function(){return getDefaultsFromInstance},Y9:function(){return optionsFromArguments},nS:function(){return omitFromObject},qt:function(){return deepEquals}});var i=n(125),s=n(1626);function deepMerge(e,...t){if(!t.length)return e;let n=t.shift();if((0,s.Kn)(e)&&(0,s.Kn)(n))for(let t in n){var r;(r=n[t],"value"===t||(0,i.$n)(r)||(0,i.kU)(r)||(0,i.MS)(r))?e[t]=n[t]:(0,s.Kn)(n[t])?(e[t]||Object.assign(e,{[t]:{}}),deepMerge(e[t],n[t])):Object.assign(e,{[t]:n[t]})}return deepMerge(e,...t)}function deepEquals(e,t){return e.length===t.length&&e.every((e,n)=>t[n]===e)}function optionsFromArguments(e,t,n=[],i){let r={},o=Array.from(t);if((0,s.Kn)(o[0])&&i&&!Reflect.has(o[0],i)){let t=Object.keys(o[0]).some(t=>Reflect.has(e,t));t||(deepMerge(r,{[i]:o[0]}),n.splice(n.indexOf(i),1),o.shift())}if(1===o.length&&(0,s.Kn)(o[0]))deepMerge(r,o[0]);else for(let e=0;e<n.length;e++)(0,s.$K)(o[e])&&(r[n[e]]=o[e]);return deepMerge(e,r)}function getDefaultsFromInstance(e){return e.constructor.getDefaults()}function defaultArg(e,t){return(0,s.G7)(e)?t:e}function omitFromObject(e,t){return t.forEach(t=>{Reflect.has(e,t)&&delete e[t]}),e}},1250:function(e,t,n){"use strict";n.d(t,{Q:function(){return Emitter}});var i=n(6346),s=n(1626);let Emitter=class Emitter extends i.d{constructor(){super(...arguments),this.name="Emitter"}on(e,t){let n=e.split(/\W+/);return n.forEach(e=>{(0,s.G7)(this._events)&&(this._events={}),this._events.hasOwnProperty(e)||(this._events[e]=[]),this._events[e].push(t)}),this}once(e,t){let boundCallback=(...n)=>{t(...n),this.off(e,boundCallback)};return this.on(e,boundCallback),this}off(e,t){let n=e.split(/\W+/);return n.forEach(n=>{if((0,s.G7)(this._events)&&(this._events={}),this._events.hasOwnProperty(e)){if((0,s.G7)(t))this._events[e]=[];else{let n=this._events[e];for(let e=n.length-1;e>=0;e--)n[e]===t&&n.splice(e,1)}}}),this}emit(e,...t){if(this._events&&this._events.hasOwnProperty(e)){let n=this._events[e].slice(0);for(let e=0,i=n.length;e<i;e++)n[e].apply(this,t)}return this}static mixin(e){["on","once","off","emit"].forEach(t=>{let n=Object.getOwnPropertyDescriptor(Emitter.prototype,t);Object.defineProperty(e.prototype,t,n)})}dispose(){return super.dispose(),this._events=void 0,this}}},8886:function(e,t,n){"use strict";n.d(t,{EI:function(){return noOp},fZ:function(){return function writable(e,t){(0,i.kJ)(t)?t.forEach(t=>writable(e,t)):Object.defineProperty(e,t,{writable:!0})}},qt:function(){return function readOnly(e,t){(0,i.kJ)(t)?t.forEach(t=>readOnly(e,t)):Object.defineProperty(e,t,{enumerable:!0,writable:!1})}}});var i=n(1626);let noOp=()=>{}},2140:function(e,t,n){"use strict";function GT(e,t){return e>t+1e-6}function GTE(e,t){return GT(e,t)||EQ(e,t)}function LT(e,t){return e+1e-6<t}function EQ(e,t){return 1e-6>Math.abs(e-t)}function clamp(e,t,n){return Math.max(Math.min(e,n),t)}n.d(t,{EQ:function(){return EQ},GT:function(){return GT},LT:function(){return LT},u:function(){return clamp},x:function(){return GTE}})},6371:function(e,t,n){"use strict";n.d(t,{T:function(){return Timeline}});var i=n(6346),s=n(988),r=n(9277),o=n(2140);let Timeline=class Timeline extends i.d{constructor(){super(),this.name="Timeline",this._timeline=[];let e=(0,s.Y9)(Timeline.getDefaults(),arguments,["memory"]);this.memory=e.memory,this.increasing=e.increasing}static getDefaults(){return{memory:1/0,increasing:!1}}get length(){return this._timeline.length}add(e){if((0,r.hu)(Reflect.has(e,"time"),"Timeline: events must have a time attribute"),e.time=e.time.valueOf(),this.increasing&&this.length){let t=this._timeline[this.length-1];(0,r.hu)((0,o.x)(e.time,t.time),"The time must be greater than or equal to the last scheduled time"),this._timeline.push(e)}else{let t=this._search(e.time);this._timeline.splice(t+1,0,e)}if(this.length>this.memory){let e=this.length-this.memory;this._timeline.splice(0,e)}return this}remove(e){let t=this._timeline.indexOf(e);return -1!==t&&this._timeline.splice(t,1),this}get(e,t="time"){let n=this._search(e,t);return -1!==n?this._timeline[n]:null}peek(){return this._timeline[0]}shift(){return this._timeline.shift()}getAfter(e,t="time"){let n=this._search(e,t);return n+1<this._timeline.length?this._timeline[n+1]:null}getBefore(e){let t=this._timeline.length;if(t>0&&this._timeline[t-1].time<e)return this._timeline[t-1];let n=this._search(e);return n-1>=0?this._timeline[n-1]:null}cancel(e){if(this._timeline.length>1){let t=this._search(e);if(t>=0){if((0,o.EQ)(this._timeline[t].time,e)){for(let n=t;n>=0;n--)if((0,o.EQ)(this._timeline[n].time,e))t=n;else break;this._timeline=this._timeline.slice(0,t)}else this._timeline=this._timeline.slice(0,t+1)}else this._timeline=[]}else 1===this._timeline.length&&(0,o.x)(this._timeline[0].time,e)&&(this._timeline=[]);return this}cancelBefore(e){let t=this._search(e);return t>=0&&(this._timeline=this._timeline.slice(t+1)),this}previousEvent(e){let t=this._timeline.indexOf(e);return t>0?this._timeline[t-1]:null}_search(e,t="time"){if(0===this._timeline.length)return -1;let n=0,i=this._timeline.length,s=i;if(i>0&&this._timeline[i-1][t]<=e)return i-1;for(;n<s;){let i=Math.floor(n+(s-n)/2),r=this._timeline[i],a=this._timeline[i+1];if((0,o.EQ)(r[t],e)){for(let n=i;n<this._timeline.length;n++){let s=this._timeline[n];if((0,o.EQ)(s[t],e))i=n;else break}return i}if((0,o.LT)(r[t],e)&&(0,o.GT)(a[t],e))return i;(0,o.GT)(r[t],e)?s=i:n=i+1}return -1}_iterate(e,t=0,n=this._timeline.length-1){this._timeline.slice(t,n+1).forEach(e)}forEach(e){return this._iterate(e),this}forEachBefore(e,t){let n=this._search(e);return -1!==n&&this._iterate(t,0,n),this}forEachAfter(e,t){let n=this._search(e);return this._iterate(t,n+1),this}forEachBetween(e,t,n){let i=this._search(e),s=this._search(t);return -1!==i&&-1!==s?(this._timeline[i].time!==e&&(i+=1),this._timeline[s].time===t&&(s-=1),this._iterate(n,i,s)):-1===i&&this._iterate(n,0,s),this}forEachFrom(e,t){let n=this._search(e);for(;n>=0&&this._timeline[n].time>=e;)n--;return this._iterate(t,n+1),this}forEachAtTime(e,t){let n=this._search(e);if(-1!==n&&(0,o.EQ)(this._timeline[n].time,e)){let i=n;for(let t=n;t>=0;t--)if((0,o.EQ)(this._timeline[t].time,e))i=t;else break;this._iterate(e=>{t(e)},i,n)}return this}dispose(){return super.dispose(),this._timeline=[],this}}},1626:function(e,t,n){"use strict";function isUndef(e){return void 0===e}function isDefined(e){return!isUndef(e)}function isFunction(e){return"function"==typeof e}function isNumber(e){return"number"==typeof e}function isObject(e){return"[object Object]"===Object.prototype.toString.call(e)&&e.constructor===Object}function isBoolean(e){return"boolean"==typeof e}function isArray(e){return Array.isArray(e)}function isString(e){return"string"==typeof e}function isNote(e){return isString(e)&&/^([a-g]{1}(?:b|#|x|bb)?)(-?[0-9]+)/i.test(e)}n.d(t,{$K:function(){return isDefined},G7:function(){return isUndef},HD:function(){return isString},Kn:function(){return isObject},gi:function(){return isNote},hj:function(){return isNumber},jn:function(){return isBoolean},kJ:function(){return isArray},mf:function(){return isFunction}})},7707:function(e,t,n){"use strict";n.d(t,{MH:function(){return BitCrusher},bK:function(){return Chorus},Sh:function(){return Convolver},o6:function(){return B},df:function(){return Distortion},vw:function(){return FFT},wm:function(){return FeedbackDelay},Di:function(){return A.D},WO:function(){return A.W},S9:function(){return f.S},fv:function(){return Mono},yW:function(){return PitchShift},E8:function(){return Reverb},Z4:function(){return Sampler},Xv:function(){return UserMedia},ff:function(){return C.f},Do:function(){return W},BL:function(){return i.BL}});var i=n(7797),s=n(7470),r=n(988),o=n(1250),a=n(8886),l=n(6371),u=n(9277);let StateTimeline_StateTimeline=class StateTimeline_StateTimeline extends l.T{constructor(e="stopped"){super(),this.name="StateTimeline",this._initial=e,this.setStateAtTime(this._initial,0)}getValueAtTime(e){let t=this.get(e);return null!==t?t.state:this._initial}setStateAtTime(e,t,n){return(0,u.gI)(t,0),this.add(Object.assign({},n,{state:e,time:t})),this}getLastState(e,t){let n=this._search(t);for(let t=n;t>=0;t--){let n=this._timeline[t];if(n.state===e)return n}}getNextState(e,t){let n=this._search(t);if(-1!==n)for(let t=n;t<this._timeline.length;t++){let n=this._timeline[t];if(n.state===e)return n}}};var c=n(1626),h=n(5055),d=n(1957),p=n(125),f=n(689);let OneShotSource=class OneShotSource extends d.HD{constructor(e){super(e),this.onended=a.EI,this._startTime=-1,this._stopTime=-1,this._timeout=-1,this.output=new f.S({context:this.context,gain:0}),this._gainNode=this.output,this.getStateAtTime=function(e){let t=this.toSeconds(e);return -1!==this._startTime&&t>=this._startTime&&(-1===this._stopTime||t<=this._stopTime)?"started":"stopped"},this._fadeIn=e.fadeIn,this._fadeOut=e.fadeOut,this._curve=e.curve,this.onended=e.onended}static getDefaults(){return Object.assign(d.HD.getDefaults(),{curve:"linear",fadeIn:0,fadeOut:0,onended:a.EI})}_startGain(e,t=1){(0,u.hu)(-1===this._startTime,"Source cannot be started more than once");let n=this.toSeconds(this._fadeIn);return this._startTime=e+n,this._startTime=Math.max(this._startTime,this.context.currentTime),n>0?(this._gainNode.gain.setValueAtTime(0,e),"linear"===this._curve?this._gainNode.gain.linearRampToValueAtTime(t,e+n):this._gainNode.gain.exponentialApproachValueAtTime(t,e,n)):this._gainNode.gain.setValueAtTime(t,e),this}stop(e){return this.log("stop",e),this._stopGain(this.toSeconds(e)),this}_stopGain(e){(0,u.hu)(-1!==this._startTime,"'start' must be called before 'stop'"),this.cancelStop();let t=this.toSeconds(this._fadeOut);return this._stopTime=this.toSeconds(e)+t,this._stopTime=Math.max(this._stopTime,this.context.currentTime),t>0?"linear"===this._curve?this._gainNode.gain.linearRampTo(0,t,e):this._gainNode.gain.targetRampTo(0,t,e):(this._gainNode.gain.cancelAndHoldAtTime(e),this._gainNode.gain.setValueAtTime(0,e)),this.context.clearTimeout(this._timeout),this._timeout=this.context.setTimeout(()=>{let e="exponential"===this._curve?2*t:0;this._stopSource(this.now()+e),this._onended()},this._stopTime-this.context.currentTime),this}_onended(){if(this.onended!==a.EI&&(this.onended(this),this.onended=a.EI,!this.context.isOffline)){let disposeCallback=()=>this.dispose();void 0!==window.requestIdleCallback?window.requestIdleCallback(disposeCallback):setTimeout(disposeCallback,1e3)}}get state(){return this.getStateAtTime(this.now())}cancelStop(){return this.log("cancelStop"),(0,u.hu)(-1!==this._startTime,"Source is not started"),this._gainNode.gain.cancelScheduledValues(this._startTime+this.sampleTime),this.context.clearTimeout(this._timeout),this._stopTime=-1,this}dispose(){return super.dispose(),this._gainNode.disconnect(),this}};let ToneConstantSource_ToneConstantSource=class ToneConstantSource_ToneConstantSource extends OneShotSource{constructor(){super((0,r.Y9)(ToneConstantSource_ToneConstantSource.getDefaults(),arguments,["offset"])),this.name="ToneConstantSource",this._source=this.context.createConstantSource();let e=(0,r.Y9)(ToneConstantSource_ToneConstantSource.getDefaults(),arguments,["offset"]);(0,d.$j)(this._source,this._gainNode),this.offset=new h.d({context:this.context,convert:e.convert,param:this._source.offset,units:e.units,value:e.offset,minValue:e.minValue,maxValue:e.maxValue})}static getDefaults(){return Object.assign(OneShotSource.getDefaults(),{convert:!0,offset:1,units:"number"})}start(e){let t=this.toSeconds(e);return this.log("start",t),this._startGain(t),this._source.start(t),this}_stopSource(e){this._source.stop(e)}dispose(){return super.dispose(),"started"===this.state&&this.stop(),this._source.disconnect(),this.offset.dispose(),this}};let Signal_Signal=class Signal_Signal extends d.HD{constructor(){super((0,r.Y9)(Signal_Signal.getDefaults(),arguments,["value","units"])),this.name="Signal",this.override=!0;let e=(0,r.Y9)(Signal_Signal.getDefaults(),arguments,["value","units"]);this.output=this._constantSource=new ToneConstantSource_ToneConstantSource({context:this.context,convert:e.convert,offset:e.value,units:e.units,minValue:e.minValue,maxValue:e.maxValue}),this._constantSource.start(0),this.input=this._param=this._constantSource.offset}static getDefaults(){return Object.assign(d.HD.getDefaults(),{convert:!0,units:"number",value:0})}connect(e,t=0,n=0){return connectSignal(this,e,t,n),this}dispose(){return super.dispose(),this._param.dispose(),this._constantSource.dispose(),this}setValueAtTime(e,t){return this._param.setValueAtTime(e,t),this}getValueAtTime(e){return this._param.getValueAtTime(e)}setRampPoint(e){return this._param.setRampPoint(e),this}linearRampToValueAtTime(e,t){return this._param.linearRampToValueAtTime(e,t),this}exponentialRampToValueAtTime(e,t){return this._param.exponentialRampToValueAtTime(e,t),this}exponentialRampTo(e,t,n){return this._param.exponentialRampTo(e,t,n),this}linearRampTo(e,t,n){return this._param.linearRampTo(e,t,n),this}targetRampTo(e,t,n){return this._param.targetRampTo(e,t,n),this}exponentialApproachValueAtTime(e,t,n){return this._param.exponentialApproachValueAtTime(e,t,n),this}setTargetAtTime(e,t,n){return this._param.setTargetAtTime(e,t,n),this}setValueCurveAtTime(e,t,n,i){return this._param.setValueCurveAtTime(e,t,n,i),this}cancelScheduledValues(e){return this._param.cancelScheduledValues(e),this}cancelAndHoldAtTime(e){return this._param.cancelAndHoldAtTime(e),this}rampTo(e,t,n){return this._param.rampTo(e,t,n),this}get value(){return this._param.value}set value(e){this._param.value=e}get convert(){return this._param.convert}set convert(e){this._param.convert=e}get units(){return this._param.units}get overridden(){return this._param.overridden}set overridden(e){this._param.overridden=e}get maxValue(){return this._param.maxValue}get minValue(){return this._param.minValue}apply(e){return this._param.apply(e),this}};function connectSignal(e,t,n,i){(t instanceof h.d||(0,p.$n)(t)||t instanceof Signal_Signal&&t.override)&&(t.cancelScheduledValues(0),t.setValueAtTime(0,0),t instanceof Signal_Signal&&(t.overridden=!0)),(0,d.$j)(e,t,n,i)}let TickParam=class TickParam extends h.d{constructor(){super((0,r.Y9)(TickParam.getDefaults(),arguments,["value"])),this.name="TickParam",this._events=new l.T(1/0),this._multiplier=1;let e=(0,r.Y9)(TickParam.getDefaults(),arguments,["value"]);this._multiplier=e.multiplier,this._events.cancel(0),this._events.add({ticks:0,time:0,type:"setValueAtTime",value:this._fromType(e.value)}),this.setValueAtTime(e.value,0)}static getDefaults(){return Object.assign(h.d.getDefaults(),{multiplier:1,units:"hertz",value:1})}setTargetAtTime(e,t,n){t=this.toSeconds(t),this.setRampPoint(t);let i=this._fromType(e),s=this._events.get(t),r=Math.round(Math.max(1/n,1));for(let e=0;e<=r;e++){let r=n*e+t,o=this._exponentialApproach(s.time,s.value,i,n,r);this.linearRampToValueAtTime(this._toType(o),r)}return this}setValueAtTime(e,t){let n=this.toSeconds(t);super.setValueAtTime(e,t);let i=this._events.get(n),s=this._events.previousEvent(i),r=this._getTicksUntilEvent(s,n);return i.ticks=Math.max(r,0),this}linearRampToValueAtTime(e,t){let n=this.toSeconds(t);super.linearRampToValueAtTime(e,t);let i=this._events.get(n),s=this._events.previousEvent(i),r=this._getTicksUntilEvent(s,n);return i.ticks=Math.max(r,0),this}exponentialRampToValueAtTime(e,t){t=this.toSeconds(t);let n=this._fromType(e),i=this._events.get(t),s=Math.round(Math.max((t-i.time)*10,1)),r=(t-i.time)/s;for(let e=0;e<=s;e++){let s=r*e+i.time,o=this._exponentialInterpolate(i.time,i.value,t,n,s);this.linearRampToValueAtTime(this._toType(o),s)}return this}_getTicksUntilEvent(e,t){if(null===e)e={ticks:0,time:0,type:"setValueAtTime",value:0};else if((0,c.G7)(e.ticks)){let t=this._events.previousEvent(e);e.ticks=this._getTicksUntilEvent(t,e.time)}let n=this._fromType(this.getValueAtTime(e.time)),i=this._fromType(this.getValueAtTime(t)),s=this._events.get(t);return s&&s.time===t&&"setValueAtTime"===s.type&&(i=this._fromType(this.getValueAtTime(t-this.sampleTime))),.5*(t-e.time)*(n+i)+e.ticks}getTicksAtTime(e){let t=this.toSeconds(e),n=this._events.get(t);return Math.max(this._getTicksUntilEvent(n,t),0)}getDurationOfTicks(e,t){let n=this.toSeconds(t),i=this.getTicksAtTime(t);return this.getTimeOfTick(i+e)-n}getTimeOfTick(e){let t=this._events.get(e,"ticks"),n=this._events.getAfter(e,"ticks");if(t&&t.ticks===e)return t.time;if(t&&n&&"linearRampToValueAtTime"===n.type&&t.value!==n.value){let i=this._fromType(this.getValueAtTime(t.time)),s=this._fromType(this.getValueAtTime(n.time)),r=(s-i)/(n.time-t.time),o=Math.sqrt(Math.pow(i,2)-2*r*(t.ticks-e)),a=(-i+o)/r;return(a>0?a:(-i-o)/r)+t.time}return t?0===t.value?1/0:t.time+(e-t.ticks)/t.value:e/this._initialValue}ticksToTime(e,t){return this.getDurationOfTicks(e,t)}timeToTicks(e,t){let n=this.toSeconds(t),i=this.toSeconds(e),s=this.getTicksAtTime(n),r=this.getTicksAtTime(n+i);return r-s}_fromType(e){return"bpm"===this.units&&this.multiplier?1/(60/e/this.multiplier):super._fromType(e)}_toType(e){return"bpm"===this.units&&this.multiplier?e/this.multiplier*60:super._toType(e)}get multiplier(){return this._multiplier}set multiplier(e){let t=this.value;this._multiplier=e,this.cancelScheduledValues(0),this.setValueAtTime(t,0)}};let TickSignal=class TickSignal extends Signal_Signal{constructor(){super((0,r.Y9)(TickSignal.getDefaults(),arguments,["value"])),this.name="TickSignal";let e=(0,r.Y9)(TickSignal.getDefaults(),arguments,["value"]);this.input=this._param=new TickParam({context:this.context,convert:e.convert,multiplier:e.multiplier,param:this._constantSource.offset,units:e.units,value:e.value})}static getDefaults(){return Object.assign(Signal_Signal.getDefaults(),{multiplier:1,units:"hertz",value:1})}ticksToTime(e,t){return this._param.ticksToTime(e,t)}timeToTicks(e,t){return this._param.timeToTicks(e,t)}getTimeOfTick(e){return this._param.getTimeOfTick(e)}getDurationOfTicks(e,t){return this._param.getDurationOfTicks(e,t)}getTicksAtTime(e){return this._param.getTicksAtTime(e)}get multiplier(){return this._param.multiplier}set multiplier(e){this._param.multiplier=e}dispose(){return super.dispose(),this._param.dispose(),this}};var m=n(2140);let TickSource=class TickSource extends s.v{constructor(){super((0,r.Y9)(TickSource.getDefaults(),arguments,["frequency"])),this.name="TickSource",this._state=new StateTimeline_StateTimeline,this._tickOffset=new l.T;let e=(0,r.Y9)(TickSource.getDefaults(),arguments,["frequency"]);this.frequency=new TickSignal({context:this.context,units:e.units,value:e.frequency}),(0,a.qt)(this,"frequency"),this._state.setStateAtTime("stopped",0),this.setTicksAtTime(0,0)}static getDefaults(){return Object.assign({frequency:1,units:"hertz"},s.v.getDefaults())}get state(){return this.getStateAtTime(this.now())}start(e,t){let n=this.toSeconds(e);return"started"!==this._state.getValueAtTime(n)&&(this._state.setStateAtTime("started",n),(0,c.$K)(t)&&this.setTicksAtTime(t,n)),this}stop(e){let t=this.toSeconds(e);if("stopped"===this._state.getValueAtTime(t)){let e=this._state.get(t);e&&e.time>0&&(this._tickOffset.cancel(e.time),this._state.cancel(e.time))}return this._state.cancel(t),this._state.setStateAtTime("stopped",t),this.setTicksAtTime(0,t),this}pause(e){let t=this.toSeconds(e);return"started"===this._state.getValueAtTime(t)&&this._state.setStateAtTime("paused",t),this}cancel(e){return e=this.toSeconds(e),this._state.cancel(e),this._tickOffset.cancel(e),this}getTicksAtTime(e){let t=this.toSeconds(e),n=this._state.getLastState("stopped",t),i={state:"paused",time:t};this._state.add(i);let s=n,r=0;return this._state.forEachBetween(n.time,t+this.sampleTime,e=>{let t=s.time,n=this._tickOffset.get(e.time);n&&n.time>=s.time&&(r=n.ticks,t=n.time),"started"===s.state&&"started"!==e.state&&(r+=this.frequency.getTicksAtTime(e.time)-this.frequency.getTicksAtTime(t)),s=e}),this._state.remove(i),r}get ticks(){return this.getTicksAtTime(this.now())}set ticks(e){this.setTicksAtTime(e,this.now())}get seconds(){return this.getSecondsAtTime(this.now())}set seconds(e){let t=this.now(),n=this.frequency.timeToTicks(e,t);this.setTicksAtTime(n,t)}getSecondsAtTime(e){e=this.toSeconds(e);let t=this._state.getLastState("stopped",e),n={state:"paused",time:e};this._state.add(n);let i=t,s=0;return this._state.forEachBetween(t.time,e+this.sampleTime,e=>{let t=i.time,n=this._tickOffset.get(e.time);n&&n.time>=i.time&&(s=n.seconds,t=n.time),"started"===i.state&&"started"!==e.state&&(s+=e.time-t),i=e}),this._state.remove(n),s}setTicksAtTime(e,t){return t=this.toSeconds(t),this._tickOffset.cancel(t),this._tickOffset.add({seconds:this.frequency.getDurationOfTicks(e,t),ticks:e,time:t}),this}getStateAtTime(e){return e=this.toSeconds(e),this._state.getValueAtTime(e)}getTimeOfTick(e,t=this.now()){let n=this._tickOffset.get(t),i=this._state.get(t),s=Math.max(n.time,i.time),r=this.frequency.getTicksAtTime(s)+e-n.ticks;return this.frequency.getTimeOfTick(r)}forEachTickBetween(e,t,n){let i=this._state.get(e);this._state.forEachBetween(e,t,t=>{i&&"started"===i.state&&"started"!==t.state&&this.forEachTickBetween(Math.max(i.time,e),t.time-this.sampleTime,n),i=t});let s=null;if(i&&"started"===i.state){let r=Math.max(i.time,e),o=this.frequency.getTicksAtTime(r),a=this.frequency.getTicksAtTime(i.time),l=o-a,u=Math.ceil(l)-l;u=(0,m.EQ)(u,1)?0:u;let c=this.frequency.getTimeOfTick(o+u);for(;c<t;){try{n(c,Math.round(this.getTicksAtTime(c)))}catch(e){s=e;break}c+=this.frequency.getDurationOfTicks(1,c)}}if(s)throw s;return this}dispose(){return super.dispose(),this._state.dispose(),this._tickOffset.dispose(),this.frequency.dispose(),this}};let Clock_Clock=class Clock_Clock extends s.v{constructor(){super((0,r.Y9)(Clock_Clock.getDefaults(),arguments,["callback","frequency"])),this.name="Clock",this.callback=a.EI,this._lastUpdate=0,this._state=new StateTimeline_StateTimeline("stopped"),this._boundLoop=this._loop.bind(this);let e=(0,r.Y9)(Clock_Clock.getDefaults(),arguments,["callback","frequency"]);this.callback=e.callback,this._tickSource=new TickSource({context:this.context,frequency:e.frequency,units:e.units}),this._lastUpdate=0,this.frequency=this._tickSource.frequency,(0,a.qt)(this,"frequency"),this._state.setStateAtTime("stopped",0),this.context.on("tick",this._boundLoop)}static getDefaults(){return Object.assign(s.v.getDefaults(),{callback:a.EI,frequency:1,units:"hertz"})}get state(){return this._state.getValueAtTime(this.now())}start(e,t){(0,u.Ms)(this.context);let n=this.toSeconds(e);return this.log("start",n),"started"!==this._state.getValueAtTime(n)&&(this._state.setStateAtTime("started",n),this._tickSource.start(n,t),n<this._lastUpdate&&this.emit("start",n,t)),this}stop(e){let t=this.toSeconds(e);return this.log("stop",t),this._state.cancel(t),this._state.setStateAtTime("stopped",t),this._tickSource.stop(t),t<this._lastUpdate&&this.emit("stop",t),this}pause(e){let t=this.toSeconds(e);return"started"===this._state.getValueAtTime(t)&&(this._state.setStateAtTime("paused",t),this._tickSource.pause(t),t<this._lastUpdate&&this.emit("pause",t)),this}get ticks(){return Math.ceil(this.getTicksAtTime(this.now()))}set ticks(e){this._tickSource.ticks=e}get seconds(){return this._tickSource.seconds}set seconds(e){this._tickSource.seconds=e}getSecondsAtTime(e){return this._tickSource.getSecondsAtTime(e)}setTicksAtTime(e,t){return this._tickSource.setTicksAtTime(e,t),this}getTimeOfTick(e,t=this.now()){return this._tickSource.getTimeOfTick(e,t)}getTicksAtTime(e){return this._tickSource.getTicksAtTime(e)}nextTickTime(e,t){let n=this.toSeconds(t),i=this.getTicksAtTime(n);return this._tickSource.getTimeOfTick(i+e,n)}_loop(){let e=this._lastUpdate,t=this.now();this._lastUpdate=t,this.log("loop",e,t),e!==t&&(this._state.forEachBetween(e,t,e=>{switch(e.state){case"started":let t=this._tickSource.getTicksAtTime(e.time);this.emit("start",e.time,t);break;case"stopped":0!==e.time&&this.emit("stop",e.time);break;case"paused":this.emit("pause",e.time)}}),this._tickSource.forEachTickBetween(e,t,(e,t)=>{this.callback(e,t)}))}getStateAtTime(e){let t=this.toSeconds(e);return this._state.getValueAtTime(t)}dispose(){return super.dispose(),this.context.off("tick",this._boundLoop),this._tickSource.dispose(),this._state.dispose(),this}};o.Q.mixin(Clock_Clock),n(4182),n(7448);let Delay_Delay=class Delay_Delay extends d.HD{constructor(){super((0,r.Y9)(Delay_Delay.getDefaults(),arguments,["delayTime","maxDelay"])),this.name="Delay";let e=(0,r.Y9)(Delay_Delay.getDefaults(),arguments,["delayTime","maxDelay"]),t=this.toSeconds(e.maxDelay);this._maxDelay=Math.max(t,this.toSeconds(e.delayTime)),this._delayNode=this.input=this.output=this.context.createDelay(t),this.delayTime=new h.d({context:this.context,param:this._delayNode.delayTime,units:"time",value:e.delayTime,minValue:0,maxValue:this.maxDelay}),(0,a.qt)(this,"delayTime")}static getDefaults(){return Object.assign(d.HD.getDefaults(),{delayTime:0,maxDelay:1})}get maxDelay(){return this._maxDelay}dispose(){return super.dispose(),this._delayNode.disconnect(),this.delayTime.dispose(),this}};var g=n(3584),v=n(137),y=n(6346);let ToneAudioBuffers_ToneAudioBuffers=class ToneAudioBuffers_ToneAudioBuffers extends y.d{constructor(){super(),this.name="ToneAudioBuffers",this._buffers=new Map,this._loadingCount=0;let e=(0,r.Y9)(ToneAudioBuffers_ToneAudioBuffers.getDefaults(),arguments,["urls","onload","baseUrl"],"urls");this.baseUrl=e.baseUrl,Object.keys(e.urls).forEach(t=>{this._loadingCount++;let n=e.urls[t];this.add(t,n,this._bufferLoaded.bind(this,e.onload),e.onerror)})}static getDefaults(){return{baseUrl:"",onerror:a.EI,onload:a.EI,urls:{}}}has(e){return this._buffers.has(e.toString())}get(e){return(0,u.hu)(this.has(e),`ToneAudioBuffers has no buffer named: ${e}`),this._buffers.get(e.toString())}_bufferLoaded(e){this._loadingCount--,0===this._loadingCount&&e&&e()}get loaded(){return Array.from(this._buffers).every(([e,t])=>t.loaded)}add(e,t,n=a.EI,i=a.EI){return(0,c.HD)(t)?this._buffers.set(e.toString(),new v.p(this.baseUrl+t,n,i)):this._buffers.set(e.toString(),new v.p(t,n,i)),this}dispose(){return super.dispose(),this._buffers.forEach(e=>e.dispose()),this._buffers.clear(),this}};var A=n(6407),S=n(8609),x=n(573);let Ticks_TicksClass=class Ticks_TicksClass extends x.w{constructor(){super(...arguments),this.name="Ticks",this.defaultUnits="i"}_now(){return this.context.transport.ticks}_beatsToUnits(e){return this._getPPQ()*e}_secondsToUnits(e){return Math.floor(e/(60/this._getBpm())*this._getPPQ())}_ticksToUnits(e){return e}toTicks(){return this.valueOf()}toSeconds(){return this.valueOf()/this._getPPQ()*(60/this._getBpm())}};var T=n(9284);let Draw=class Draw extends s.v{constructor(){super(...arguments),this.name="Draw",this.expiration=.25,this.anticipation=.008,this._events=new l.T,this._boundDrawLoop=this._drawLoop.bind(this),this._animationFrame=-1}schedule(e,t){return this._events.add({callback:e,time:this.toSeconds(t)}),1===this._events.length&&(this._animationFrame=requestAnimationFrame(this._boundDrawLoop)),this}cancel(e){return this._events.cancel(this.toSeconds(e)),this}_drawLoop(){let e=this.context.currentTime;for(;this._events.length&&this._events.peek().time-this.anticipation<=e;){let t=this._events.shift();t&&e-t.time<=this.expiration&&t.callback()}this._events.length>0&&(this._animationFrame=requestAnimationFrame(this._boundDrawLoop))}dispose(){return super.dispose(),this._events.dispose(),cancelAnimationFrame(this._animationFrame),this}};(0,T.YV)(e=>{e.draw=new Draw({context:e})}),(0,T.Fc)(e=>{e.draw.dispose()});let IntervalTimeline=class IntervalTimeline extends y.d{constructor(){super(...arguments),this.name="IntervalTimeline",this._root=null,this._length=0}add(e){(0,u.hu)((0,c.$K)(e.time),"Events must have a time property"),(0,u.hu)((0,c.$K)(e.duration),"Events must have a duration parameter"),e.time=e.time.valueOf();let t=new IntervalNode(e.time,e.time+e.duration,e);for(null===this._root?this._root=t:this._root.insert(t),this._length++;null!==t;)t.updateHeight(),t.updateMax(),this._rebalance(t),t=t.parent;return this}remove(e){if(null!==this._root){let t=[];for(let n of(this._root.search(e.time,t),t))if(n.event===e){this._removeNode(n),this._length--;break}}return this}get length(){return this._length}cancel(e){return this.forEachFrom(e,e=>this.remove(e)),this}_setRoot(e){this._root=e,null!==this._root&&(this._root.parent=null)}_replaceNodeInParent(e,t){null!==e.parent?(e.isLeftChild()?e.parent.left=t:e.parent.right=t,this._rebalance(e.parent)):this._setRoot(t)}_removeNode(e){if(null===e.left&&null===e.right)this._replaceNodeInParent(e,null);else if(null===e.right)this._replaceNodeInParent(e,e.left);else if(null===e.left)this._replaceNodeInParent(e,e.right);else{let t;let n=e.getBalance(),i=null;if(n>0){if(null===e.left.right)(t=e.left).right=e.right,i=t;else{for(t=e.left.right;null!==t.right;)t=t.right;t.parent&&(t.parent.right=t.left,i=t.parent,t.left=e.left,t.right=e.right)}}else if(null===e.right.left)(t=e.right).left=e.left,i=t;else{for(t=e.right.left;null!==t.left;)t=t.left;t.parent&&(t.parent.left=t.right,i=t.parent,t.left=e.left,t.right=e.right)}null!==e.parent?e.isLeftChild()?e.parent.left=t:e.parent.right=t:this._setRoot(t),i&&this._rebalance(i)}e.dispose()}_rotateLeft(e){let t=e.parent,n=e.isLeftChild(),i=e.right;i&&(e.right=i.left,i.left=e),null!==t?n?t.left=i:t.right=i:this._setRoot(i)}_rotateRight(e){let t=e.parent,n=e.isLeftChild(),i=e.left;i&&(e.left=i.right,i.right=e),null!==t?n?t.left=i:t.right=i:this._setRoot(i)}_rebalance(e){let t=e.getBalance();t>1&&e.left?0>e.left.getBalance()?this._rotateLeft(e.left):this._rotateRight(e):t<-1&&e.right&&(e.right.getBalance()>0?this._rotateRight(e.right):this._rotateLeft(e))}get(e){if(null!==this._root){let t=[];if(this._root.search(e,t),t.length>0){let e=t[0];for(let n=1;n<t.length;n++)t[n].low>e.low&&(e=t[n]);return e.event}}return null}forEach(e){if(null!==this._root){let t=[];this._root.traverse(e=>t.push(e)),t.forEach(t=>{t.event&&e(t.event)})}return this}forEachAtTime(e,t){if(null!==this._root){let n=[];this._root.search(e,n),n.forEach(e=>{e.event&&t(e.event)})}return this}forEachFrom(e,t){if(null!==this._root){let n=[];this._root.searchAfter(e,n),n.forEach(e=>{e.event&&t(e.event)})}return this}dispose(){return super.dispose(),null!==this._root&&this._root.traverse(e=>e.dispose()),this._root=null,this}};let IntervalNode=class IntervalNode{constructor(e,t,n){this._left=null,this._right=null,this.parent=null,this.height=0,this.event=n,this.low=e,this.high=t,this.max=this.high}insert(e){e.low<=this.low?null===this.left?this.left=e:this.left.insert(e):null===this.right?this.right=e:this.right.insert(e)}search(e,t){!(e>this.max)&&(null!==this.left&&this.left.search(e,t),this.low<=e&&this.high>e&&t.push(this),this.low>e||null===this.right||this.right.search(e,t))}searchAfter(e,t){this.low>=e&&(t.push(this),null!==this.left&&this.left.searchAfter(e,t)),null!==this.right&&this.right.searchAfter(e,t)}traverse(e){e(this),null!==this.left&&this.left.traverse(e),null!==this.right&&this.right.traverse(e)}updateHeight(){null!==this.left&&null!==this.right?this.height=Math.max(this.left.height,this.right.height)+1:null!==this.right?this.height=this.right.height+1:null!==this.left?this.height=this.left.height+1:this.height=0}updateMax(){this.max=this.high,null!==this.left&&(this.max=Math.max(this.max,this.left.max)),null!==this.right&&(this.max=Math.max(this.max,this.right.max))}getBalance(){let e=0;return null!==this.left&&null!==this.right?e=this.left.height-this.right.height:null!==this.left?e=this.left.height+1:null!==this.right&&(e=-(this.right.height+1)),e}isLeftChild(){return null!==this.parent&&this.parent.left===this}get left(){return this._left}set left(e){this._left=e,null!==e&&(e.parent=this),this.updateHeight(),this.updateMax()}get right(){return this._right}set right(e){this._right=e,null!==e&&(e.parent=this),this.updateHeight(),this.updateMax()}dispose(){this.parent=null,this._left=null,this._right=null,this.event=null}};var C=n(2128);let Destination=class Destination extends d.HD{constructor(){super((0,r.Y9)(Destination.getDefaults(),arguments)),this.name="Destination",this.input=new C.f({context:this.context}),this.output=new f.S({context:this.context}),this.volume=this.input.volume;let e=(0,r.Y9)(Destination.getDefaults(),arguments);(0,d.ft)(this.input,this.output,this.context.rawContext.destination),this.mute=e.mute,this._internalChannels=[this.input,this.context.rawContext.destination,this.output]}static getDefaults(){return Object.assign(d.HD.getDefaults(),{mute:!1,volume:0})}get mute(){return this.input.mute}set mute(e){this.input.mute=e}chain(...e){return this.input.disconnect(),e.unshift(this.input),e.push(this.output),(0,d.ft)(...e),this}get maxChannelCount(){return this.context.rawContext.destination.maxChannelCount}dispose(){return super.dispose(),this.volume.dispose(),this}};(0,T.YV)(e=>{e.destination=new Destination({context:e})}),(0,T.Fc)(e=>{e.destination.dispose()});let TimelineValue=class TimelineValue extends y.d{constructor(e){super(),this.name="TimelineValue",this._timeline=new l.T({memory:10}),this._initialValue=e}set(e,t){return this._timeline.add({value:e,time:t}),this}get(e){let t=this._timeline.get(e);return t?t.value:this._initialValue}};let TransportEvent=class TransportEvent{constructor(e,t){this.id=TransportEvent._eventId++;let n=Object.assign(TransportEvent.getDefaults(),t);this.transport=e,this.callback=n.callback,this._once=n.once,this.time=n.time}static getDefaults(){return{callback:a.EI,once:!1,time:0}}invoke(e){this.callback&&(this.callback(e),this._once&&this.transport.clear(this.id))}dispose(){return this.callback=void 0,this}};TransportEvent._eventId=0;let TransportRepeatEvent=class TransportRepeatEvent extends TransportEvent{constructor(e,t){super(e,t),this._currentId=-1,this._nextId=-1,this._nextTick=this.time,this._boundRestart=this._restart.bind(this);let n=Object.assign(TransportRepeatEvent.getDefaults(),t);this.duration=new Ticks_TicksClass(e.context,n.duration).valueOf(),this._interval=new Ticks_TicksClass(e.context,n.interval).valueOf(),this._nextTick=n.time,this.transport.on("start",this._boundRestart),this.transport.on("loopStart",this._boundRestart),this.context=this.transport.context,this._restart()}static getDefaults(){return Object.assign({},TransportEvent.getDefaults(),{duration:1/0,interval:1,once:!1})}invoke(e){this._createEvents(e),super.invoke(e)}_createEvents(e){let t=this.transport.getTicksAtTime(e);t>=this.time&&t>=this._nextTick&&this._nextTick+this._interval<this.time+this.duration&&(this._nextTick+=this._interval,this._currentId=this._nextId,this._nextId=this.transport.scheduleOnce(this.invoke.bind(this),new Ticks_TicksClass(this.context,this._nextTick).toSeconds()))}_restart(e){this.transport.clear(this._currentId),this.transport.clear(this._nextId),this._nextTick=this.time;let t=this.transport.getTicksAtTime(e);t>this.time&&(this._nextTick=this.time+Math.ceil((t-this.time)/this._interval)*this._interval),this._currentId=this.transport.scheduleOnce(this.invoke.bind(this),new Ticks_TicksClass(this.context,this._nextTick).toSeconds()),this._nextTick+=this._interval,this._nextId=this.transport.scheduleOnce(this.invoke.bind(this),new Ticks_TicksClass(this.context,this._nextTick).toSeconds())}dispose(){return super.dispose(),this.transport.clear(this._currentId),this.transport.clear(this._nextId),this.transport.off("start",this._boundRestart),this.transport.off("loopStart",this._boundRestart),this}};let Transport=class Transport extends s.v{constructor(){super((0,r.Y9)(Transport.getDefaults(),arguments)),this.name="Transport",this._loop=new TimelineValue(!1),this._loopStart=0,this._loopEnd=0,this._scheduledEvents={},this._timeline=new l.T,this._repeatedEvents=new IntervalTimeline,this._syncedSignals=[],this._swingAmount=0;let e=(0,r.Y9)(Transport.getDefaults(),arguments);this._ppq=e.ppq,this._clock=new Clock_Clock({callback:this._processTick.bind(this),context:this.context,frequency:0,units:"bpm"}),this._bindClockEvents(),this.bpm=this._clock.frequency,this._clock.frequency.multiplier=e.ppq,this.bpm.setValueAtTime(e.bpm,0),(0,a.qt)(this,"bpm"),this._timeSignature=e.timeSignature,this._swingTicks=e.ppq/2}static getDefaults(){return Object.assign(s.v.getDefaults(),{bpm:120,loopEnd:"4m",loopStart:0,ppq:192,swing:0,swingSubdivision:"8n",timeSignature:4})}_processTick(e,t){if(this._loop.get(e)&&t>=this._loopEnd&&(this.emit("loopEnd",e),this._clock.setTicksAtTime(this._loopStart,e),t=this._loopStart,this.emit("loopStart",e,this._clock.getSecondsAtTime(e)),this.emit("loop",e)),this._swingAmount>0&&t%this._ppq!=0&&t%(2*this._swingTicks)!=0){let n=t%(2*this._swingTicks)/(2*this._swingTicks),i=Math.sin(n*Math.PI)*this._swingAmount;e+=new Ticks_TicksClass(this.context,2*this._swingTicks/3).toSeconds()*i}this._timeline.forEachAtTime(t,t=>t.invoke(e))}schedule(e,t){let n=new TransportEvent(this,{callback:e,time:new x.w(this.context,t).toTicks()});return this._addEvent(n,this._timeline)}scheduleRepeat(e,t,n,i=1/0){let s=new TransportRepeatEvent(this,{callback:e,duration:new S.A(this.context,i).toTicks(),interval:new S.A(this.context,t).toTicks(),time:new x.w(this.context,n).toTicks()});return this._addEvent(s,this._repeatedEvents)}scheduleOnce(e,t){let n=new TransportEvent(this,{callback:e,once:!0,time:new x.w(this.context,t).toTicks()});return this._addEvent(n,this._timeline)}clear(e){if(this._scheduledEvents.hasOwnProperty(e)){let t=this._scheduledEvents[e.toString()];t.timeline.remove(t.event),t.event.dispose(),delete this._scheduledEvents[e.toString()]}return this}_addEvent(e,t){return this._scheduledEvents[e.id.toString()]={event:e,timeline:t},t.add(e),e.id}cancel(e=0){let t=this.toTicks(e);return this._timeline.forEachFrom(t,e=>this.clear(e.id)),this._repeatedEvents.forEachFrom(t,e=>this.clear(e.id)),this}_bindClockEvents(){this._clock.on("start",(e,t)=>{t=new Ticks_TicksClass(this.context,t).toSeconds(),this.emit("start",e,t)}),this._clock.on("stop",e=>{this.emit("stop",e)}),this._clock.on("pause",e=>{this.emit("pause",e)})}get state(){return this._clock.getStateAtTime(this.now())}start(e,t){let n;return(0,c.$K)(t)&&(n=this.toTicks(t)),this._clock.start(e,n),this}stop(e){return this._clock.stop(e),this}pause(e){return this._clock.pause(e),this}toggle(e){return e=this.toSeconds(e),"started"!==this._clock.getStateAtTime(e)?this.start(e):this.stop(e),this}get timeSignature(){return this._timeSignature}set timeSignature(e){(0,c.kJ)(e)&&(e=e[0]/e[1]*4),this._timeSignature=e}get loopStart(){return new S.A(this.context,this._loopStart,"i").toSeconds()}set loopStart(e){this._loopStart=this.toTicks(e)}get loopEnd(){return new S.A(this.context,this._loopEnd,"i").toSeconds()}set loopEnd(e){this._loopEnd=this.toTicks(e)}get loop(){return this._loop.get(this.now())}set loop(e){this._loop.set(e,this.now())}setLoopPoints(e,t){return this.loopStart=e,this.loopEnd=t,this}get swing(){return this._swingAmount}set swing(e){this._swingAmount=e}get swingSubdivision(){return new Ticks_TicksClass(this.context,this._swingTicks).toNotation()}set swingSubdivision(e){this._swingTicks=this.toTicks(e)}get position(){let e=this.now(),t=this._clock.getTicksAtTime(e);return new Ticks_TicksClass(this.context,t).toBarsBeatsSixteenths()}set position(e){let t=this.toTicks(e);this.ticks=t}get seconds(){return this._clock.seconds}set seconds(e){let t=this.now(),n=this._clock.frequency.timeToTicks(e,t);this.ticks=n}get progress(){if(!this.loop)return 0;{let e=this.now(),t=this._clock.getTicksAtTime(e);return(t-this._loopStart)/(this._loopEnd-this._loopStart)}}get ticks(){return this._clock.ticks}set ticks(e){if(this._clock.ticks!==e){let t=this.now();if("started"===this.state){let n=this._clock.getTicksAtTime(t),i=this._clock.frequency.getDurationOfTicks(Math.ceil(n)-n,t),s=t+i;this.emit("stop",s),this._clock.setTicksAtTime(e,s),this.emit("start",s,this._clock.getSecondsAtTime(s))}else this._clock.setTicksAtTime(e,t)}}getTicksAtTime(e){return Math.round(this._clock.getTicksAtTime(e))}getSecondsAtTime(e){return this._clock.getSecondsAtTime(e)}get PPQ(){return this._clock.frequency.multiplier}set PPQ(e){this._clock.frequency.multiplier=e}nextSubdivision(e){if(e=this.toTicks(e),"started"!==this.state)return 0;{let t=this.now(),n=this.getTicksAtTime(t),i=e-n%e;return this._clock.nextTickTime(i,t)}}syncSignal(e,t){if(!t){let n=this.now();if(0!==e.getValueAtTime(n)){let i=this.bpm.getValueAtTime(n),s=1/(60/i/this.PPQ);t=e.getValueAtTime(n)/s}else t=0}let n=new f.S(t);return this.bpm.connect(n),n.connect(e._param),this._syncedSignals.push({initial:e.value,ratio:n,signal:e}),e.value=0,this}unsyncSignal(e){for(let t=this._syncedSignals.length-1;t>=0;t--){let n=this._syncedSignals[t];n.signal===e&&(n.ratio.dispose(),n.signal.value=n.initial,this._syncedSignals.splice(t,1))}return this}dispose(){return super.dispose(),this._clock.dispose(),(0,a.fZ)(this,"bpm"),this._timeline.dispose(),this._repeatedEvents.dispose(),this}};o.Q.mixin(Transport),(0,T.YV)(e=>{e.transport=new Transport({context:e})}),(0,T.Fc)(e=>{e.transport.dispose()});let Source_Source=class Source_Source extends d.HD{constructor(e){super(e),this.input=void 0,this._state=new StateTimeline_StateTimeline("stopped"),this._synced=!1,this._scheduled=[],this._syncedStart=a.EI,this._syncedStop=a.EI,this._state.memory=100,this._state.increasing=!0,this._volume=this.output=new C.f({context:this.context,mute:e.mute,volume:e.volume}),this.volume=this._volume.volume,(0,a.qt)(this,"volume"),this.onstop=e.onstop}static getDefaults(){return Object.assign(d.HD.getDefaults(),{mute:!1,onstop:a.EI,volume:0})}get state(){return this._synced?"started"===this.context.transport.state?this._state.getValueAtTime(this.context.transport.seconds):"stopped":this._state.getValueAtTime(this.now())}get mute(){return this._volume.mute}set mute(e){this._volume.mute=e}_clampToCurrentTime(e){return this._synced?e:Math.max(e,this.context.currentTime)}start(e,t,n){let i=(0,c.G7)(e)&&this._synced?this.context.transport.seconds:this.toSeconds(e);if(i=this._clampToCurrentTime(i),this._synced||"started"!==this._state.getValueAtTime(i)){if(this.log("start",i),this._state.setStateAtTime("started",i),this._synced){let e=this._state.get(i);e&&(e.offset=this.toSeconds((0,r.PK)(t,0)),e.duration=n?this.toSeconds(n):void 0);let s=this.context.transport.schedule(e=>{this._start(e,t,n)},i);this._scheduled.push(s),"started"===this.context.transport.state&&this.context.transport.getSecondsAtTime(this.immediate())>i&&this._syncedStart(this.now(),this.context.transport.seconds)}else(0,u.Ms)(this.context),this._start(i,t,n)}else(0,u.hu)((0,m.GT)(i,this._state.get(i).time),"Start time must be strictly greater than previous start time"),this._state.cancel(i),this._state.setStateAtTime("started",i),this.log("restart",i),this.restart(i,t,n);return this}stop(e){let t=(0,c.G7)(e)&&this._synced?this.context.transport.seconds:this.toSeconds(e);if(t=this._clampToCurrentTime(t),"started"===this._state.getValueAtTime(t)||(0,c.$K)(this._state.getNextState("started",t))){if(this.log("stop",t),this._synced){let e=this.context.transport.schedule(this._stop.bind(this),t);this._scheduled.push(e)}else this._stop(t);this._state.cancel(t),this._state.setStateAtTime("stopped",t)}return this}restart(e,t,n){return e=this.toSeconds(e),"started"===this._state.getValueAtTime(e)&&(this._state.cancel(e),this._restart(e,t,n)),this}sync(){return this._synced||(this._synced=!0,this._syncedStart=(e,t)=>{if(t>0){let n=this._state.get(t);if(n&&"started"===n.state&&n.time!==t){let i;let s=t-this.toSeconds(n.time);n.duration&&(i=this.toSeconds(n.duration)-s),this._start(e,this.toSeconds(n.offset)+s,i)}}},this._syncedStop=e=>{let t=this.context.transport.getSecondsAtTime(Math.max(e-this.sampleTime,0));"started"===this._state.getValueAtTime(t)&&this._stop(e)},this.context.transport.on("start",this._syncedStart),this.context.transport.on("loopStart",this._syncedStart),this.context.transport.on("stop",this._syncedStop),this.context.transport.on("pause",this._syncedStop),this.context.transport.on("loopEnd",this._syncedStop)),this}unsync(){return this._synced&&(this.context.transport.off("stop",this._syncedStop),this.context.transport.off("pause",this._syncedStop),this.context.transport.off("loopEnd",this._syncedStop),this.context.transport.off("start",this._syncedStart),this.context.transport.off("loopStart",this._syncedStart)),this._synced=!1,this._scheduled.forEach(e=>this.context.transport.clear(e)),this._scheduled=[],this._state.cancel(0),this._stop(0),this}dispose(){return super.dispose(),this.onstop=a.EI,this.unsync(),this._volume.dispose(),this._state.dispose(),this}};let ToneBufferSource_ToneBufferSource=class ToneBufferSource_ToneBufferSource extends OneShotSource{constructor(){super((0,r.Y9)(ToneBufferSource_ToneBufferSource.getDefaults(),arguments,["url","onload"])),this.name="ToneBufferSource",this._source=this.context.createBufferSource(),this._internalChannels=[this._source],this._sourceStarted=!1,this._sourceStopped=!1;let e=(0,r.Y9)(ToneBufferSource_ToneBufferSource.getDefaults(),arguments,["url","onload"]);(0,d.$j)(this._source,this._gainNode),this._source.onended=()=>this._stopSource(),this.playbackRate=new h.d({context:this.context,param:this._source.playbackRate,units:"positive",value:e.playbackRate}),this.loop=e.loop,this.loopStart=e.loopStart,this.loopEnd=e.loopEnd,this._buffer=new v.p(e.url,e.onload,e.onerror),this._internalChannels.push(this._source)}static getDefaults(){return Object.assign(OneShotSource.getDefaults(),{url:new v.p,loop:!1,loopEnd:0,loopStart:0,onload:a.EI,onerror:a.EI,playbackRate:1})}get fadeIn(){return this._fadeIn}set fadeIn(e){this._fadeIn=e}get fadeOut(){return this._fadeOut}set fadeOut(e){this._fadeOut=e}get curve(){return this._curve}set curve(e){this._curve=e}start(e,t,n,i=1){(0,u.hu)(this.buffer.loaded,"buffer is either not set or not loaded");let s=this.toSeconds(e);this._startGain(s,i),t=this.loop?(0,r.PK)(t,this.loopStart):(0,r.PK)(t,0);let o=Math.max(this.toSeconds(t),0);if(this.loop){let e=this.toSeconds(this.loopEnd)||this.buffer.duration,t=this.toSeconds(this.loopStart),n=e-t;(0,m.x)(o,e)&&(o=(o-t)%n+t),(0,m.EQ)(o,this.buffer.duration)&&(o=0)}if(this._source.buffer=this.buffer.get(),this._source.loopEnd=this.toSeconds(this.loopEnd)||this.buffer.duration,(0,m.LT)(o,this.buffer.duration)&&(this._sourceStarted=!0,this._source.start(s,o)),(0,c.$K)(n)){let e=this.toSeconds(n);e=Math.max(e,0),this.stop(s+e)}return this}_stopSource(e){!this._sourceStopped&&this._sourceStarted&&(this._sourceStopped=!0,this._source.stop(this.toSeconds(e)),this._onended())}get loopStart(){return this._source.loopStart}set loopStart(e){this._source.loopStart=this.toSeconds(e)}get loopEnd(){return this._source.loopEnd}set loopEnd(e){this._source.loopEnd=this.toSeconds(e)}get buffer(){return this._buffer}set buffer(e){this._buffer.set(e)}get loop(){return this._source.loop}set loop(e){this._source.loop=e,this._sourceStarted&&this.cancelStop()}dispose(){return super.dispose(),this._source.onended=null,this._source.disconnect(),this._buffer.dispose(),this.playbackRate.dispose(),this}};let Noise_Noise=class Noise_Noise extends Source_Source{constructor(){super((0,r.Y9)(Noise_Noise.getDefaults(),arguments,["type"])),this.name="Noise",this._source=null;let e=(0,r.Y9)(Noise_Noise.getDefaults(),arguments,["type"]);this._playbackRate=e.playbackRate,this.type=e.type,this._fadeIn=e.fadeIn,this._fadeOut=e.fadeOut}static getDefaults(){return Object.assign(Source_Source.getDefaults(),{fadeIn:0,fadeOut:0,playbackRate:1,type:"white"})}get type(){return this._type}set type(e){if((0,u.hu)(e in w,"Noise: invalid type: "+e),this._type!==e&&(this._type=e,"started"===this.state)){let e=this.now();this._stop(e),this._start(e)}}get playbackRate(){return this._playbackRate}set playbackRate(e){this._playbackRate=e,this._source&&(this._source.playbackRate.value=e)}_start(e){let t=w[this._type];this._source=new ToneBufferSource_ToneBufferSource({url:t,context:this.context,fadeIn:this._fadeIn,fadeOut:this._fadeOut,loop:!0,onended:()=>this.onstop(this),playbackRate:this._playbackRate}).connect(this.output),this._source.start(this.toSeconds(e),Math.random()*(t.duration-.001))}_stop(e){this._source&&(this._source.stop(this.toSeconds(e)),this._source=null)}get fadeIn(){return this._fadeIn}set fadeIn(e){this._fadeIn=e,this._source&&(this._source.fadeIn=this._fadeIn)}get fadeOut(){return this._fadeOut}set fadeOut(e){this._fadeOut=e,this._source&&(this._source.fadeOut=this._fadeOut)}_restart(e){this._stop(e),this._start(e)}dispose(){return super.dispose(),this._source&&this._source.disconnect(),this}};let N={brown:null,pink:null,white:null},w={get brown(){if(!N.brown){let e=[];for(let t=0;t<2;t++){let n=new Float32Array(220500);e[t]=n;let i=0;for(let e=0;e<220500;e++){let t=2*Math.random()-1;n[e]=(i+.02*t)/1.02,i=n[e],n[e]*=3.5}}N.brown=new v.p().fromArray(e)}return N.brown},get pink(){if(!N.pink){let e=[];for(let t=0;t<2;t++){let n,i,s,r,o,a,l;let u=new Float32Array(220500);e[t]=u,n=i=s=r=o=a=l=0;for(let e=0;e<220500;e++){let t=2*Math.random()-1;n=.99886*n+.0555179*t,i=.99332*i+.0750759*t,s=.969*s+.153852*t,r=.8665*r+.3104856*t,o=.55*o+.5329522*t,a=-.7616*a-.016898*t,u[e]=n+i+s+r+o+a+l+.5362*t,u[e]*=.11,l=.115926*t}}N.pink=new v.p().fromArray(e)}return N.pink},get white(){if(!N.white){let e=[];for(let t=0;t<2;t++){let n=new Float32Array(220500);e[t]=n;for(let e=0;e<220500;e++)n[e]=2*Math.random()-1}N.white=new v.p().fromArray(e)}return N.white}};var b=n(44);let UserMedia=class UserMedia extends d.HD{constructor(){super((0,r.Y9)(UserMedia.getDefaults(),arguments,["volume"])),this.name="UserMedia";let e=(0,r.Y9)(UserMedia.getDefaults(),arguments,["volume"]);this._volume=this.output=new C.f({context:this.context,volume:e.volume}),this.volume=this._volume.volume,(0,a.qt)(this,"volume"),this.mute=e.mute}static getDefaults(){return Object.assign(d.HD.getDefaults(),{mute:!1,volume:0})}open(e){return(0,b.mG)(this,void 0,void 0,function*(){(0,u.hu)(UserMedia.supported,"UserMedia is not supported"),"started"===this.state&&this.close();let t=yield UserMedia.enumerateDevices();(0,c.hj)(e)?this._device=t[e]:(this._device=t.find(t=>t.label===e||t.deviceId===e),!this._device&&t.length>0&&(this._device=t[0]),(0,u.hu)((0,c.$K)(this._device),`No matching device ${e}`));let n={audio:{echoCancellation:!1,sampleRate:this.context.sampleRate,noiseSuppression:!1,mozNoiseSuppression:!1}};this._device&&(n.audio.deviceId=this._device.deviceId);let i=yield navigator.mediaDevices.getUserMedia(n);if(!this._stream){this._stream=i;let e=this.context.createMediaStreamSource(i);(0,d.$j)(e,this.output),this._mediaStream=e}return this})}close(){return this._stream&&this._mediaStream&&(this._stream.getAudioTracks().forEach(e=>{e.stop()}),this._stream=void 0,this._mediaStream.disconnect(),this._mediaStream=void 0),this._device=void 0,this}static enumerateDevices(){return(0,b.mG)(this,void 0,void 0,function*(){let e=yield navigator.mediaDevices.enumerateDevices();return e.filter(e=>"audioinput"===e.kind)})}get state(){return this._stream&&this._stream.active?"started":"stopped"}get deviceId(){return this._device?this._device.deviceId:void 0}get groupId(){return this._device?this._device.groupId:void 0}get label(){return this._device?this._device.label:void 0}get mute(){return this._volume.mute}set mute(e){this._volume.mute=e}dispose(){return super.dispose(),this.close(),this._volume.dispose(),this.volume.dispose(),this}static get supported(){return(0,c.$K)(navigator.mediaDevices)&&(0,c.$K)(navigator.mediaDevices.getUserMedia)}};function generateWaveform(e,t){return(0,b.mG)(this,void 0,void 0,function*(){let n=t/e.context.sampleRate,i=new g.n(1,n,e.context.sampleRate),s=new e.constructor(Object.assign(e.get(),{frequency:2/n,detune:0,context:i})).toDestination();s.start(0);let r=yield i.render();return r.getChannelData(0)})}let ToneOscillatorNode_ToneOscillatorNode=class ToneOscillatorNode_ToneOscillatorNode extends OneShotSource{constructor(){super((0,r.Y9)(ToneOscillatorNode_ToneOscillatorNode.getDefaults(),arguments,["frequency","type"])),this.name="ToneOscillatorNode",this._oscillator=this.context.createOscillator(),this._internalChannels=[this._oscillator];let e=(0,r.Y9)(ToneOscillatorNode_ToneOscillatorNode.getDefaults(),arguments,["frequency","type"]);(0,d.$j)(this._oscillator,this._gainNode),this.type=e.type,this.frequency=new h.d({context:this.context,param:this._oscillator.frequency,units:"frequency",value:e.frequency}),this.detune=new h.d({context:this.context,param:this._oscillator.detune,units:"cents",value:e.detune}),(0,a.qt)(this,["frequency","detune"])}static getDefaults(){return Object.assign(OneShotSource.getDefaults(),{detune:0,frequency:440,type:"sine"})}start(e){let t=this.toSeconds(e);return this.log("start",t),this._startGain(t),this._oscillator.start(t),this}_stopSource(e){this._oscillator.stop(e)}setPeriodicWave(e){return this._oscillator.setPeriodicWave(e),this}get type(){return this._oscillator.type}set type(e){this._oscillator.type=e}dispose(){return super.dispose(),"started"===this.state&&this.stop(),this._oscillator.disconnect(),this.frequency.dispose(),this.detune.dispose(),this}};let Oscillator_Oscillator=class Oscillator_Oscillator extends Source_Source{constructor(){super((0,r.Y9)(Oscillator_Oscillator.getDefaults(),arguments,["frequency","type"])),this.name="Oscillator",this._oscillator=null;let e=(0,r.Y9)(Oscillator_Oscillator.getDefaults(),arguments,["frequency","type"]);this.frequency=new Signal_Signal({context:this.context,units:"frequency",value:e.frequency}),(0,a.qt)(this,"frequency"),this.detune=new Signal_Signal({context:this.context,units:"cents",value:e.detune}),(0,a.qt)(this,"detune"),this._partials=e.partials,this._partialCount=e.partialCount,this._type=e.type,e.partialCount&&"custom"!==e.type&&(this._type=this.baseType+e.partialCount.toString()),this.phase=e.phase}static getDefaults(){return Object.assign(Source_Source.getDefaults(),{detune:0,frequency:440,partialCount:0,partials:[],phase:0,type:"sine"})}_start(e){let t=this.toSeconds(e),n=new ToneOscillatorNode_ToneOscillatorNode({context:this.context,onended:()=>this.onstop(this)});this._oscillator=n,this._wave?this._oscillator.setPeriodicWave(this._wave):this._oscillator.type=this._type,this._oscillator.connect(this.output),this.frequency.connect(this._oscillator.frequency),this.detune.connect(this._oscillator.detune),this._oscillator.start(t)}_stop(e){let t=this.toSeconds(e);this._oscillator&&this._oscillator.stop(t)}_restart(e){let t=this.toSeconds(e);return this.log("restart",t),this._oscillator&&this._oscillator.cancelStop(),this._state.cancel(t),this}syncFrequency(){return this.context.transport.syncSignal(this.frequency),this}unsyncFrequency(){return this.context.transport.unsyncSignal(this.frequency),this}_getCachedPeriodicWave(){if("custom"===this._type){let e=Oscillator_Oscillator._periodicWaveCache.find(e=>e.phase===this._phase&&(0,r.qt)(e.partials,this._partials));return e}{let e=Oscillator_Oscillator._periodicWaveCache.find(e=>e.type===this._type&&e.phase===this._phase);return this._partialCount=e?e.partialCount:this._partialCount,e}}get type(){return this._type}set type(e){this._type=e;let t=-1!==["sine","square","sawtooth","triangle"].indexOf(e);if(0===this._phase&&t)this._wave=void 0,this._partialCount=0,null!==this._oscillator&&(this._oscillator.type=e);else{let t=this._getCachedPeriodicWave();if((0,c.$K)(t)){let{partials:e,wave:n}=t;this._wave=n,this._partials=e,null!==this._oscillator&&this._oscillator.setPeriodicWave(this._wave)}else{let[t,n]=this._getRealImaginary(e,this._phase),i=this.context.createPeriodicWave(t,n);this._wave=i,null!==this._oscillator&&this._oscillator.setPeriodicWave(this._wave),Oscillator_Oscillator._periodicWaveCache.push({imag:n,partialCount:this._partialCount,partials:this._partials,phase:this._phase,real:t,type:this._type,wave:this._wave}),Oscillator_Oscillator._periodicWaveCache.length>100&&Oscillator_Oscillator._periodicWaveCache.shift()}}}get baseType(){return this._type.replace(this.partialCount.toString(),"")}set baseType(e){this.partialCount&&"custom"!==this._type&&"custom"!==e?this.type=e+this.partialCount:this.type=e}get partialCount(){return this._partialCount}set partialCount(e){(0,u.gI)(e,0);let t=this._type,n=/^(sine|triangle|square|sawtooth)(\d+)$/.exec(this._type);if(n&&(t=n[1]),"custom"!==this._type)0===e?this.type=t:this.type=t+e.toString();else{let t=new Float32Array(e);this._partials.forEach((e,n)=>t[n]=e),this._partials=Array.from(t),this.type=this._type}}_getRealImaginary(e,t){let n=2048,i=new Float32Array(n),s=new Float32Array(n),r=1;if("custom"===e){if(r=this._partials.length+1,this._partialCount=this._partials.length,n=r,0===this._partials.length)return[i,s]}else{let t=/^(sine|triangle|square|sawtooth)(\d+)$/.exec(e);t?(r=parseInt(t[2],10)+1,this._partialCount=parseInt(t[2],10),e=t[1],n=r=Math.max(r,2)):this._partialCount=0,this._partials=[]}for(let o=1;o<n;++o){let n;let a=2/(o*Math.PI);switch(e){case"sine":n=o<=r?1:0,this._partials[o-1]=n;break;case"square":n=1&o?2*a:0,this._partials[o-1]=n;break;case"sawtooth":n=a*(1&o?1:-1),this._partials[o-1]=n;break;case"triangle":n=1&o?2*(a*a)*(o-1>>1&1?-1:1):0,this._partials[o-1]=n;break;case"custom":n=this._partials[o-1];break;default:throw TypeError("Oscillator: invalid type: "+e)}0!==n?(i[o]=-n*Math.sin(t*o),s[o]=n*Math.cos(t*o)):(i[o]=0,s[o]=0)}return[i,s]}_inverseFFT(e,t,n){let i=0,s=e.length;for(let r=0;r<s;r++)i+=e[r]*Math.cos(r*n)+t[r]*Math.sin(r*n);return i}getInitialValue(){let[e,t]=this._getRealImaginary(this._type,0),n=0,i=2*Math.PI;for(let s=0;s<32;s++)n=Math.max(this._inverseFFT(e,t,s/32*i),n);return(0,m.u)(-this._inverseFFT(e,t,this._phase)/n,-1,1)}get partials(){return this._partials.slice(0,this.partialCount)}set partials(e){this._partials=e,this._partialCount=this._partials.length,e.length&&(this.type="custom")}get phase(){return this._phase*(180/Math.PI)}set phase(e){this._phase=e*Math.PI/180,this.type=this._type}asArray(e=1024){return(0,b.mG)(this,void 0,void 0,function*(){return generateWaveform(this,e)})}dispose(){return super.dispose(),null!==this._oscillator&&this._oscillator.dispose(),this._wave=void 0,this.frequency.dispose(),this.detune.dispose(),this}};Oscillator_Oscillator._periodicWaveCache=[];let SignalOperator_SignalOperator=class SignalOperator_SignalOperator extends d.HD{constructor(){super(Object.assign((0,r.Y9)(SignalOperator_SignalOperator.getDefaults(),arguments,["context"])))}connect(e,t=0,n=0){return connectSignal(this,e,t,n),this}};let WaveShaper_WaveShaper=class WaveShaper_WaveShaper extends SignalOperator_SignalOperator{constructor(){super(Object.assign((0,r.Y9)(WaveShaper_WaveShaper.getDefaults(),arguments,["mapping","length"]))),this.name="WaveShaper",this._shaper=this.context.createWaveShaper(),this.input=this._shaper,this.output=this._shaper;let e=(0,r.Y9)(WaveShaper_WaveShaper.getDefaults(),arguments,["mapping","length"]);(0,c.kJ)(e.mapping)||e.mapping instanceof Float32Array?this.curve=Float32Array.from(e.mapping):(0,c.mf)(e.mapping)&&this.setMap(e.mapping,e.length)}static getDefaults(){return Object.assign(Signal_Signal.getDefaults(),{length:1024})}setMap(e,t=1024){let n=new Float32Array(t);for(let i=0;i<t;i++){let s=i/(t-1)*2-1;n[i]=e(s,i)}return this.curve=n,this}get curve(){return this._shaper.curve}set curve(e){this._shaper.curve=e}get oversample(){return this._shaper.oversample}set oversample(e){let t=["none","2x","4x"].some(t=>t.includes(e));(0,u.hu)(t,"oversampling must be either 'none', '2x', or '4x'"),this._shaper.oversample=e}dispose(){return super.dispose(),this._shaper.disconnect(),this}};let AudioToGain_AudioToGain=class AudioToGain_AudioToGain extends SignalOperator_SignalOperator{constructor(){super(...arguments),this.name="AudioToGain",this._norm=new WaveShaper_WaveShaper({context:this.context,mapping:e=>(e+1)/2}),this.input=this._norm,this.output=this._norm}dispose(){return super.dispose(),this._norm.dispose(),this}};let Multiply_Multiply=class Multiply_Multiply extends Signal_Signal{constructor(){super(Object.assign((0,r.Y9)(Multiply_Multiply.getDefaults(),arguments,["value"]))),this.name="Multiply",this.override=!1;let e=(0,r.Y9)(Multiply_Multiply.getDefaults(),arguments,["value"]);this._mult=this.input=this.output=new f.S({context:this.context,minValue:e.minValue,maxValue:e.maxValue}),this.factor=this._param=this._mult.gain,this.factor.setValueAtTime(e.value,0)}static getDefaults(){return Object.assign(Signal_Signal.getDefaults(),{value:0})}dispose(){return super.dispose(),this._mult.dispose(),this}};let AMOscillator=class AMOscillator extends Source_Source{constructor(){super((0,r.Y9)(AMOscillator.getDefaults(),arguments,["frequency","type","modulationType"])),this.name="AMOscillator",this._modulationScale=new AudioToGain_AudioToGain({context:this.context}),this._modulationNode=new f.S({context:this.context});let e=(0,r.Y9)(AMOscillator.getDefaults(),arguments,["frequency","type","modulationType"]);this._carrier=new Oscillator_Oscillator({context:this.context,detune:e.detune,frequency:e.frequency,onstop:()=>this.onstop(this),phase:e.phase,type:e.type}),this.frequency=this._carrier.frequency,this.detune=this._carrier.detune,this._modulator=new Oscillator_Oscillator({context:this.context,phase:e.phase,type:e.modulationType}),this.harmonicity=new Multiply_Multiply({context:this.context,units:"positive",value:e.harmonicity}),this.frequency.chain(this.harmonicity,this._modulator.frequency),this._modulator.chain(this._modulationScale,this._modulationNode.gain),this._carrier.chain(this._modulationNode,this.output),(0,a.qt)(this,["frequency","detune","harmonicity"])}static getDefaults(){return Object.assign(Oscillator_Oscillator.getDefaults(),{harmonicity:1,modulationType:"square"})}_start(e){this._modulator.start(e),this._carrier.start(e)}_stop(e){this._modulator.stop(e),this._carrier.stop(e)}_restart(e){this._modulator.restart(e),this._carrier.restart(e)}get type(){return this._carrier.type}set type(e){this._carrier.type=e}get baseType(){return this._carrier.baseType}set baseType(e){this._carrier.baseType=e}get partialCount(){return this._carrier.partialCount}set partialCount(e){this._carrier.partialCount=e}get modulationType(){return this._modulator.type}set modulationType(e){this._modulator.type=e}get phase(){return this._carrier.phase}set phase(e){this._carrier.phase=e,this._modulator.phase=e}get partials(){return this._carrier.partials}set partials(e){this._carrier.partials=e}asArray(e=1024){return(0,b.mG)(this,void 0,void 0,function*(){return generateWaveform(this,e)})}dispose(){return super.dispose(),this.frequency.dispose(),this.detune.dispose(),this.harmonicity.dispose(),this._carrier.dispose(),this._modulator.dispose(),this._modulationNode.dispose(),this._modulationScale.dispose(),this}};let FMOscillator_FMOscillator=class FMOscillator_FMOscillator extends Source_Source{constructor(){super((0,r.Y9)(FMOscillator_FMOscillator.getDefaults(),arguments,["frequency","type","modulationType"])),this.name="FMOscillator",this._modulationNode=new f.S({context:this.context,gain:0});let e=(0,r.Y9)(FMOscillator_FMOscillator.getDefaults(),arguments,["frequency","type","modulationType"]);this._carrier=new Oscillator_Oscillator({context:this.context,detune:e.detune,frequency:0,onstop:()=>this.onstop(this),phase:e.phase,type:e.type}),this.detune=this._carrier.detune,this.frequency=new Signal_Signal({context:this.context,units:"frequency",value:e.frequency}),this._modulator=new Oscillator_Oscillator({context:this.context,phase:e.phase,type:e.modulationType}),this.harmonicity=new Multiply_Multiply({context:this.context,units:"positive",value:e.harmonicity}),this.modulationIndex=new Multiply_Multiply({context:this.context,units:"positive",value:e.modulationIndex}),this.frequency.connect(this._carrier.frequency),this.frequency.chain(this.harmonicity,this._modulator.frequency),this.frequency.chain(this.modulationIndex,this._modulationNode),this._modulator.connect(this._modulationNode.gain),this._modulationNode.connect(this._carrier.frequency),this._carrier.connect(this.output),this.detune.connect(this._modulator.detune),(0,a.qt)(this,["modulationIndex","frequency","detune","harmonicity"])}static getDefaults(){return Object.assign(Oscillator_Oscillator.getDefaults(),{harmonicity:1,modulationIndex:2,modulationType:"square"})}_start(e){this._modulator.start(e),this._carrier.start(e)}_stop(e){this._modulator.stop(e),this._carrier.stop(e)}_restart(e){return this._modulator.restart(e),this._carrier.restart(e),this}get type(){return this._carrier.type}set type(e){this._carrier.type=e}get baseType(){return this._carrier.baseType}set baseType(e){this._carrier.baseType=e}get partialCount(){return this._carrier.partialCount}set partialCount(e){this._carrier.partialCount=e}get modulationType(){return this._modulator.type}set modulationType(e){this._modulator.type=e}get phase(){return this._carrier.phase}set phase(e){this._carrier.phase=e,this._modulator.phase=e}get partials(){return this._carrier.partials}set partials(e){this._carrier.partials=e}asArray(e=1024){return(0,b.mG)(this,void 0,void 0,function*(){return generateWaveform(this,e)})}dispose(){return super.dispose(),this.frequency.dispose(),this.harmonicity.dispose(),this._carrier.dispose(),this._modulator.dispose(),this._modulationNode.dispose(),this.modulationIndex.dispose(),this}};let PulseOscillator=class PulseOscillator extends Source_Source{constructor(){super((0,r.Y9)(PulseOscillator.getDefaults(),arguments,["frequency","width"])),this.name="PulseOscillator",this._widthGate=new f.S({context:this.context,gain:0}),this._thresh=new WaveShaper_WaveShaper({context:this.context,mapping:e=>e<=0?-1:1});let e=(0,r.Y9)(PulseOscillator.getDefaults(),arguments,["frequency","width"]);this.width=new Signal_Signal({context:this.context,units:"audioRange",value:e.width}),this._triangle=new Oscillator_Oscillator({context:this.context,detune:e.detune,frequency:e.frequency,onstop:()=>this.onstop(this),phase:e.phase,type:"triangle"}),this.frequency=this._triangle.frequency,this.detune=this._triangle.detune,this._triangle.chain(this._thresh,this.output),this.width.chain(this._widthGate,this._thresh),(0,a.qt)(this,["width","frequency","detune"])}static getDefaults(){return Object.assign(Source_Source.getDefaults(),{detune:0,frequency:440,phase:0,type:"pulse",width:.2})}_start(e){e=this.toSeconds(e),this._triangle.start(e),this._widthGate.gain.setValueAtTime(1,e)}_stop(e){e=this.toSeconds(e),this._triangle.stop(e),this._widthGate.gain.cancelScheduledValues(e),this._widthGate.gain.setValueAtTime(0,e)}_restart(e){this._triangle.restart(e),this._widthGate.gain.cancelScheduledValues(e),this._widthGate.gain.setValueAtTime(1,e)}get phase(){return this._triangle.phase}set phase(e){this._triangle.phase=e}get type(){return"pulse"}get baseType(){return"pulse"}get partials(){return[]}get partialCount(){return 0}set carrierType(e){this._triangle.type=e}asArray(e=1024){return(0,b.mG)(this,void 0,void 0,function*(){return generateWaveform(this,e)})}dispose(){return super.dispose(),this._triangle.dispose(),this.width.dispose(),this._widthGate.dispose(),this._thresh.dispose(),this}};let FatOscillator=class FatOscillator extends Source_Source{constructor(){super((0,r.Y9)(FatOscillator.getDefaults(),arguments,["frequency","type","spread"])),this.name="FatOscillator",this._oscillators=[];let e=(0,r.Y9)(FatOscillator.getDefaults(),arguments,["frequency","type","spread"]);this.frequency=new Signal_Signal({context:this.context,units:"frequency",value:e.frequency}),this.detune=new Signal_Signal({context:this.context,units:"cents",value:e.detune}),this._spread=e.spread,this._type=e.type,this._phase=e.phase,this._partials=e.partials,this._partialCount=e.partialCount,this.count=e.count,(0,a.qt)(this,["frequency","detune"])}static getDefaults(){return Object.assign(Oscillator_Oscillator.getDefaults(),{count:3,spread:20,type:"sawtooth"})}_start(e){e=this.toSeconds(e),this._forEach(t=>t.start(e))}_stop(e){e=this.toSeconds(e),this._forEach(t=>t.stop(e))}_restart(e){this._forEach(t=>t.restart(e))}_forEach(e){for(let t=0;t<this._oscillators.length;t++)e(this._oscillators[t],t)}get type(){return this._type}set type(e){this._type=e,this._forEach(t=>t.type=e)}get spread(){return this._spread}set spread(e){if(this._spread=e,this._oscillators.length>1){let t=-e/2,n=e/(this._oscillators.length-1);this._forEach((e,i)=>e.detune.value=t+n*i)}}get count(){return this._oscillators.length}set count(e){if((0,u.gI)(e,1),this._oscillators.length!==e){this._forEach(e=>e.dispose()),this._oscillators=[];for(let t=0;t<e;t++){let n=new Oscillator_Oscillator({context:this.context,volume:-6-1.1*e,type:this._type,phase:this._phase+t/e*360,partialCount:this._partialCount,onstop:0===t?()=>this.onstop(this):a.EI});"custom"===this.type&&(n.partials=this._partials),this.frequency.connect(n.frequency),this.detune.connect(n.detune),n.detune.overridden=!1,n.connect(this.output),this._oscillators[t]=n}this.spread=this._spread,"started"===this.state&&this._forEach(e=>e.start())}}get phase(){return this._phase}set phase(e){this._phase=e,this._forEach((e,t)=>e.phase=this._phase+t/this.count*360)}get baseType(){return this._oscillators[0].baseType}set baseType(e){this._forEach(t=>t.baseType=e),this._type=this._oscillators[0].type}get partials(){return this._oscillators[0].partials}set partials(e){this._partials=e,this._partialCount=this._partials.length,e.length&&(this._type="custom",this._forEach(t=>t.partials=e))}get partialCount(){return this._oscillators[0].partialCount}set partialCount(e){this._partialCount=e,this._forEach(t=>t.partialCount=e),this._type=this._oscillators[0].type}asArray(e=1024){return(0,b.mG)(this,void 0,void 0,function*(){return generateWaveform(this,e)})}dispose(){return super.dispose(),this.frequency.dispose(),this.detune.dispose(),this._forEach(e=>e.dispose()),this}};let PWMOscillator=class PWMOscillator extends Source_Source{constructor(){super((0,r.Y9)(PWMOscillator.getDefaults(),arguments,["frequency","modulationFrequency"])),this.name="PWMOscillator",this.sourceType="pwm",this._scale=new Multiply_Multiply({context:this.context,value:2});let e=(0,r.Y9)(PWMOscillator.getDefaults(),arguments,["frequency","modulationFrequency"]);this._pulse=new PulseOscillator({context:this.context,frequency:e.modulationFrequency}),this._pulse.carrierType="sine",this.modulationFrequency=this._pulse.frequency,this._modulator=new Oscillator_Oscillator({context:this.context,detune:e.detune,frequency:e.frequency,onstop:()=>this.onstop(this),phase:e.phase}),this.frequency=this._modulator.frequency,this.detune=this._modulator.detune,this._modulator.chain(this._scale,this._pulse.width),this._pulse.connect(this.output),(0,a.qt)(this,["modulationFrequency","frequency","detune"])}static getDefaults(){return Object.assign(Source_Source.getDefaults(),{detune:0,frequency:440,modulationFrequency:.4,phase:0,type:"pwm"})}_start(e){e=this.toSeconds(e),this._modulator.start(e),this._pulse.start(e)}_stop(e){e=this.toSeconds(e),this._modulator.stop(e),this._pulse.stop(e)}_restart(e){this._modulator.restart(e),this._pulse.restart(e)}get type(){return"pwm"}get baseType(){return"pwm"}get partials(){return[]}get partialCount(){return 0}get phase(){return this._modulator.phase}set phase(e){this._modulator.phase=e}asArray(e=1024){return(0,b.mG)(this,void 0,void 0,function*(){return generateWaveform(this,e)})}dispose(){return super.dispose(),this._pulse.dispose(),this._scale.dispose(),this._modulator.dispose(),this}};let O={am:AMOscillator,fat:FatOscillator,fm:FMOscillator_FMOscillator,oscillator:Oscillator_Oscillator,pulse:PulseOscillator,pwm:PWMOscillator};let OmniOscillator_OmniOscillator=class OmniOscillator_OmniOscillator extends Source_Source{constructor(){super((0,r.Y9)(OmniOscillator_OmniOscillator.getDefaults(),arguments,["frequency","type"])),this.name="OmniOscillator";let e=(0,r.Y9)(OmniOscillator_OmniOscillator.getDefaults(),arguments,["frequency","type"]);this.frequency=new Signal_Signal({context:this.context,units:"frequency",value:e.frequency}),this.detune=new Signal_Signal({context:this.context,units:"cents",value:e.detune}),(0,a.qt)(this,["frequency","detune"]),this.set(e)}static getDefaults(){return Object.assign(Oscillator_Oscillator.getDefaults(),FMOscillator_FMOscillator.getDefaults(),AMOscillator.getDefaults(),FatOscillator.getDefaults(),PulseOscillator.getDefaults(),PWMOscillator.getDefaults())}_start(e){this._oscillator.start(e)}_stop(e){this._oscillator.stop(e)}_restart(e){return this._oscillator.restart(e),this}get type(){let e="";return["am","fm","fat"].some(e=>this._sourceType===e)&&(e=this._sourceType),e+this._oscillator.type}set type(e){"fm"===e.substr(0,2)?(this._createNewOscillator("fm"),this._oscillator=this._oscillator,this._oscillator.type=e.substr(2)):"am"===e.substr(0,2)?(this._createNewOscillator("am"),this._oscillator=this._oscillator,this._oscillator.type=e.substr(2)):"fat"===e.substr(0,3)?(this._createNewOscillator("fat"),this._oscillator=this._oscillator,this._oscillator.type=e.substr(3)):"pwm"===e?(this._createNewOscillator("pwm"),this._oscillator=this._oscillator):"pulse"===e?this._createNewOscillator("pulse"):(this._createNewOscillator("oscillator"),this._oscillator=this._oscillator,this._oscillator.type=e)}get partials(){return this._oscillator.partials}set partials(e){this._getOscType(this._oscillator,"pulse")||this._getOscType(this._oscillator,"pwm")||(this._oscillator.partials=e)}get partialCount(){return this._oscillator.partialCount}set partialCount(e){this._getOscType(this._oscillator,"pulse")||this._getOscType(this._oscillator,"pwm")||(this._oscillator.partialCount=e)}set(e){return Reflect.has(e,"type")&&e.type&&(this.type=e.type),super.set(e),this}_createNewOscillator(e){if(e!==this._sourceType){this._sourceType=e;let t=O[e],n=this.now();if(this._oscillator){let e=this._oscillator;e.stop(n),this.context.setTimeout(()=>e.dispose(),this.blockTime)}this._oscillator=new t({context:this.context}),this.frequency.connect(this._oscillator.frequency),this.detune.connect(this._oscillator.detune),this._oscillator.connect(this.output),this._oscillator.onstop=()=>this.onstop(this),"started"===this.state&&this._oscillator.start(n)}}get phase(){return this._oscillator.phase}set phase(e){this._oscillator.phase=e}get sourceType(){return this._sourceType}set sourceType(e){let t="sine";"pwm"!==this._oscillator.type&&"pulse"!==this._oscillator.type&&(t=this._oscillator.type),"fm"===e?this.type="fm"+t:"am"===e?this.type="am"+t:"fat"===e?this.type="fat"+t:"oscillator"===e?this.type=t:"pulse"===e?this.type="pulse":"pwm"===e&&(this.type="pwm")}_getOscType(e,t){return e instanceof O[t]}get baseType(){return this._oscillator.baseType}set baseType(e){this._getOscType(this._oscillator,"pulse")||this._getOscType(this._oscillator,"pwm")||"pulse"===e||"pwm"===e||(this._oscillator.baseType=e)}get width(){return this._getOscType(this._oscillator,"pulse")?this._oscillator.width:void 0}get count(){return this._getOscType(this._oscillator,"fat")?this._oscillator.count:void 0}set count(e){this._getOscType(this._oscillator,"fat")&&(0,c.hj)(e)&&(this._oscillator.count=e)}get spread(){return this._getOscType(this._oscillator,"fat")?this._oscillator.spread:void 0}set spread(e){this._getOscType(this._oscillator,"fat")&&(0,c.hj)(e)&&(this._oscillator.spread=e)}get modulationType(){return this._getOscType(this._oscillator,"fm")||this._getOscType(this._oscillator,"am")?this._oscillator.modulationType:void 0}set modulationType(e){(this._getOscType(this._oscillator,"fm")||this._getOscType(this._oscillator,"am"))&&(0,c.HD)(e)&&(this._oscillator.modulationType=e)}get modulationIndex(){return this._getOscType(this._oscillator,"fm")?this._oscillator.modulationIndex:void 0}get harmonicity(){return this._getOscType(this._oscillator,"fm")||this._getOscType(this._oscillator,"am")?this._oscillator.harmonicity:void 0}get modulationFrequency(){return this._getOscType(this._oscillator,"pwm")?this._oscillator.modulationFrequency:void 0}asArray(e=1024){return(0,b.mG)(this,void 0,void 0,function*(){return generateWaveform(this,e)})}dispose(){return super.dispose(),this.detune.dispose(),this.frequency.dispose(),this._oscillator.dispose(),this}};let Add_Add=class Add_Add extends Signal_Signal{constructor(){super(Object.assign((0,r.Y9)(Add_Add.getDefaults(),arguments,["value"]))),this.override=!1,this.name="Add",this._sum=new f.S({context:this.context}),this.input=this._sum,this.output=this._sum,this.addend=this._param,(0,d.ft)(this._constantSource,this._sum)}static getDefaults(){return Object.assign(Signal_Signal.getDefaults(),{value:0})}dispose(){return super.dispose(),this._sum.dispose(),this}};let Scale_Scale=class Scale_Scale extends SignalOperator_SignalOperator{constructor(){super(Object.assign((0,r.Y9)(Scale_Scale.getDefaults(),arguments,["min","max"]))),this.name="Scale";let e=(0,r.Y9)(Scale_Scale.getDefaults(),arguments,["min","max"]);this._mult=this.input=new Multiply_Multiply({context:this.context,value:e.max-e.min}),this._add=this.output=new Add_Add({context:this.context,value:e.min}),this._min=e.min,this._max=e.max,this.input.connect(this.output)}static getDefaults(){return Object.assign(SignalOperator_SignalOperator.getDefaults(),{max:1,min:0})}get min(){return this._min}set min(e){this._min=e,this._setRange()}get max(){return this._max}set max(e){this._max=e,this._setRange()}_setRange(){this._add.value=this._min,this._mult.value=this._max-this._min}dispose(){return super.dispose(),this._add.dispose(),this._mult.dispose(),this}};let Zero=class Zero extends SignalOperator_SignalOperator{constructor(){super(Object.assign((0,r.Y9)(Zero.getDefaults(),arguments))),this.name="Zero",this._gain=new f.S({context:this.context}),this.output=this._gain,this.input=void 0,(0,d.$j)(this.context.getConstant(0),this._gain)}dispose(){return super.dispose(),(0,d.zP)(this.context.getConstant(0),this._gain),this}};let LFO_LFO=class LFO_LFO extends d.HD{constructor(){super((0,r.Y9)(LFO_LFO.getDefaults(),arguments,["frequency","min","max"])),this.name="LFO",this._stoppedValue=0,this._units="number",this.convert=!0,this._fromType=h.d.prototype._fromType,this._toType=h.d.prototype._toType,this._is=h.d.prototype._is,this._clampValue=h.d.prototype._clampValue;let e=(0,r.Y9)(LFO_LFO.getDefaults(),arguments,["frequency","min","max"]);this._oscillator=new Oscillator_Oscillator(e),this.frequency=this._oscillator.frequency,this._amplitudeGain=new f.S({context:this.context,gain:e.amplitude,units:"normalRange"}),this.amplitude=this._amplitudeGain.gain,this._stoppedSignal=new Signal_Signal({context:this.context,units:"audioRange",value:0}),this._zeros=new Zero({context:this.context}),this._a2g=new AudioToGain_AudioToGain({context:this.context}),this._scaler=this.output=new Scale_Scale({context:this.context,max:e.max,min:e.min}),this.units=e.units,this.min=e.min,this.max=e.max,this._oscillator.chain(this._amplitudeGain,this._a2g,this._scaler),this._zeros.connect(this._a2g),this._stoppedSignal.connect(this._a2g),(0,a.qt)(this,["amplitude","frequency"]),this.phase=e.phase}static getDefaults(){return Object.assign(Oscillator_Oscillator.getDefaults(),{amplitude:1,frequency:"4n",max:1,min:0,type:"sine",units:"number"})}start(e){return e=this.toSeconds(e),this._stoppedSignal.setValueAtTime(0,e),this._oscillator.start(e),this}stop(e){return e=this.toSeconds(e),this._stoppedSignal.setValueAtTime(this._stoppedValue,e),this._oscillator.stop(e),this}sync(){return this._oscillator.sync(),this._oscillator.syncFrequency(),this}unsync(){return this._oscillator.unsync(),this._oscillator.unsyncFrequency(),this}_setStoppedValue(){this._stoppedValue=this._oscillator.getInitialValue(),this._stoppedSignal.value=this._stoppedValue}get min(){return this._toType(this._scaler.min)}set min(e){e=this._fromType(e),this._scaler.min=e}get max(){return this._toType(this._scaler.max)}set max(e){e=this._fromType(e),this._scaler.max=e}get type(){return this._oscillator.type}set type(e){this._oscillator.type=e,this._setStoppedValue()}get partials(){return this._oscillator.partials}set partials(e){this._oscillator.partials=e,this._setStoppedValue()}get phase(){return this._oscillator.phase}set phase(e){this._oscillator.phase=e,this._setStoppedValue()}get units(){return this._units}set units(e){let t=this.min,n=this.max;this._units=e,this.min=t,this.max=n}get state(){return this._oscillator.state}connect(e,t,n){return(e instanceof h.d||e instanceof Signal_Signal)&&(this.convert=e.convert,this.units=e.units),connectSignal(this,e,t,n),this}dispose(){return super.dispose(),this._oscillator.dispose(),this._stoppedSignal.dispose(),this._zeros.dispose(),this._scaler.dispose(),this._a2g.dispose(),this._amplitudeGain.dispose(),this.amplitude.dispose(),this}};function range(e,t=1/0){let n=new WeakMap;return function(i,s){Reflect.defineProperty(i,s,{configurable:!0,enumerable:!0,get:function(){return n.get(this)},set:function(i){(0,u.gI)(i,e,t),n.set(this,i)}})}}function timeRange(e,t=1/0){let n=new WeakMap;return function(i,s){Reflect.defineProperty(i,s,{configurable:!0,enumerable:!0,get:function(){return n.get(this)},set:function(i){(0,u.gI)(this.toSeconds(i),e,t),n.set(this,i)}})}}let Player_Player=class Player_Player extends Source_Source{constructor(){super((0,r.Y9)(Player_Player.getDefaults(),arguments,["url","onload"])),this.name="Player",this._activeSources=new Set;let e=(0,r.Y9)(Player_Player.getDefaults(),arguments,["url","onload"]);this._buffer=new v.p({onload:this._onload.bind(this,e.onload),onerror:e.onerror,reverse:e.reverse,url:e.url}),this.autostart=e.autostart,this._loop=e.loop,this._loopStart=e.loopStart,this._loopEnd=e.loopEnd,this._playbackRate=e.playbackRate,this.fadeIn=e.fadeIn,this.fadeOut=e.fadeOut}static getDefaults(){return Object.assign(Source_Source.getDefaults(),{autostart:!1,fadeIn:0,fadeOut:0,loop:!1,loopEnd:0,loopStart:0,onload:a.EI,onerror:a.EI,playbackRate:1,reverse:!1})}load(e){return(0,b.mG)(this,void 0,void 0,function*(){return yield this._buffer.load(e),this._onload(),this})}_onload(e=a.EI){e(),this.autostart&&this.start()}_onSourceEnd(e){this.onstop(this),this._activeSources.delete(e),0!==this._activeSources.size||this._synced||"started"!==this._state.getValueAtTime(this.now())||(this._state.cancel(this.now()),this._state.setStateAtTime("stopped",this.now()))}start(e,t,n){return super.start(e,t,n),this}_start(e,t,n){t=this._loop?(0,r.PK)(t,this._loopStart):(0,r.PK)(t,0);let i=this.toSeconds(t),s=n;n=(0,r.PK)(n,Math.max(this._buffer.duration-i,0));let o=this.toSeconds(n);o/=this._playbackRate,e=this.toSeconds(e);let a=new ToneBufferSource_ToneBufferSource({url:this._buffer,context:this.context,fadeIn:this.fadeIn,fadeOut:this.fadeOut,loop:this._loop,loopEnd:this._loopEnd,loopStart:this._loopStart,onended:this._onSourceEnd.bind(this),playbackRate:this._playbackRate}).connect(this.output);this._loop||this._synced||(this._state.cancel(e+o),this._state.setStateAtTime("stopped",e+o,{implicitEnd:!0})),this._activeSources.add(a),this._loop&&(0,c.G7)(s)?a.start(e,i):a.start(e,i,o-this.toSeconds(this.fadeOut))}_stop(e){let t=this.toSeconds(e);this._activeSources.forEach(e=>e.stop(t))}restart(e,t,n){return super.restart(e,t,n),this}_restart(e,t,n){this._stop(e),this._start(e,t,n)}seek(e,t){let n=this.toSeconds(t);if("started"===this._state.getValueAtTime(n)){let t=this.toSeconds(e);this._stop(n),this._start(n,t)}return this}setLoopPoints(e,t){return this.loopStart=e,this.loopEnd=t,this}get loopStart(){return this._loopStart}set loopStart(e){this._loopStart=e,this.buffer.loaded&&(0,u.gI)(this.toSeconds(e),0,this.buffer.duration),this._activeSources.forEach(t=>{t.loopStart=e})}get loopEnd(){return this._loopEnd}set loopEnd(e){this._loopEnd=e,this.buffer.loaded&&(0,u.gI)(this.toSeconds(e),0,this.buffer.duration),this._activeSources.forEach(t=>{t.loopEnd=e})}get buffer(){return this._buffer}set buffer(e){this._buffer.set(e)}get loop(){return this._loop}set loop(e){if(this._loop!==e&&(this._loop=e,this._activeSources.forEach(t=>{t.loop=e}),e)){let e=this._state.getNextState("stopped",this.now());e&&this._state.cancel(e.time)}}get playbackRate(){return this._playbackRate}set playbackRate(e){this._playbackRate=e;let t=this.now(),n=this._state.getNextState("stopped",t);n&&n.implicitEnd&&(this._state.cancel(n.time),this._activeSources.forEach(e=>e.cancelStop())),this._activeSources.forEach(n=>{n.playbackRate.setValueAtTime(e,t)})}get reverse(){return this._buffer.reverse}set reverse(e){this._buffer.reverse=e}get loaded(){return this._buffer.loaded}dispose(){return super.dispose(),this._activeSources.forEach(e=>e.dispose()),this._activeSources.clear(),this._buffer.dispose(),this}};(0,b.gn)([timeRange(0)],Player_Player.prototype,"fadeIn",void 0),(0,b.gn)([timeRange(0)],Player_Player.prototype,"fadeOut",void 0);let GainToAudio=class GainToAudio extends SignalOperator_SignalOperator{constructor(){super(...arguments),this.name="GainToAudio",this._norm=new WaveShaper_WaveShaper({context:this.context,mapping:e=>2*Math.abs(e)-1}),this.input=this._norm,this.output=this._norm}dispose(){return super.dispose(),this._norm.dispose(),this}};let Envelope_Envelope=class Envelope_Envelope extends d.HD{constructor(){super((0,r.Y9)(Envelope_Envelope.getDefaults(),arguments,["attack","decay","sustain","release"])),this.name="Envelope",this._sig=new Signal_Signal({context:this.context,value:0}),this.output=this._sig,this.input=void 0;let e=(0,r.Y9)(Envelope_Envelope.getDefaults(),arguments,["attack","decay","sustain","release"]);this.attack=e.attack,this.decay=e.decay,this.sustain=e.sustain,this.release=e.release,this.attackCurve=e.attackCurve,this.releaseCurve=e.releaseCurve,this.decayCurve=e.decayCurve}static getDefaults(){return Object.assign(d.HD.getDefaults(),{attack:.01,attackCurve:"linear",decay:.1,decayCurve:"exponential",release:1,releaseCurve:"exponential",sustain:.5})}get value(){return this.getValueAtTime(this.now())}_getCurve(e,t){if((0,c.HD)(e))return e;{let n;for(n in k)if(k[n][t]===e)return n;return e}}_setCurve(e,t,n){if((0,c.HD)(n)&&Reflect.has(k,n)){let i=k[n];(0,c.Kn)(i)?"_decayCurve"!==e&&(this[e]=i[t]):this[e]=i}else if((0,c.kJ)(n)&&"_decayCurve"!==e)this[e]=n;else throw Error("Envelope: invalid curve: "+n)}get attackCurve(){return this._getCurve(this._attackCurve,"In")}set attackCurve(e){this._setCurve("_attackCurve","In",e)}get releaseCurve(){return this._getCurve(this._releaseCurve,"Out")}set releaseCurve(e){this._setCurve("_releaseCurve","Out",e)}get decayCurve(){return this._decayCurve}set decayCurve(e){(0,u.hu)(["linear","exponential"].some(t=>t===e),`Invalid envelope curve: ${e}`),this._decayCurve=e}triggerAttack(e,t=1){this.log("triggerAttack",e,t),e=this.toSeconds(e);let n=this.toSeconds(this.attack),i=n,s=this.toSeconds(this.decay),r=this.getValueAtTime(e);if(r>0){let e=1/i;i=(1-r)/e}if(i<this.sampleTime)this._sig.cancelScheduledValues(e),this._sig.setValueAtTime(t,e);else if("linear"===this._attackCurve)this._sig.linearRampTo(t,i,e);else if("exponential"===this._attackCurve)this._sig.targetRampTo(t,i,e);else{this._sig.cancelAndHoldAtTime(e);let n=this._attackCurve;for(let e=1;e<n.length;e++)if(n[e-1]<=r&&r<=n[e]){(n=this._attackCurve.slice(e))[0]=r;break}this._sig.setValueCurveAtTime(n,e,i,t)}if(s&&this.sustain<1){let n=t*this.sustain,r=e+i;this.log("decay",r),"linear"===this._decayCurve?this._sig.linearRampToValueAtTime(n,s+r):this._sig.exponentialApproachValueAtTime(n,r,s)}return this}triggerRelease(e){this.log("triggerRelease",e),e=this.toSeconds(e);let t=this.getValueAtTime(e);if(t>0){let n=this.toSeconds(this.release);n<this.sampleTime?this._sig.setValueAtTime(0,e):"linear"===this._releaseCurve?this._sig.linearRampTo(0,n,e):"exponential"===this._releaseCurve?this._sig.targetRampTo(0,n,e):((0,u.hu)((0,c.kJ)(this._releaseCurve),"releaseCurve must be either 'linear', 'exponential' or an array"),this._sig.cancelAndHoldAtTime(e),this._sig.setValueCurveAtTime(this._releaseCurve,e,n,t))}return this}getValueAtTime(e){return this._sig.getValueAtTime(e)}triggerAttackRelease(e,t,n=1){return t=this.toSeconds(t),this.triggerAttack(t,n),this.triggerRelease(t+this.toSeconds(e)),this}cancel(e){return this._sig.cancelScheduledValues(this.toSeconds(e)),this}connect(e,t=0,n=0){return connectSignal(this,e,t,n),this}asArray(e=1024){return(0,b.mG)(this,void 0,void 0,function*(){let t=e/this.context.sampleRate,n=new g.n(1,t,this.context.sampleRate),i=this.toSeconds(this.attack)+this.toSeconds(this.decay),s=i+this.toSeconds(this.release),r=.1*s,o=s+r,a=new this.constructor(Object.assign(this.get(),{attack:t*this.toSeconds(this.attack)/o,decay:t*this.toSeconds(this.decay)/o,release:t*this.toSeconds(this.release)/o,context:n}));a._sig.toDestination(),a.triggerAttackRelease(t*(i+r)/o,0);let l=yield n.render();return l.getChannelData(0)})}dispose(){return super.dispose(),this._sig.dispose(),this}};(0,b.gn)([timeRange(0)],Envelope_Envelope.prototype,"attack",void 0),(0,b.gn)([timeRange(0)],Envelope_Envelope.prototype,"decay",void 0),(0,b.gn)([range(0,1)],Envelope_Envelope.prototype,"sustain",void 0),(0,b.gn)([timeRange(0)],Envelope_Envelope.prototype,"release",void 0);let k=(()=>{let e,t;let n=[];for(e=0;e<128;e++)n[e]=Math.sin(e/127*(Math.PI/2));let i=[];for(e=0;e<127;e++){t=e/127;let n=Math.sin(t*(2*Math.PI)*6.4-Math.PI/2)+1;i[e]=n/10+.83*t}i[127]=1;let s=[];for(e=0;e<128;e++)s[e]=Math.ceil(e/127*5)/5;let r=[];for(e=0;e<128;e++)t=e/127,r[e]=.5*(1-Math.cos(Math.PI*t));let o=[];for(e=0;e<128;e++){t=e/127;let n=4*Math.pow(t,3)+.2,i=Math.cos(n*Math.PI*2*t);o[e]=Math.abs(i*(1-t))}function invertCurve(e){let t=Array(e.length);for(let n=0;n<e.length;n++)t[n]=1-e[n];return t}return{bounce:{In:invertCurve(o),Out:o},cosine:{In:n,Out:n.slice(0).reverse()},exponential:"exponential",linear:"linear",ripple:{In:i,Out:invertCurve(i)},sine:{In:r,Out:invertCurve(r)},step:{In:s,Out:invertCurve(s)}}})();var M=n(5657);let Monophonic_Monophonic=class Monophonic_Monophonic extends M.Y{constructor(){super((0,r.Y9)(Monophonic_Monophonic.getDefaults(),arguments));let e=(0,r.Y9)(Monophonic_Monophonic.getDefaults(),arguments);this.portamento=e.portamento,this.onsilence=e.onsilence}static getDefaults(){return Object.assign(M.Y.getDefaults(),{detune:0,onsilence:a.EI,portamento:0})}triggerAttack(e,t,n=1){this.log("triggerAttack",e,t,n);let i=this.toSeconds(t);return this._triggerEnvelopeAttack(i,n),this.setNote(e,i),this}triggerRelease(e){this.log("triggerRelease",e);let t=this.toSeconds(e);return this._triggerEnvelopeRelease(t),this}setNote(e,t){let n=this.toSeconds(t),i=e instanceof A.W?e.toFrequency():e;if(this.portamento>0&&this.getLevelAtTime(n)>.05){let e=this.toSeconds(this.portamento);this.frequency.exponentialRampTo(i,e,n)}else this.frequency.setValueAtTime(i,n);return this}};(0,b.gn)([timeRange(0)],Monophonic_Monophonic.prototype,"portamento",void 0);let AmplitudeEnvelope_AmplitudeEnvelope=class AmplitudeEnvelope_AmplitudeEnvelope extends Envelope_Envelope{constructor(){super((0,r.Y9)(AmplitudeEnvelope_AmplitudeEnvelope.getDefaults(),arguments,["attack","decay","sustain","release"])),this.name="AmplitudeEnvelope",this._gainNode=new f.S({context:this.context,gain:0}),this.output=this._gainNode,this.input=this._gainNode,this._sig.connect(this._gainNode.gain),this.output=this._gainNode,this.input=this._gainNode}dispose(){return super.dispose(),this._gainNode.dispose(),this}};let Synth_Synth=class Synth_Synth extends Monophonic_Monophonic{constructor(){super((0,r.Y9)(Synth_Synth.getDefaults(),arguments)),this.name="Synth";let e=(0,r.Y9)(Synth_Synth.getDefaults(),arguments);this.oscillator=new OmniOscillator_OmniOscillator(Object.assign({context:this.context,detune:e.detune,onstop:()=>this.onsilence(this)},e.oscillator)),this.frequency=this.oscillator.frequency,this.detune=this.oscillator.detune,this.envelope=new AmplitudeEnvelope_AmplitudeEnvelope(Object.assign({context:this.context},e.envelope)),this.oscillator.chain(this.envelope,this.output),(0,a.qt)(this,["oscillator","frequency","detune","envelope"])}static getDefaults(){return Object.assign(Monophonic_Monophonic.getDefaults(),{envelope:Object.assign((0,r.nS)(Envelope_Envelope.getDefaults(),Object.keys(d.HD.getDefaults())),{attack:.005,decay:.1,release:1,sustain:.3}),oscillator:Object.assign((0,r.nS)(OmniOscillator_OmniOscillator.getDefaults(),[...Object.keys(Source_Source.getDefaults()),"frequency","detune"]),{type:"triangle"})})}_triggerEnvelopeAttack(e,t){if(this.envelope.triggerAttack(e,t),this.oscillator.start(e),0===this.envelope.sustain){let t=this.toSeconds(this.envelope.attack),n=this.toSeconds(this.envelope.decay);this.oscillator.stop(e+t+n)}}_triggerEnvelopeRelease(e){this.envelope.triggerRelease(e),this.oscillator.stop(e+this.toSeconds(this.envelope.release))}getLevelAtTime(e){return e=this.toSeconds(e),this.envelope.getValueAtTime(e)}dispose(){return super.dispose(),this.oscillator.dispose(),this.envelope.dispose(),this}};let MembraneSynth=class MembraneSynth extends Synth_Synth{constructor(){super((0,r.Y9)(MembraneSynth.getDefaults(),arguments)),this.name="MembraneSynth",this.portamento=0;let e=(0,r.Y9)(MembraneSynth.getDefaults(),arguments);this.pitchDecay=e.pitchDecay,this.octaves=e.octaves,(0,a.qt)(this,["oscillator","envelope"])}static getDefaults(){return(0,r.RH)(Monophonic_Monophonic.getDefaults(),Synth_Synth.getDefaults(),{envelope:{attack:.001,attackCurve:"exponential",decay:.4,release:1.4,sustain:.01},octaves:10,oscillator:{type:"sine"},pitchDecay:.05})}setNote(e,t){let n=this.toSeconds(t),i=this.toFrequency(e instanceof A.W?e.toFrequency():e),s=i*this.octaves;return this.oscillator.frequency.setValueAtTime(s,n),this.oscillator.frequency.exponentialRampToValueAtTime(i,n+this.toSeconds(this.pitchDecay)),this}dispose(){return super.dispose(),this}};(0,b.gn)([range(0)],MembraneSynth.prototype,"octaves",void 0),(0,b.gn)([timeRange(0)],MembraneSynth.prototype,"pitchDecay",void 0);let E=new Set;function registerProcessor(e,t){let n=`registerProcessor("${e}", ${t})`;E.add(n)}let ToneAudioWorklet_ToneAudioWorklet=class ToneAudioWorklet_ToneAudioWorklet extends d.HD{constructor(e){super(e),this.name="ToneAudioWorklet",this.workletOptions={},this.onprocessorerror=a.EI;let t=URL.createObjectURL(new Blob([Array.from(E).join("\n")],{type:"text/javascript"})),n=this._audioWorkletName();this._dummyGain=this.context.createGain(),this._dummyParam=this._dummyGain.gain,this.context.addAudioWorkletModule(t,n).then(()=>{this.disposed||(this._worklet=this.context.createAudioWorkletNode(n,this.workletOptions),this._worklet.onprocessorerror=this.onprocessorerror.bind(this),this.onReady(this._worklet))})}dispose(){return super.dispose(),this._dummyGain.disconnect(),this._worklet&&(this._worklet.port.postMessage("dispose"),this._worklet.disconnect()),this}};let D=`
	/**
	 * The base AudioWorkletProcessor for use in Tone.js. Works with the [[ToneAudioWorklet]]. 
	 */
	class ToneAudioWorkletProcessor extends AudioWorkletProcessor {

		constructor(options) {
			
			super(options);
			/**
			 * If the processor was disposed or not. Keep alive until it's disposed.
			 */
			this.disposed = false;
		   	/** 
			 * The number of samples in the processing block
			 */
			this.blockSize = 128;
			/**
			 * the sample rate
			 */
			this.sampleRate = sampleRate;

			this.port.onmessage = (event) => {
				// when it receives a dispose 
				if (event.data === "dispose") {
					this.disposed = true;
				}
			};
		}
	}
`;E.add(D);let I=`
	/**
	 * Abstract class for a single input/output processor. 
	 * has a 'generate' function which processes one sample at a time
	 */
	class SingleIOProcessor extends ToneAudioWorkletProcessor {

		constructor(options) {
			super(Object.assign(options, {
				numberOfInputs: 1,
				numberOfOutputs: 1
			}));
			/**
			 * Holds the name of the parameter and a single value of that
			 * parameter at the current sample
			 * @type { [name: string]: number }
			 */
			this.params = {}
		}

		/**
		 * Generate an output sample from the input sample and parameters
		 * @abstract
		 * @param input number
		 * @param channel number
		 * @param parameters { [name: string]: number }
		 * @returns number
		 */
		generate(){}

		/**
		 * Update the private params object with the 
		 * values of the parameters at the given index
		 * @param parameters { [name: string]: Float32Array },
		 * @param index number
		 */
		updateParams(parameters, index) {
			for (const paramName in parameters) {
				const param = parameters[paramName];
				if (param.length > 1) {
					this.params[paramName] = parameters[paramName][index];
				} else {
					this.params[paramName] = parameters[paramName][0];
				}
			}
		}

		/**
		 * Process a single frame of the audio
		 * @param inputs Float32Array[][]
		 * @param outputs Float32Array[][]
		 */
		process(inputs, outputs, parameters) {
			const input = inputs[0];
			const output = outputs[0];
			// get the parameter values
			const channelCount = Math.max(input && input.length || 0, output.length);
			for (let sample = 0; sample < this.blockSize; sample++) {
				this.updateParams(parameters, sample);
				for (let channel = 0; channel < channelCount; channel++) {
					const inputSample = input && input.length ? input[channel][sample] : 0;
					output[channel][sample] = this.generate(inputSample, channel, this.params);
				}
			}
			return !this.disposed;
		}
	};
`;E.add(I);let P=`
	/**
	 * A multichannel buffer for use within an AudioWorkletProcessor as a delay line
	 */
	class DelayLine {
		
		constructor(size, channels) {
			this.buffer = [];
			this.writeHead = []
			this.size = size;

			// create the empty channels
			for (let i = 0; i < channels; i++) {
				this.buffer[i] = new Float32Array(this.size);
				this.writeHead[i] = 0;
			}
		}

		/**
		 * Push a value onto the end
		 * @param channel number
		 * @param value number
		 */
		push(channel, value) {
			this.writeHead[channel] += 1;
			if (this.writeHead[channel] > this.size) {
				this.writeHead[channel] = 0;
			}
			this.buffer[channel][this.writeHead[channel]] = value;
		}

		/**
		 * Get the recorded value of the channel given the delay
		 * @param channel number
		 * @param delay number delay samples
		 */
		get(channel, delay) {
			let readHead = this.writeHead[channel] - Math.floor(delay);
			if (readHead < 0) {
				readHead += this.size;
			}
			return this.buffer[channel][readHead];
		}
	}
`;E.add(P);let R=`
	class FeedbackCombFilterWorklet extends SingleIOProcessor {

		constructor(options) {
			super(options);
			this.delayLine = new DelayLine(this.sampleRate, options.channelCount || 2);
		}

		static get parameterDescriptors() {
			return [{
				name: "delayTime",
				defaultValue: 0.1,
				minValue: 0,
				maxValue: 1,
				automationRate: "k-rate"
			}, {
				name: "feedback",
				defaultValue: 0.5,
				minValue: 0,
				maxValue: 0.9999,
				automationRate: "k-rate"
			}];
		}

		generate(input, channel, parameters) {
			const delayedSample = this.delayLine.get(channel, parameters.delayTime * this.sampleRate);
			this.delayLine.push(channel, input + delayedSample * parameters.feedback);
			return delayedSample;
		}
	}
`;registerProcessor("feedback-comb-filter",R);var F=n(1205);let Sampler=class Sampler extends M.Y{constructor(){super((0,r.Y9)(Sampler.getDefaults(),arguments,["urls","onload","baseUrl"],"urls")),this.name="Sampler",this._activeSources=new Map;let e=(0,r.Y9)(Sampler.getDefaults(),arguments,["urls","onload","baseUrl"],"urls"),t={};Object.keys(e.urls).forEach(n=>{let i=parseInt(n,10);if((0,u.hu)((0,c.gi)(n)||(0,c.hj)(i)&&isFinite(i),`url key is neither a note or midi pitch: ${n}`),(0,c.gi)(n)){let i=new A.W(this.context,n).toMidi();t[i]=e.urls[n]}else(0,c.hj)(i)&&isFinite(i)&&(t[i]=e.urls[i])}),this._buffers=new ToneAudioBuffers_ToneAudioBuffers({urls:t,onload:e.onload,baseUrl:e.baseUrl,onerror:e.onerror}),this.attack=e.attack,this.release=e.release,this.curve=e.curve,this._buffers.loaded&&Promise.resolve().then(e.onload)}static getDefaults(){return Object.assign(M.Y.getDefaults(),{attack:0,baseUrl:"",curve:"exponential",onload:a.EI,onerror:a.EI,release:.1,urls:{}})}_findClosest(e){let t=0;for(;t<96;){if(this._buffers.has(e+t))return-t;if(this._buffers.has(e-t))return t;t++}throw Error(`No available buffers for note: ${e}`)}triggerAttack(e,t,n=1){return this.log("triggerAttack",e,t,n),Array.isArray(e)||(e=[e]),e.forEach(e=>{let i=(0,F._0)(new A.W(this.context,e).toFrequency()),s=Math.round(i),r=i-s,o=this._findClosest(s),a=s-o,l=this._buffers.get(a),u=(0,F.Im)(o+r),h=new ToneBufferSource_ToneBufferSource({url:l,context:this.context,curve:this.curve,fadeIn:this.attack,fadeOut:this.release,playbackRate:u}).connect(this.output);h.start(t,0,l.duration/u,n),(0,c.kJ)(this._activeSources.get(s))||this._activeSources.set(s,[]),this._activeSources.get(s).push(h),h.onended=()=>{if(this._activeSources&&this._activeSources.has(s)){let e=this._activeSources.get(s),t=e.indexOf(h);-1!==t&&e.splice(t,1)}}}),this}triggerRelease(e,t){return this.log("triggerRelease",e,t),Array.isArray(e)||(e=[e]),e.forEach(e=>{let n=new A.W(this.context,e).toMidi();if(this._activeSources.has(n)&&this._activeSources.get(n).length){let e=this._activeSources.get(n);t=this.toSeconds(t),e.forEach(e=>{e.stop(t)}),this._activeSources.set(n,[])}}),this}releaseAll(e){let t=this.toSeconds(e);return this._activeSources.forEach(e=>{for(;e.length;){let n=e.shift();n.stop(t)}}),this}sync(){return this._syncState()&&(this._syncMethod("triggerAttack",1),this._syncMethod("triggerRelease",1)),this}triggerAttackRelease(e,t,n,i=1){let s=this.toSeconds(n);return this.triggerAttack(e,s,i),(0,c.kJ)(t)?((0,u.hu)((0,c.kJ)(e),"notes must be an array when duration is array"),e.forEach((e,n)=>{let i=t[Math.min(n,t.length-1)];this.triggerRelease(e,s+this.toSeconds(i))})):this.triggerRelease(e,s+this.toSeconds(t)),this}add(e,t,n){if((0,u.hu)((0,c.gi)(e)||isFinite(e),`note must be a pitch or midi: ${e}`),(0,c.gi)(e)){let i=new A.W(this.context,e).toMidi();this._buffers.add(i,t,n)}else this._buffers.add(e,t,n);return this}get loaded(){return this._buffers.loaded}dispose(){return super.dispose(),this._buffers.dispose(),this._activeSources.forEach(e=>{e.forEach(e=>e.dispose())}),this._activeSources.clear(),this}};(0,b.gn)([timeRange(0)],Sampler.prototype,"attack",void 0),(0,b.gn)([timeRange(0)],Sampler.prototype,"release",void 0);let CrossFade=class CrossFade extends d.HD{constructor(){super(Object.assign((0,r.Y9)(CrossFade.getDefaults(),arguments,["fade"]))),this.name="CrossFade",this._panner=this.context.createStereoPanner(),this._split=this.context.createChannelSplitter(2),this._g2a=new GainToAudio({context:this.context}),this.a=new f.S({context:this.context,gain:0}),this.b=new f.S({context:this.context,gain:0}),this.output=new f.S({context:this.context}),this._internalChannels=[this.a,this.b];let e=(0,r.Y9)(CrossFade.getDefaults(),arguments,["fade"]);this.fade=new Signal_Signal({context:this.context,units:"normalRange",value:e.fade}),(0,a.qt)(this,"fade"),this.context.getConstant(1).connect(this._panner),this._panner.connect(this._split),this._panner.channelCount=1,this._panner.channelCountMode="explicit",(0,d.$j)(this._split,this.a.gain,0),(0,d.$j)(this._split,this.b.gain,1),this.fade.chain(this._g2a,this._panner.pan),this.a.connect(this.output),this.b.connect(this.output)}static getDefaults(){return Object.assign(d.HD.getDefaults(),{fade:.5})}dispose(){return super.dispose(),this.a.dispose(),this.b.dispose(),this.output.dispose(),this.fade.dispose(),this._g2a.dispose(),this._panner.disconnect(),this._split.disconnect(),this}};let Effect_Effect=class Effect_Effect extends d.HD{constructor(e){super(e),this.name="Effect",this._dryWet=new CrossFade({context:this.context}),this.wet=this._dryWet.fade,this.effectSend=new f.S({context:this.context}),this.effectReturn=new f.S({context:this.context}),this.input=new f.S({context:this.context}),this.output=this._dryWet,this.input.fan(this._dryWet.a,this.effectSend),this.effectReturn.connect(this._dryWet.b),this.wet.setValueAtTime(e.wet,0),this._internalChannels=[this.effectReturn,this.effectSend],(0,a.qt)(this,"wet")}static getDefaults(){return Object.assign(d.HD.getDefaults(),{wet:1})}connectEffect(e){return this._internalChannels.push(e),this.effectSend.chain(e,this.effectReturn),this}dispose(){return super.dispose(),this._dryWet.dispose(),this.effectSend.dispose(),this.effectReturn.dispose(),this.wet.dispose(),this}};let Panner_Panner=class Panner_Panner extends d.HD{constructor(){super(Object.assign((0,r.Y9)(Panner_Panner.getDefaults(),arguments,["pan"]))),this.name="Panner",this._panner=this.context.createStereoPanner(),this.input=this._panner,this.output=this._panner;let e=(0,r.Y9)(Panner_Panner.getDefaults(),arguments,["pan"]);this.pan=new h.d({context:this.context,param:this._panner.pan,value:e.pan,minValue:-1,maxValue:1}),this._panner.channelCount=e.channelCount,this._panner.channelCountMode="explicit",(0,a.qt)(this,"pan")}static getDefaults(){return Object.assign(d.HD.getDefaults(),{pan:0,channelCount:1})}dispose(){return super.dispose(),this._panner.disconnect(),this.pan.dispose(),this}};let V="bit-crusher",q=`
	class BitCrusherWorklet extends SingleIOProcessor {

		static get parameterDescriptors() {
			return [{
				name: "bits",
				defaultValue: 12,
				minValue: 1,
				maxValue: 16,
				automationRate: 'k-rate'
			}];
		}

		generate(input, _channel, parameters) {
			const step = Math.pow(0.5, parameters.bits - 1);
			const val = step * Math.floor(input / step + 0.5);
			return val;
		}
	}
`;registerProcessor(V,q);let BitCrusher=class BitCrusher extends Effect_Effect{constructor(){super((0,r.Y9)(BitCrusher.getDefaults(),arguments,["bits"])),this.name="BitCrusher";let e=(0,r.Y9)(BitCrusher.getDefaults(),arguments,["bits"]);this._bitCrusherWorklet=new BitCrusherWorklet({context:this.context,bits:e.bits}),this.connectEffect(this._bitCrusherWorklet),this.bits=this._bitCrusherWorklet.bits}static getDefaults(){return Object.assign(Effect_Effect.getDefaults(),{bits:4})}dispose(){return super.dispose(),this._bitCrusherWorklet.dispose(),this}};let BitCrusherWorklet=class BitCrusherWorklet extends ToneAudioWorklet_ToneAudioWorklet{constructor(){super((0,r.Y9)(BitCrusherWorklet.getDefaults(),arguments)),this.name="BitCrusherWorklet";let e=(0,r.Y9)(BitCrusherWorklet.getDefaults(),arguments);this.input=new f.S({context:this.context}),this.output=new f.S({context:this.context}),this.bits=new h.d({context:this.context,value:e.bits,units:"positive",minValue:1,maxValue:16,param:this._dummyParam,swappable:!0})}static getDefaults(){return Object.assign(ToneAudioWorklet_ToneAudioWorklet.getDefaults(),{bits:12})}_audioWorkletName(){return V}onReady(e){(0,d.ft)(this.input,e,this.output);let t=e.parameters.get("bits");this.bits.setParam(t)}dispose(){return super.dispose(),this.input.dispose(),this.output.dispose(),this.bits.dispose(),this}};let Split_Split=class Split_Split extends d.HD{constructor(){super((0,r.Y9)(Split_Split.getDefaults(),arguments,["channels"])),this.name="Split";let e=(0,r.Y9)(Split_Split.getDefaults(),arguments,["channels"]);this._splitter=this.input=this.output=this.context.createChannelSplitter(e.channels),this._internalChannels=[this._splitter]}static getDefaults(){return Object.assign(d.HD.getDefaults(),{channels:2})}dispose(){return super.dispose(),this._splitter.disconnect(),this}};let Merge_Merge=class Merge_Merge extends d.HD{constructor(){super((0,r.Y9)(Merge_Merge.getDefaults(),arguments,["channels"])),this.name="Merge";let e=(0,r.Y9)(Merge_Merge.getDefaults(),arguments,["channels"]);this._merger=this.output=this.input=this.context.createChannelMerger(e.channels)}static getDefaults(){return Object.assign(d.HD.getDefaults(),{channels:2})}dispose(){return super.dispose(),this._merger.disconnect(),this}};let StereoEffect_StereoEffect=class StereoEffect_StereoEffect extends d.HD{constructor(e){super(e),this.name="StereoEffect",this.input=new f.S({context:this.context}),this.input.channelCount=2,this.input.channelCountMode="explicit",this._dryWet=this.output=new CrossFade({context:this.context,fade:e.wet}),this.wet=this._dryWet.fade,this._split=new Split_Split({context:this.context,channels:2}),this._merge=new Merge_Merge({context:this.context,channels:2}),this.input.connect(this._split),this.input.connect(this._dryWet.a),this._merge.connect(this._dryWet.b),(0,a.qt)(this,["wet"])}connectEffectLeft(...e){this._split.connect(e[0],0,0),(0,d.ft)(...e),(0,d.$j)(e[e.length-1],this._merge,0,0)}connectEffectRight(...e){this._split.connect(e[0],1,0),(0,d.ft)(...e),(0,d.$j)(e[e.length-1],this._merge,0,1)}static getDefaults(){return Object.assign(d.HD.getDefaults(),{wet:1})}dispose(){return super.dispose(),this._dryWet.dispose(),this._split.dispose(),this._merge.dispose(),this}};let StereoFeedbackEffect_StereoFeedbackEffect=class StereoFeedbackEffect_StereoFeedbackEffect extends StereoEffect_StereoEffect{constructor(e){super(e),this.feedback=new Signal_Signal({context:this.context,value:e.feedback,units:"normalRange"}),this._feedbackL=new f.S({context:this.context}),this._feedbackR=new f.S({context:this.context}),this._feedbackSplit=new Split_Split({context:this.context,channels:2}),this._feedbackMerge=new Merge_Merge({context:this.context,channels:2}),this._merge.connect(this._feedbackSplit),this._feedbackMerge.connect(this._split),this._feedbackSplit.connect(this._feedbackL,0,0),this._feedbackL.connect(this._feedbackMerge,0,0),this._feedbackSplit.connect(this._feedbackR,1,0),this._feedbackR.connect(this._feedbackMerge,0,1),this.feedback.fan(this._feedbackL.gain,this._feedbackR.gain),(0,a.qt)(this,["feedback"])}static getDefaults(){return Object.assign(StereoEffect_StereoEffect.getDefaults(),{feedback:.5})}dispose(){return super.dispose(),this.feedback.dispose(),this._feedbackL.dispose(),this._feedbackR.dispose(),this._feedbackSplit.dispose(),this._feedbackMerge.dispose(),this}};let Chorus=class Chorus extends StereoFeedbackEffect_StereoFeedbackEffect{constructor(){super((0,r.Y9)(Chorus.getDefaults(),arguments,["frequency","delayTime","depth"])),this.name="Chorus";let e=(0,r.Y9)(Chorus.getDefaults(),arguments,["frequency","delayTime","depth"]);this._depth=e.depth,this._delayTime=e.delayTime/1e3,this._lfoL=new LFO_LFO({context:this.context,frequency:e.frequency,min:0,max:1}),this._lfoR=new LFO_LFO({context:this.context,frequency:e.frequency,min:0,max:1,phase:180}),this._delayNodeL=new Delay_Delay({context:this.context}),this._delayNodeR=new Delay_Delay({context:this.context}),this.frequency=this._lfoL.frequency,(0,a.qt)(this,["frequency"]),this._lfoL.frequency.connect(this._lfoR.frequency),this.connectEffectLeft(this._delayNodeL),this.connectEffectRight(this._delayNodeR),this._lfoL.connect(this._delayNodeL.delayTime),this._lfoR.connect(this._delayNodeR.delayTime),this.depth=this._depth,this.type=e.type,this.spread=e.spread}static getDefaults(){return Object.assign(StereoFeedbackEffect_StereoFeedbackEffect.getDefaults(),{frequency:1.5,delayTime:3.5,depth:.7,type:"sine",spread:180,feedback:0,wet:.5})}get depth(){return this._depth}set depth(e){this._depth=e;let t=this._delayTime*e;this._lfoL.min=Math.max(this._delayTime-t,0),this._lfoL.max=this._delayTime+t,this._lfoR.min=Math.max(this._delayTime-t,0),this._lfoR.max=this._delayTime+t}get delayTime(){return 1e3*this._delayTime}set delayTime(e){this._delayTime=e/1e3,this.depth=this._depth}get type(){return this._lfoL.type}set type(e){this._lfoL.type=e,this._lfoR.type=e}get spread(){return this._lfoR.phase-this._lfoL.phase}set spread(e){this._lfoL.phase=90-e/2,this._lfoR.phase=e/2+90}start(e){return this._lfoL.start(e),this._lfoR.start(e),this}stop(e){return this._lfoL.stop(e),this._lfoR.stop(e),this}sync(){return this._lfoL.sync(),this._lfoR.sync(),this}unsync(){return this._lfoL.unsync(),this._lfoR.unsync(),this}dispose(){return super.dispose(),this._lfoL.dispose(),this._lfoR.dispose(),this._delayNodeL.dispose(),this._delayNodeR.dispose(),this.frequency.dispose(),this}};let Distortion=class Distortion extends Effect_Effect{constructor(){super((0,r.Y9)(Distortion.getDefaults(),arguments,["distortion"])),this.name="Distortion";let e=(0,r.Y9)(Distortion.getDefaults(),arguments,["distortion"]);this._shaper=new WaveShaper_WaveShaper({context:this.context,length:4096}),this._distortion=e.distortion,this.connectEffect(this._shaper),this.distortion=e.distortion,this.oversample=e.oversample}static getDefaults(){return Object.assign(Effect_Effect.getDefaults(),{distortion:.4,oversample:"none"})}get distortion(){return this._distortion}set distortion(e){this._distortion=e;let t=100*e,n=Math.PI/180;this._shaper.setMap(e=>.001>Math.abs(e)?0:(3+t)*e*20*n/(Math.PI+t*Math.abs(e)))}get oversample(){return this._shaper.oversample}set oversample(e){this._shaper.oversample=e}dispose(){return super.dispose(),this._shaper.dispose(),this}};let FeedbackEffect=class FeedbackEffect extends Effect_Effect{constructor(e){super(e),this.name="FeedbackEffect",this._feedbackGain=new f.S({context:this.context,gain:e.feedback,units:"normalRange"}),this.feedback=this._feedbackGain.gain,(0,a.qt)(this,"feedback"),this.effectReturn.chain(this._feedbackGain,this.effectSend)}static getDefaults(){return Object.assign(Effect_Effect.getDefaults(),{feedback:.125})}dispose(){return super.dispose(),this._feedbackGain.dispose(),this.feedback.dispose(),this}};let FeedbackDelay=class FeedbackDelay extends FeedbackEffect{constructor(){super((0,r.Y9)(FeedbackDelay.getDefaults(),arguments,["delayTime","feedback"])),this.name="FeedbackDelay";let e=(0,r.Y9)(FeedbackDelay.getDefaults(),arguments,["delayTime","feedback"]);this._delayNode=new Delay_Delay({context:this.context,delayTime:e.delayTime,maxDelay:e.maxDelay}),this.delayTime=this._delayNode.delayTime,this.connectEffect(this._delayNode),(0,a.qt)(this,"delayTime")}static getDefaults(){return Object.assign(FeedbackEffect.getDefaults(),{delayTime:.25,maxDelay:1})}dispose(){return super.dispose(),this._delayNode.dispose(),this.delayTime.dispose(),this}};let PitchShift=class PitchShift extends FeedbackEffect{constructor(){super((0,r.Y9)(PitchShift.getDefaults(),arguments,["pitch"])),this.name="PitchShift";let e=(0,r.Y9)(PitchShift.getDefaults(),arguments,["pitch"]);this._frequency=new Signal_Signal({context:this.context}),this._delayA=new Delay_Delay({maxDelay:1,context:this.context}),this._lfoA=new LFO_LFO({context:this.context,min:0,max:.1,type:"sawtooth"}).connect(this._delayA.delayTime),this._delayB=new Delay_Delay({maxDelay:1,context:this.context}),this._lfoB=new LFO_LFO({context:this.context,min:0,max:.1,type:"sawtooth",phase:180}).connect(this._delayB.delayTime),this._crossFade=new CrossFade({context:this.context}),this._crossFadeLFO=new LFO_LFO({context:this.context,min:0,max:1,type:"triangle",phase:90}).connect(this._crossFade.fade),this._feedbackDelay=new Delay_Delay({delayTime:e.delayTime,context:this.context}),this.delayTime=this._feedbackDelay.delayTime,(0,a.qt)(this,"delayTime"),this._pitch=e.pitch,this._windowSize=e.windowSize,this._delayA.connect(this._crossFade.a),this._delayB.connect(this._crossFade.b),this._frequency.fan(this._lfoA.frequency,this._lfoB.frequency,this._crossFadeLFO.frequency),this.effectSend.fan(this._delayA,this._delayB),this._crossFade.chain(this._feedbackDelay,this.effectReturn);let t=this.now();this._lfoA.start(t),this._lfoB.start(t),this._crossFadeLFO.start(t),this.windowSize=this._windowSize}static getDefaults(){return Object.assign(FeedbackEffect.getDefaults(),{pitch:0,windowSize:.1,delayTime:0,feedback:0})}get pitch(){return this._pitch}set pitch(e){this._pitch=e;let t=0;e<0?(this._lfoA.min=0,this._lfoA.max=this._windowSize,this._lfoB.min=0,this._lfoB.max=this._windowSize,t=(0,F.Im)(e-1)+1):(this._lfoA.min=this._windowSize,this._lfoA.max=0,this._lfoB.min=this._windowSize,this._lfoB.max=0,t=(0,F.Im)(e)-1),this._frequency.value=t*(1.2/this._windowSize)}get windowSize(){return this._windowSize}set windowSize(e){this._windowSize=this.toSeconds(e),this.pitch=this._pitch}dispose(){return super.dispose(),this._frequency.dispose(),this._delayA.dispose(),this._delayB.dispose(),this._lfoA.dispose(),this._lfoB.dispose(),this._crossFade.dispose(),this._crossFadeLFO.dispose(),this._feedbackDelay.dispose(),this}};let Reverb=class Reverb extends Effect_Effect{constructor(){super((0,r.Y9)(Reverb.getDefaults(),arguments,["decay"])),this.name="Reverb",this._convolver=this.context.createConvolver(),this.ready=Promise.resolve();let e=(0,r.Y9)(Reverb.getDefaults(),arguments,["decay"]);this._decay=e.decay,this._preDelay=e.preDelay,this.generate(),this.connectEffect(this._convolver)}static getDefaults(){return Object.assign(Effect_Effect.getDefaults(),{decay:1.5,preDelay:.01})}get decay(){return this._decay}set decay(e){e=this.toSeconds(e),(0,u.gI)(e,.001),this._decay=e,this.generate()}get preDelay(){return this._preDelay}set preDelay(e){e=this.toSeconds(e),(0,u.gI)(e,0),this._preDelay=e,this.generate()}generate(){return(0,b.mG)(this,void 0,void 0,function*(){let e=this.ready,t=new g.n(2,this._decay+this._preDelay,this.context.sampleRate),n=new Noise_Noise({context:t}),i=new Noise_Noise({context:t}),s=new Merge_Merge({context:t});n.connect(s,0,0),i.connect(s,0,1);let r=new f.S({context:t}).toDestination();s.connect(r),n.start(0),i.start(0),r.gain.setValueAtTime(0,0),r.gain.setValueAtTime(1,this._preDelay),r.gain.exponentialApproachValueAtTime(0,this._preDelay,this.decay);let o=t.render();return this.ready=o.then(a.EI),yield e,this._convolver.buffer=(yield o).get(),this})}dispose(){return super.dispose(),this._convolver.disconnect(),this}};let Analyser_Analyser=class Analyser_Analyser extends d.HD{constructor(){super((0,r.Y9)(Analyser_Analyser.getDefaults(),arguments,["type","size"])),this.name="Analyser",this._analysers=[],this._buffers=[];let e=(0,r.Y9)(Analyser_Analyser.getDefaults(),arguments,["type","size"]);this.input=this.output=this._gain=new f.S({context:this.context}),this._split=new Split_Split({context:this.context,channels:e.channels}),this.input.connect(this._split),(0,u.gI)(e.channels,1);for(let t=0;t<e.channels;t++)this._analysers[t]=this.context.createAnalyser(),this._split.connect(this._analysers[t],t,0);this.size=e.size,this.type=e.type}static getDefaults(){return Object.assign(d.HD.getDefaults(),{size:1024,smoothing:.8,type:"fft",channels:1})}getValue(){return(this._analysers.forEach((e,t)=>{let n=this._buffers[t];"fft"===this._type?e.getFloatFrequencyData(n):"waveform"===this._type&&e.getFloatTimeDomainData(n)}),1===this.channels)?this._buffers[0]:this._buffers}get size(){return this._analysers[0].frequencyBinCount}set size(e){this._analysers.forEach((t,n)=>{t.fftSize=2*e,this._buffers[n]=new Float32Array(e)})}get channels(){return this._analysers.length}get type(){return this._type}set type(e){(0,u.hu)("waveform"===e||"fft"===e,`Analyser: invalid type: ${e}`),this._type=e}get smoothing(){return this._analysers[0].smoothingTimeConstant}set smoothing(e){this._analysers.forEach(t=>t.smoothingTimeConstant=e)}dispose(){return super.dispose(),this._analysers.forEach(e=>e.disconnect()),this._split.dispose(),this._gain.dispose(),this}};let MeterBase_MeterBase=class MeterBase_MeterBase extends d.HD{constructor(){super((0,r.Y9)(MeterBase_MeterBase.getDefaults(),arguments)),this.name="MeterBase",this.input=this.output=this._analyser=new Analyser_Analyser({context:this.context,size:256,type:"waveform"})}dispose(){return super.dispose(),this._analyser.dispose(),this}};let FFT=class FFT extends MeterBase_MeterBase{constructor(){super((0,r.Y9)(FFT.getDefaults(),arguments,["size"])),this.name="FFT";let e=(0,r.Y9)(FFT.getDefaults(),arguments,["size"]);this.normalRange=e.normalRange,this._analyser.type="fft",this.size=e.size}static getDefaults(){return Object.assign(d.HD.getDefaults(),{normalRange:!1,size:1024,smoothing:.8})}getValue(){let e=this._analyser.getValue();return e.map(e=>this.normalRange?(0,F.xz)(e):e)}get size(){return this._analyser.size}set size(e){this._analyser.size=e}get smoothing(){return this._analyser.smoothing}set smoothing(e){this._analyser.smoothing=e}getFrequencyOfIndex(e){return(0,u.hu)(0<=e&&e<this.size,`index must be greater than or equal to 0 and less than ${this.size}`),e*this.context.sampleRate/(2*this.size)}};let Solo=class Solo extends d.HD{constructor(){super((0,r.Y9)(Solo.getDefaults(),arguments,["solo"])),this.name="Solo";let e=(0,r.Y9)(Solo.getDefaults(),arguments,["solo"]);this.input=this.output=new f.S({context:this.context}),Solo._allSolos.has(this.context)||Solo._allSolos.set(this.context,new Set),Solo._allSolos.get(this.context).add(this),this.solo=e.solo}static getDefaults(){return Object.assign(d.HD.getDefaults(),{solo:!1})}get solo(){return this._isSoloed()}set solo(e){e?this._addSolo():this._removeSolo(),Solo._allSolos.get(this.context).forEach(e=>e._updateSolo())}get muted(){return 0===this.input.gain.value}_addSolo(){Solo._soloed.has(this.context)||Solo._soloed.set(this.context,new Set),Solo._soloed.get(this.context).add(this)}_removeSolo(){Solo._soloed.has(this.context)&&Solo._soloed.get(this.context).delete(this)}_isSoloed(){return Solo._soloed.has(this.context)&&Solo._soloed.get(this.context).has(this)}_noSolos(){return!Solo._soloed.has(this.context)||Solo._soloed.has(this.context)&&0===Solo._soloed.get(this.context).size}_updateSolo(){this._isSoloed()?this.input.gain.value=1:this._noSolos()?this.input.gain.value=1:this.input.gain.value=0}dispose(){return super.dispose(),Solo._allSolos.get(this.context).delete(this),this._removeSolo(),this}};Solo._allSolos=new Map,Solo._soloed=new Map;let PanVol=class PanVol extends d.HD{constructor(){super((0,r.Y9)(PanVol.getDefaults(),arguments,["pan","volume"])),this.name="PanVol";let e=(0,r.Y9)(PanVol.getDefaults(),arguments,["pan","volume"]);this._panner=this.input=new Panner_Panner({context:this.context,pan:e.pan,channelCount:e.channelCount}),this.pan=this._panner.pan,this._volume=this.output=new C.f({context:this.context,volume:e.volume}),this.volume=this._volume.volume,this._panner.connect(this._volume),this.mute=e.mute,(0,a.qt)(this,["pan","volume"])}static getDefaults(){return Object.assign(d.HD.getDefaults(),{mute:!1,pan:0,volume:0,channelCount:1})}get mute(){return this._volume.mute}set mute(e){this._volume.mute=e}dispose(){return super.dispose(),this._panner.dispose(),this.pan.dispose(),this._volume.dispose(),this.volume.dispose(),this}};let Channel=class Channel extends d.HD{constructor(){super((0,r.Y9)(Channel.getDefaults(),arguments,["volume","pan"])),this.name="Channel";let e=(0,r.Y9)(Channel.getDefaults(),arguments,["volume","pan"]);this._solo=this.input=new Solo({solo:e.solo,context:this.context}),this._panVol=this.output=new PanVol({context:this.context,pan:e.pan,volume:e.volume,mute:e.mute,channelCount:e.channelCount}),this.pan=this._panVol.pan,this.volume=this._panVol.volume,this._solo.connect(this._panVol),(0,a.qt)(this,["pan","volume"])}static getDefaults(){return Object.assign(d.HD.getDefaults(),{pan:0,volume:0,mute:!1,solo:!1,channelCount:1})}get solo(){return this._solo.solo}set solo(e){this._solo.solo=e}get muted(){return this._solo.muted||this.mute}get mute(){return this._panVol.mute}set mute(e){this._panVol.mute=e}_getBus(e){return Channel.buses.has(e)||Channel.buses.set(e,new f.S({context:this.context})),Channel.buses.get(e)}send(e,t=0){let n=this._getBus(e),i=new f.S({context:this.context,units:"decibels",gain:t});return this.connect(i),i.connect(n),i}receive(e){let t=this._getBus(e);return t.connect(this),this}dispose(){return super.dispose(),this._panVol.dispose(),this.pan.dispose(),this.volume.dispose(),this._solo.dispose(),this}};Channel.buses=new Map;let Mono=class Mono extends d.HD{constructor(){super((0,r.Y9)(Mono.getDefaults(),arguments)),this.name="Mono",this.input=new f.S({context:this.context}),this._merge=this.output=new Merge_Merge({channels:2,context:this.context}),this.input.connect(this._merge,0,0),this.input.connect(this._merge,0,1)}dispose(){return super.dispose(),this._merge.dispose(),this.input.dispose(),this}};let Listener=class Listener extends d.HD{constructor(){super(...arguments),this.name="Listener",this.positionX=new h.d({context:this.context,param:this.context.rawContext.listener.positionX}),this.positionY=new h.d({context:this.context,param:this.context.rawContext.listener.positionY}),this.positionZ=new h.d({context:this.context,param:this.context.rawContext.listener.positionZ}),this.forwardX=new h.d({context:this.context,param:this.context.rawContext.listener.forwardX}),this.forwardY=new h.d({context:this.context,param:this.context.rawContext.listener.forwardY}),this.forwardZ=new h.d({context:this.context,param:this.context.rawContext.listener.forwardZ}),this.upX=new h.d({context:this.context,param:this.context.rawContext.listener.upX}),this.upY=new h.d({context:this.context,param:this.context.rawContext.listener.upY}),this.upZ=new h.d({context:this.context,param:this.context.rawContext.listener.upZ})}static getDefaults(){return Object.assign(d.HD.getDefaults(),{positionX:0,positionY:0,positionZ:0,forwardX:0,forwardY:0,forwardZ:-1,upX:0,upY:1,upZ:0})}dispose(){return super.dispose(),this.positionX.dispose(),this.positionY.dispose(),this.positionZ.dispose(),this.forwardX.dispose(),this.forwardY.dispose(),this.forwardZ.dispose(),this.upX.dispose(),this.upY.dispose(),this.upZ.dispose(),this}};(0,T.YV)(e=>{e.listener=new Listener({context:e})}),(0,T.Fc)(e=>{e.listener.dispose()}),n(4270);let Convolver=class Convolver extends d.HD{constructor(){super((0,r.Y9)(Convolver.getDefaults(),arguments,["url","onload"])),this.name="Convolver",this._convolver=this.context.createConvolver();let e=(0,r.Y9)(Convolver.getDefaults(),arguments,["url","onload"]);this._buffer=new v.p(e.url,t=>{this.buffer=t,e.onload()}),this.input=new f.S({context:this.context}),this.output=new f.S({context:this.context}),this._buffer.loaded&&(this.buffer=this._buffer),this.normalize=e.normalize,this.input.chain(this._convolver,this.output)}static getDefaults(){return Object.assign(d.HD.getDefaults(),{normalize:!0,onload:a.EI})}load(e){return(0,b.mG)(this,void 0,void 0,function*(){this.buffer=yield this._buffer.load(e)})}get buffer(){return this._buffer.length?this._buffer:null}set buffer(e){e&&this._buffer.set(e),this._convolver.buffer&&(this.input.disconnect(),this._convolver.disconnect(),this._convolver=this.context.createConvolver(),this.input.chain(this._convolver,this.output));let t=this._buffer.get();this._convolver.buffer=t||null}get normalize(){return this._convolver.normalize}set normalize(e){this._convolver.normalize=e}dispose(){return super.dispose(),this._buffer.dispose(),this._convolver.disconnect(),this}};(0,i.fw)().transport;let B=(0,i.fw)().destination;(0,i.fw)().destination,(0,i.fw)().listener,(0,i.fw)().draw;let W=(0,i.fw)()},5657:function(e,t,n){"use strict";n.d(t,{Y:function(){return Instrument}});var i=n(2128),s=n(1957),r=n(988),o=n(8886);let Instrument=class Instrument extends s.HD{constructor(){super((0,r.Y9)(Instrument.getDefaults(),arguments)),this._scheduledEvents=[],this._synced=!1,this._original_triggerAttack=this.triggerAttack,this._original_triggerRelease=this.triggerRelease;let e=(0,r.Y9)(Instrument.getDefaults(),arguments);this._volume=this.output=new i.f({context:this.context,volume:e.volume}),this.volume=this._volume.volume,(0,o.qt)(this,"volume")}static getDefaults(){return Object.assign(s.HD.getDefaults(),{volume:0})}sync(){return this._syncState()&&(this._syncMethod("triggerAttack",1),this._syncMethod("triggerRelease",0)),this}_syncState(){let e=!1;return this._synced||(this._synced=!0,e=!0),e}_syncMethod(e,t){let n=this["_original_"+e]=this[e];this[e]=(...e)=>{let i=e[t],s=this.context.transport.schedule(i=>{e[t]=i,n.apply(this,e)},i);this._scheduledEvents.push(s)}}unsync(){return this._scheduledEvents.forEach(e=>this.context.transport.clear(e)),this._scheduledEvents=[],this._synced&&(this._synced=!1,this.triggerAttack=this._original_triggerAttack,this.triggerRelease=this._original_triggerRelease),this}triggerAttackRelease(e,t,n,i){let s=this.toSeconds(n),r=this.toSeconds(t);return this.triggerAttack(e,s,i),this.triggerRelease(s+r),this}dispose(){return super.dispose(),this._volume.dispose(),this.unsync(),this._scheduledEvents=[],this}}},665:function(e,t,n){"use strict";n.d(t,{i:function(){return i}});let i="14.7.77"},7563:function(e){e.exports=function(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=Array(t);n<t;n++)i[n]=e[n];return i},e.exports.__esModule=!0,e.exports.default=e.exports},8158:function(e){e.exports=function(e){if(Array.isArray(e))return e},e.exports.__esModule=!0,e.exports.default=e.exports},6358:function(e){e.exports=function(e,t){if(!(e instanceof t))throw TypeError("Cannot call a class as a function")},e.exports.__esModule=!0,e.exports.default=e.exports},1127:function(e,t,n){var i=n(63);function _defineProperties(e,t){for(var n=0;n<t.length;n++){var s=t[n];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,i(s.key),s)}}e.exports=function(e,t,n){return t&&_defineProperties(e.prototype,t),n&&_defineProperties(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e},e.exports.__esModule=!0,e.exports.default=e.exports},2731:function(e){e.exports=function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var i,s,r,o,a=[],l=!0,u=!1;try{if(r=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;l=!1}else for(;!(l=(i=r.call(n)).done)&&(a.push(i.value),a.length!==t);l=!0);}catch(e){u=!0,s=e}finally{try{if(!l&&null!=n.return&&(o=n.return(),Object(o)!==o))return}finally{if(u)throw s}}return a}},e.exports.__esModule=!0,e.exports.default=e.exports},4980:function(e){e.exports=function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")},e.exports.__esModule=!0,e.exports.default=e.exports},2184:function(e,t,n){var i=n(8158),s=n(2731),r=n(2214),o=n(4980);e.exports=function(e,t){return i(e)||s(e,t)||r(e,t)||o()},e.exports.__esModule=!0,e.exports.default=e.exports},9944:function(e,t,n){var i=n(1565).default;e.exports=function(e,t){if("object"!=i(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var s=n.call(e,t||"default");if("object"!=i(s))return s;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)},e.exports.__esModule=!0,e.exports.default=e.exports},63:function(e,t,n){var i=n(1565).default,s=n(9944);e.exports=function(e){var t=s(e,"string");return"symbol"==i(t)?t:String(t)},e.exports.__esModule=!0,e.exports.default=e.exports},1565:function(e){function _typeof(t){return e.exports=_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e.exports.__esModule=!0,e.exports.default=e.exports,_typeof(t)}e.exports=_typeof,e.exports.__esModule=!0,e.exports.default=e.exports},2214:function(e,t,n){var i=n(7563);e.exports=function(e,t){if(e){if("string"==typeof e)return i(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return i(e,t)}},e.exports.__esModule=!0,e.exports.default=e.exports}}]);